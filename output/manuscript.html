<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jordan A. Berg" />
  <meta name="author" content="Youjia Zhou" />
  <meta name="author" content="T. Cameron Waller" />
  <meta name="author" content="Yeyun Ouyang" />
  <meta name="author" content="Sara M. Nowinski" />
  <meta name="author" content="Tyler Van Ry" />
  <meta name="author" content="Ian George" />
  <meta name="author" content="James E. Cox" />
  <meta name="author" content="Bei Wang" />
  <meta name="author" content="Jared Rutter" />
  <meta name="dcterms.date" content="2020-05-26" />
  <meta name="keywords" content="metabolomics, metabolism, network, omics, rna-seq, proteomics, gene, protein, metabolite, context" />
  <title>Gazing into the Metaboverse: Automated exploration and contextualization of metabolic data</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <!--
  Manubot generated metadata rendered from header-includes-template.html.
  Suggest improvements at https://github.com/manubot/manubot/blob/master/manubot/process/header-includes-template.html
  -->
  <meta name="dc.format" content="text/html" />
  <meta name="dc.title" content="Gazing into the Metaboverse: Automated exploration and contextualization of metabolic data" />
  <meta name="citation_title" content="Gazing into the Metaboverse: Automated exploration and contextualization of metabolic data" />
  <meta property="og:title" content="Gazing into the Metaboverse: Automated exploration and contextualization of metabolic data" />
  <meta property="twitter:title" content="Gazing into the Metaboverse: Automated exploration and contextualization of metabolic data" />
  <meta name="dc.date" content="2020-05-26" />
  <meta name="citation_publication_date" content="2020-05-26" />
  <meta name="dc.language" content="en-US" />
  <meta name="citation_language" content="en-US" />
  <meta name="dc.relation.ispartof" content="Manubot" />
  <meta name="dc.publisher" content="Manubot" />
  <meta name="citation_journal_title" content="Manubot" />
  <meta name="citation_technical_report_institution" content="Manubot" />
  <meta name="citation_author" content="Jordan A. Berg" />
  <meta name="citation_author_institution" content="Department of Biochemistry, University of Utah" />
  <meta name="citation_author_orcid" content="0000-0002-5096-0558" />
  <meta name="twitter:creator" content="@jordanberg0" />
  <meta name="citation_author" content="Youjia Zhou" />
  <meta name="citation_author_institution" content="School of Computing, University of Utah" />
  <meta name="citation_author_institution" content="Scientific Computing &amp; Imaging Institute, University of Utah" />
  <meta name="citation_author_orcid" content="None" />
  <meta name="citation_author" content="T. Cameron Waller" />
  <meta name="citation_author_institution" content="Division of Medical Genetics, Department of Medicine, School of Medicine, University of California San Diego" />
  <meta name="citation_author_orcid" content="0000-0002-0313-6646" />
  <meta name="citation_author" content="Yeyun Ouyang" />
  <meta name="citation_author_institution" content="Department of Biochemistry, University of Utah" />
  <meta name="citation_author_orcid" content="0000-0001-9523-1044" />
  <meta name="citation_author" content="Sara M. Nowinski" />
  <meta name="citation_author_institution" content="Department of Biochemistry, University of Utah" />
  <meta name="citation_author_orcid" content="0000-0002-4744-6101" />
  <meta name="citation_author" content="Tyler Van Ry" />
  <meta name="citation_author_institution" content="Department of Biochemistry, University of Utah" />
  <meta name="citation_author_institution" content="Metabolomics Core Facility, University of Utah" />
  <meta name="citation_author_orcid" content="None" />
  <meta name="citation_author" content="Ian George" />
  <meta name="citation_author_institution" content="Department of Biochemistry, University of Utah" />
  <meta name="citation_author_orcid" content="0000-0003-1361-694X" />
  <meta name="citation_author" content="James E. Cox" />
  <meta name="citation_author_institution" content="Department of Biochemistry, University of Utah" />
  <meta name="citation_author_institution" content="Diabetes &amp; Metabolism Research Center, University of Utah" />
  <meta name="citation_author_institution" content="Metabolomics Core Facility, University of Utah" />
  <meta name="citation_author_orcid" content="0000-0002-5977-2350" />
  <meta name="citation_author" content="Bei Wang" />
  <meta name="citation_author_institution" content="School of Computing, University of Utah" />
  <meta name="citation_author_institution" content="Scientific Computing &amp; Imaging Institute, University of Utah" />
  <meta name="citation_author_orcid" content="None" />
  <meta name="citation_author" content="Jared Rutter" />
  <meta name="citation_author_institution" content="Department of Biochemistry, University of Utah" />
  <meta name="citation_author_institution" content="Diabetes &amp; Metabolism Research Center, University of Utah" />
  <meta name="citation_author_institution" content="Howard Hughes Medical Institute, University of Utah" />
  <meta name="citation_author_orcid" content="0000-0002-2710-9765" />
  <meta property="og:type" content="article" />
  <meta property="twitter:card" content="summary_large_image" />
  <link rel="icon" type="image/png" sizes="192x192" href="https://manubot.org/favicon-192x192.png" />
  <link rel="mask-icon" href="https://manubot.org/safari-pinned-tab.svg" color="#ad1457" />
  <meta name="theme-color" content="#ad1457" />
  <!-- end Manubot generated metadata -->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Gazing into the Metaboverse: Automated exploration and contextualization of metabolic data</h1>
</header>
<p><small><em>
This manuscript
was automatically generated
on May 26, 2020.
</em></small></p>
<h2 id="authors">Authors</h2>
<p><a href="https://orcid.org/0000-0002-5096-0558"><img src="images/orcid.svg" width="11" height="11" alt="ORCID icon" /></a>
Jordan A. Berg<sup>1</sup>,
<a href="https://orcid.org/None"><img src="images/orcid.svg" width="11" height="11" alt="ORCID icon" /></a>
Youjia Zhou<sup>2,3</sup>,
<a href="https://orcid.org/0000-0002-0313-6646"><img src="images/orcid.svg" width="11" height="11" alt="ORCID icon" /></a>
T. Cameron Waller<sup>4</sup>,
<a href="https://orcid.org/0000-0001-9523-1044"><img src="images/orcid.svg" width="11" height="11" alt="ORCID icon" /></a>
Yeyun Ouyang<sup>1</sup>,
<a href="https://orcid.org/0000-0002-4744-6101"><img src="images/orcid.svg" width="11" height="11" alt="ORCID icon" /></a>
Sara M. Nowinski<sup>1</sup>,
<a href="https://orcid.org/None"><img src="images/orcid.svg" width="11" height="11" alt="ORCID icon" /></a>
Tyler Van Ry<sup>1,5</sup>,
<a href="https://orcid.org/0000-0003-1361-694X"><img src="images/orcid.svg" width="11" height="11" alt="ORCID icon" /></a>
Ian George<sup>1</sup>,
<a href="https://orcid.org/0000-0002-5977-2350"><img src="images/orcid.svg" width="11" height="11" alt="ORCID icon" /></a>
James E. Cox<sup>1,5,6</sup>,
<a href="https://orcid.org/None"><img src="images/orcid.svg" width="11" height="11" alt="ORCID icon" /></a>
Bei Wang<sup>2,3</sup>,
<a href="https://orcid.org/0000-0002-2710-9765"><img src="images/orcid.svg" width="11" height="11" alt="ORCID icon" /></a>
Jared Rutter<sup>1,6,7</sup>
<small></p>
<ol type="1">
<li>Department of Biochemistry, University of Utah</li>
<li>School of Computing, University of Utah</li>
<li>Scientific Computing &amp; Imaging Institute, University of Utah</li>
<li>Division of Medical Genetics, Department of Medicine, School of Medicine, University of California San Diego</li>
<li>Metabolomics Core Facility, University of Utah</li>
<li>Diabetes &amp; Metabolism Research Center, University of Utah</li>
<li>Howard Hughes Medical Institute, University of Utah
</small></li>
</ol>
<p><sup>†</sup> To whom correspondence should be addressed:</p>
<p><sup>*</sup> This is a draft of the eventual final manuscript and should therefore be treated as such. Conclusions, along with author order and contributions, may change as the manuscript is finalized.</p>
<h2 class="page_break_before" id="abstract" class="page_break_before">Abstract</h2>
<p>Metabolism and other biological interactions and reactions are complex, each with variable inputs, outputs, and modifiers. The harmony between these factors consequently determines the health and stability of a cell or organism. Perturbations to these components often have rippling downstream effects. These effects can be difficult to trace across the global reaction network, particularly when the effects occur between canonical representations of pathways. Researchers have largely utilized reductionist approaches to understanding these systems; however, these methods are limited in their scope. Even the power of systems-centric -omics approaches can be limited when only a handful or “loud” signals in the data are prioritized. To address these challenges, we developed Metaboverse, an interactive desktop app for the interactive exploration and automated extraction of potential regulatory events, patterns, and trends from multi-omic data within the context of the metabolic network and other global reaction networks. This framework will be foundational in increasing our ability to holistically understand static and temporal metabolic events and shifts and gene-metabolite intra-cooperativity. Metaboverse if freely available under a GPL-3.0 license at <a href="https://github.com/Metaboverse/">https://github.com/Metaboverse/</a>.</p>
<h2 id="introduction">Introduction</h2>
<p>Metabolism is a complex network of reactions and interactions between genes, enzymes, complexes, and metabolites <span class="citation" data-cites="1AxIC7Cvy">[<a href="#ref-1AxIC7Cvy" role="doc-biblioref">1</a>]</span>. To understand these complex components, researchers normally adopt a reductionist approach to teasing apart the characteristics and mechanics of these processes and how they fit into the larger picture of biology and disease. While a vital component in the scientific process, by doing so, many interesting properties of metabolism can be missed. For example, in differential gene expression analysis, researchers rely on thresholds of magnitude and statistical significance to prioritize genes for follow-up study. However, this can inadvertently limit the scope of study of metabolism when in fact metabolism is a highly interconnected system where distal components and their modulation can have rippling effects across the network. The current approach is analogous to telling the story of Little Red Riding Hood, but only by reading the 20 most frequent words used in the study. Certainly doing so efficiently highlights key words like “wolf” and “little red riding hood,” but also prevents a coherent story from being told and would make it difficult for someone who had never heard the story of Little Red Riding Hood from comprehending the actual plot.</p>
<p>Over the past decade, several computational tools have emerged and become popular for their focus on trying to solve these issues in data contextualization. We will highlight four, and while others exist, we focus on tools representative and most popular for their respective properties. First is MetaboAnalyst, which relies largely on set enrichment methods for analysis of data, or looking at the belongingness of sets of significantly changed analytes (i.e. metabolite, protein, or gene measurements), for extracting interesting information. While network visualization is available, it focuses primarily on interaction networks and its ability to extract regulatory information is limited, particularly in an automated fashion <span class="citation" data-cites="C62ou67p PcBvPAjh">[<a href="#ref-C62ou67p" role="doc-biblioref">2</a>,<a href="#ref-PcBvPAjh" role="doc-biblioref">3</a>]</span>. Second is Cytoscape, which serves as a general go-to platform for representing biological or other networks. One strength of Cytoscape is its ability for users to design their own apps, or plug-ins to develop customized analyses. However, comprehensive regulatory identification methods are unavailable <span class="citation" data-cites="1BJixYIRV">[<a href="#ref-1BJixYIRV" role="doc-biblioref">4</a>]</span>. MetExplore focuses on the curation of networks, and is particularly useful for collaborative annotation of emerging organisms. It additionally can layer experimental data on the network for visualization <span class="citation" data-cites="Fe0QzlwH DdChGH39">[<a href="#ref-Fe0QzlwH" role="doc-biblioref">5</a>,<a href="#ref-DdChGH39" role="doc-biblioref">6</a>]</span>. Reactome, which Metaboverse uses for the curation of biological networks, also offers analytical tools for user data, but again relies on set enrichment or manual methods for identifying patterns. While all have their respective utility, there is still a need for tools that automate pattern and trend detection, especially when data is sparse, across metabolic networks in order to extract regulatory and other features from data <span class="citation" data-cites="l3pIjmaQ GZkNnAkC MFnInm09">[<a href="#ref-l3pIjmaQ" role="doc-biblioref">7</a>,<a href="#ref-GZkNnAkC" role="doc-biblioref">8</a>,<a href="#ref-MFnInm09" role="doc-biblioref">9</a>]</span>.</p>
<p>In order to address these limitations in current conventions of metabolic data analysis, contextualization, and interpretation, we created the operating-system-independent desktop application, Metaboverse, to aid users in filling in and expanding upon the details of their model’s metabolic story. Metaboverse is an interactive tool for exploratory data analysis that searches user data in the context of the metabolic network to identify interesting patterns and trends within the data. Metaboverse will aid scientists in formulating new hypotheses from their data and aid them in designing follow-up experiments for a deeper understanding of their model. Metaboverse operates across the entire metabolic network to quickly and automatically detect patterns and trends from a pre-designed pattern library, or can accept interactive input from the user where they can define certain patterns or trends they would like to identify across the global metabolic network. Figure <a href="#fig:overview">1</a> provides a graphical abstract to illustrate <i>Metaboverse’s</i> role in the exploratory data analysis of biological data in the context of metabolism.</p>
<div id="fig:overview" class="fignos">
<figure>
<img src="./content/figures/graphical_abstract.png" alt="" /><figcaption><span>Figure 1:</span> <strong>Metaboverse conceptual overview.</strong>
Illustration summarizing the usage of Metaboverse to use biological data layered on the global reaction network to rapidly identify regulatory hotspots. Traditionally, when a scientist performs an -omics experiment, they tend to focus on a couple of features that are differentially regulated. Metaboverse contextualizes the data across the metabolic network and identifies interesting regulatory patterns in the data.</figcaption>
</figure>
</div>
<p>In order to provide a platform for the exploration of single or multi-omic metabolic data, we developed several computational features to aid in the aims discussed above. First, we developed a pattern search engine for the rapid and automated identification of patterns and trends in -omic data on the metabolic network. Conceptually, this search engine borrows principles of topological motif searching from graph theory <span class="citation" data-cites="K14GGVYv 1CFRUQ2Md">[<a href="#ref-K14GGVYv" role="doc-biblioref">10</a>,<a href="#ref-1CFRUQ2Md" role="doc-biblioref">11</a>]</span> and builds upon the concept of “activity motifs” <span class="citation" data-cites="18AaRFS75">[<a href="#ref-18AaRFS75" role="doc-biblioref">12</a>]</span>. Another feature introduced in Metaboverse allows for the interactive exploration of specific reactions or reaction entities with on-the-fly pattern search analysis. Users can explore specific pathways of interest and look for other interesting patterns and trends in pathways of interest. Perturbations in the abundance or behavior of a particular metabolic network component can lead to downstream genotypic and phenotypic modulations in a biological system. We include an interactive perturbation connectivity module to allow users to explore the effects of perturbations on their system. Finally, we tackle the challenge of sparsity, particularly in metabolomics datasets, by introducing a reaction collapsing or bridging feature that allows for searching for motifs across multiple reactions, where intermediate steps of the reaction trajectory may not have measured values for their respective input or output components.</p>
<p>Metaboverse is designed to handle standard two-condition experiments, flux metabolomics (in progress), and time-course or multi-condition experiments. Users can provide any combination of datasets from each -omics categories (values mapping to gene, protein, and metabolite identifiers). Time-course inputs can consist of a matched samples for every time point, or can provide a combination of steady-state levels and time points. Users input fold change and appropriate statistical measures with proper multiple-testing adjustments from their respective -omics datasets, which Metaboverse then layers onto the metabolic network. Metaboverse can handle data from a variety of model organisms, including humans, mouse, yeast, zebrafish, and more. The foundational curation of Metaboverse is built on Reactome reaction curations, thus providing 90+ species which the Metaboverse environment can process. In order to validate these methodologies available in Metaboverse we analyzed a variety of datasets to provide representative vignettes that highlight <i>Metaboverse’s</i> reliability in extracting canonical features, as well as utility in identifying novel features and patterns. We expect that Metaboverse will become a foundational piece of the analytical toolkit and augment one’s ability to more deeply and holistically explore metabolism and other reaction networks and aid in our ability to provide clearer context within these models.</p>
<h2 id="results">Results</h2>
<h3 id="metaboverse-is-a-dynamic-user-friendly-tool-for-the-exploration-of-high-throughput-biological-data-in-organism-specific-pathways.">Metaboverse is a dynamic, user-friendly tool for the exploration of high-throughput biological data in organism-specific pathways.</h3>
<h4 id="overview.">Overview.</h4>
<p>We designed Metaboverse as a light-weight, self-contained app for the dynamic exploration of high-throughput biological data. The pathway curations are derived from Reactome, and as of writing, is capable of analyzing data for over ninety species. A user begins by providing a previously curated Metaboverse file, or the desired output location for a new curation and organism of interest. Next, the user provides the relevant transcriptomic, proteomic, and/or metabolomic datasets to layer onto the global reaction network of their organism of interest. These data categories can be extended to any dataset that uses the relevant mapping IDs; for example, one could provide ribosome profiling translation efficiency values mapped to the appropriate gene IDs for layering onto the network and downstream analysis. During this step, the user will also specify a few experimental parameters for consideration during downstream analysis and visualization. Following these user inputs, the organism’s network, data processing, and motif analysis (discussed further below) is curated and a curation file is output for future analysis (see Figure <a href="#fig:package_overview">2</a>).</p>
<p>We chose to format network visualizations in a reaction-centric format. This means that a sub-network unit comprises of a reaction node, linked with its reaction input and reaction output nodes, along with any nodes for modifiers. If modifier nodes are a protein complex, the component proteins of that complex are linked to the complex node. Any genes available in the database are linked to their related proteins. Each node and link type are color coded to help users quickly distinguish the details of a reaction sub-network structure. Reactions with matching input or output sides are then naturally linked, allowing a multi-reaction pathway to emerge from this graph structure. This formatting differs from other formatting styles users may be familiar with, such as KEGG pathway maps, for a couple of reasons. While this methodology differs from more classical methods, each pathway in the visualization module contains a button linking to a more classical formatting of the pathway from Reactome for reference.</p>
<div id="fig:package_overview" class="fignos">
<figure>
<img src="./content/figures/package_overview.png" alt="" /><figcaption><span>Figure 2:</span> <strong>Metaboverse package overview.</strong>
Illustration comparing the data input, processing, and exploration steps of the Metaboverse package.</figcaption>
</figure>
</div>
<h4 id="handling-data-sparsity-within-the-biological-global-network.">Handling data sparsity within the biological global network.</h4>
<p>Missing data points, particularly in metabolomics experiments, are frequent and can make analysis of pathways and identification of regulatory patterns in the network challenging. While thousands of metabolites are known to participate in human metabolism, the current state of the technology for determining which mass spectra belong to which metabolite can be challenging and often results in a limited number of data points being quantified. These can lead to gaps in the metabolic network which can be challenging to explore and analyze. We therefore developed a reaction compression algorithm (detailed more in the Methods section) that collapses up to three reactions with missing data points if they can be bridged with known data on the distal ends of the reaction path. Methods similar to this have been used in metabolomic analysis before to identify amino acid-related metabolites <span class="citation" data-cites="MFhHC3Pf">[<a href="#ref-MFhHC3Pf" role="doc-biblioref">13</a>]</span>, but we introduce the first computational implementation to our knowledge and adopt a slightly more conservative collapsing scheme. These reactions, or pseudo-reactions are visually distinct to show users where reactions were collapsed and understand what that pseudo-reaction summarizes.</p>
<h4 id="rapid-identification-of-interesting-regulatory-patterns-in-the-reaction-network.">Rapid identification of interesting regulatory patterns in the reaction network.</h4>
<p>Following network curation, the user can visualize available reaction motifs identified across the global reaction network. In a computational science context, a motif is a re-occurring pattern in network structure, or the organization of network entities and their relationships to one another. However, with -omic data, we are more interested in identifying patterns in expression or abundance of genes, proteins, and metabolites. Previous work by Checkik, et. al. introduced the concept of “activity motifs”, where instead of identifying motifs based on network structure, they were identified using the expression characteristics of nodes in transcription factor binding signaling networks <span class="citation" data-cites="18AaRFS75">[<a href="#ref-18AaRFS75" role="doc-biblioref">12</a>]</span>. We adapted this methodology to identify and interactively display interesting regulatory hotspots within the global reaction network. For example, a reaction’s inputs may exhibit increased levels and its outputs low levels, indicating a regulatory event occurring at the reaction.</p>
<p>In Metaboverse, we define a motif as a regulatory pattern identified across a reaction or pseudo-reaction. Metaboverse contains a library of default motifs to search the network for, and users can define custom motifs they would like to identify across the global network (please refer to the documentation for more details on available motifs <span class="citation" data-cites="qPg4pqeH">[<a href="#ref-qPg4pqeH" role="doc-biblioref">14</a>]</span>). Metaboverse will search the global network from a pre-defined library of regulatory patterns (regulatory hotspots, or motifs) and return a graphical stamp view of conserved patterns. These motifs by default are ordered by the statistical values associated with the entity components of the motif, but can be ordered by the strength of the motif based on the magnitude of change. Statistical values associated with each measurement for a measured entity as provided by the user are used to weight these motifs and prioritize returned results. We use a three-tiered sorting strategy when sorting by the associated statistical values. The highest prioritized motifs are those where the relevant components on either side of the reaction (inputs vs. outputs) that determined the reaction motif are statistically significant. Of these motifs from the first tier, motifs are sorted by lowest to highest cumulative p-value or other relevant statistical value. In the second sorting tier, reactions where at least one side of the reaction had a statistically significant motif component are sorted by statistical strength. Finally, all other motifs are sorted by the cumulative statistical value for the motif components.</p>
<p>Reaction motifs are visually distinct during network visualization to quickly draw the user to these interesting patterns. For a given pattern, the user can then explore each pathway this particular motif is found in. Motif analysis of the global regulatory network will allow users to rapidly identify interesting features within the data, particularly patterns between canonical pathways or in other pathways that may seem tangential in their research, but are instead rather striking based on these contextualized analytical method. In the data vignettes below, we demonstrate this utility further. Users will also be able to design their own patterns through an interactive pattern drawing tool, and even design specific scenarios that are cognizant of feature type (in progress). For example, one might be interested in a pattern where a protein displays higher expression, but the resulting metabolite is decreased. This could then be coded interactively into the Metaboverse framework by the user.</p>
<h4 id="dynamic-visualization-of-organism-specific-reaction-pathways.">Dynamic visualization of organism-specific reaction pathways.</h4>
<p>Following curation of the global network as described above, the user can manually search individual canonical pathways or individual entities and their reaction neighborhoods. For a given selection, all relevant reactions that are annotated as a part of that pathway will be graphed, along with their core input (reactant) and output (product) components. In addition to these core elements, known catalysts and inhibitors are included, as well as the component proteins, genes, and metabolites that form functional complexes involved in a particular reaction. For complex nodes, simulated values are calculated by taking the average of all measured component entities in that complex. Assuming a statistical value between 0 and 1, simulated statistics are calculated by taking the maximum statistic value of all measured component entities in that complex. In cases where a gene value is known, but its protein value is unmeasured, the protein value can be inferred using aggregated gene component values. Relevant pathway and analytical metadata is also displayed. All reaction motif types are displayed using default thresholds if present in a selected pathway. Additional aids for visualization are also available, such as the ability to remove nodes from visualization that contain a high number of relationships to other network features such as that these nodes, which act as hubs in the network, do not lead to cluttered representations of the network. Often, these hub nodes are ubiquitous features such as water and proton which may be of limited interest to the user during data visualization <span class="citation" data-cites="jGMmHjyp">[<a href="#ref-jGMmHjyp" role="doc-biblioref">15</a>]</span>. Compartment domains are also graphed to include a relevant reactions and their components that occur in a given cellular compartment.</p>
<h4 id="visualization-of-downstream-effects-of-network-perturbations.">Visualization of downstream effects of network perturbations.</h4>
<p>Users may be interested a particular metabolites or proteins and the downstream effects their perturbation has on related pathways. By double-clicking a node of interest, or by selecting the entity name from the drop-down menu, the user can explore all downstream effects across all pathways in the global network. The user can also define how many neighborhoods to display such that one can visualize two or more reaction steps downstream of the selected entity <span class="citation" data-cites="12Wj4vZRt qpNnLgoz">[<span class="citeproc-not-found" data-reference-id="qpNnLgoz"><strong>???</strong></span>,<a href="#ref-12Wj4vZRt" role="doc-biblioref">16</a>]</span>. This functionality moves the analysis away from traditional, pathway-centric approaches, and helps contextualize the far-reaching effects changes in metabolism or other biological systems can have across classical pathways.</p>
<h4 id="exploring-perturbation-connectivity-within-the-global-network">Exploring perturbation connectivity within the global network</h4>
<p>Abundance or behavioral changes of a metabolic network component can lead to downstream genotypic and phenotypic modulations in a biological system. One important measure of robustness of a network is “connectivity” <span class="citation" data-cites="jGMmHjyp 1EzYBe3sB">[<a href="#ref-jGMmHjyp" role="doc-biblioref">15</a>,<a href="#ref-1EzYBe3sB" role="doc-biblioref">17</a>]</span>. In a biological context, an example of connectivity, or the loss of network connectivity, is easily grasped when considering a transport reaction from the cytosol into the mitochondria of a critical metabolite <span class="citation" data-cites="RC8uLTIv jGMmHjyp 8tmqg1gt vD5y37ks">[<a href="#ref-jGMmHjyp" role="doc-biblioref">15</a>,<a href="#ref-RC8uLTIv" role="doc-biblioref">18</a>,<a href="#ref-8tmqg1gt" role="doc-biblioref">19</a>,<a href="#ref-vD5y37ks" role="doc-biblioref">20</a>]</span>. When the transport hub is abolished and network connectivity is lost, the critical metabolite cannot participate in the required downstream reactions. For example, our laboratory previously established the consequences of the ablation of the mitochondrial pyruvate carrier on downstream citric acid cycle processes and the corresponding increase in lactate production <span class="citation" data-cites="nGh5rU3O">[<a href="#ref-nGh5rU3O" role="doc-biblioref">21</a>]</span> and leads to serious cellular remodeling and dysfunction <span class="citation" data-cites="4n6UHdJZ Lllg0qt7">[<a href="#ref-4n6UHdJZ" role="doc-biblioref">22</a>,<a href="#ref-Lllg0qt7" role="doc-biblioref">23</a>]</span>.</p>
<p>The importance of connectivity could also be considered in a clinical context. For example, a druggable and critical metabolite may be perturbed in a particular disease context. However, if a metabolite participating in a neighboring, downstream reaction is also perturbed in a way not related to the perturbation of the first metabolite, the efficacy of the drug treatment could be severely impaired <span class="citation" data-cites="qjmYmIPe Ot5bUkmI 9IFMjnOQ 1EzYBe3sB">[<a href="#ref-1EzYBe3sB" role="doc-biblioref">17</a>,<a href="#ref-qjmYmIPe" role="doc-biblioref">24</a>,<a href="#ref-Ot5bUkmI" role="doc-biblioref">25</a>,<a href="#ref-9IFMjnOQ" role="doc-biblioref">26</a>]</span>. To aid in exploration of the connectivity of the biological network, we developed a connectivity module where users can display all global reactions or reactions of a specific super pathway that have at least one involved component perturbed based on either an abundance or statistical level. By doing so, when the graph is constructed, proximal reactions that were perturbed will be “sewn” together to reconstruct a perturbation connectivity map. Perturbed, but un-connected reactions would be displayed as single reactions in the network.</p>
<h3 id="data-vignettes">Data vignettes</h3>
<p>In order to demonstrate the utility of Metaboverse to the community, we used Metaboverse to analyze public and new datasets. From the vignettes provided below, we show that Metaboverse not only is able to identify points of interest previously described or expected, but can rapidly identify for the user unexpected and systematic regulatory patterns in a reaction network context.</p>
<h4 id="perturbation-of-mitochondrial-fatty-acid-synthesis-across-time.">1. Perturbation of mitochondrial fatty acid synthesis across time.</h4>
<p>Mitochondrial fatty acid synthesis (mtFAS) acts as an important metabolic pathway long recognized to produce lipoic acid, a critical cofactor for several metabolic enzymes. Recent work has begun to uncover additional, important roles for this pathway. For example, we now know that mtFAS can perform metabolic nutrient sensing roles to coordinate lipoic acid synthesis with iron-sulfur (FeS) cluster biogenesis and assembly of oxidative phosphorylation complexes, and more <span class="citation" data-cites="E3d6CBaQ a2ZcMh2p">[<a href="#ref-E3d6CBaQ" role="doc-biblioref">27</a>,<a href="#ref-a2ZcMh2p" role="doc-biblioref">28</a>]</span>. Additionally, this pathway has received increased physiological focus with the discovery of patients with mutations in key mtFAS enzymes <span class="citation" data-cites="jMtpAwjn">[<a href="#ref-jMtpAwjn" role="doc-biblioref">29</a>]</span>.</p>
<p><i>MCT1</i>in <i>Saccharomyces cerevisiae</i> is an evolutionarily conserved acyltransferase responsible for the transfer of a malonyl group from malonyl-CoA to the mitochondrial acyl carrier protein (ACP). By knocking out this gene, one can simulate the effects of a disruption in mtFAS. In order to probe the relationship between mtFAS-related protein concentration and the effects of its perturbation on downstream metabolic processes from a systematic perspective, we used a <i>mct1</i>Δ model in <i>Saccharomyces cerevisiae</i> to measure steady state proteomics and transcriptomics at 12 hours after a shift to a non-fermentable carbon source, as well as steady state metabolomics at 0, 15, 30, 60, and 180 minutes after this shift in carbon source. By layering these data onto the <i>Saccharomyces cerevisiae</i> metabolic network using Metaboverse, we observed interesting respiratory signatures as expected based on our previous work <span class="citation" data-cites="E3d6CBaQ a2ZcMh2p">[<a href="#ref-E3d6CBaQ" role="doc-biblioref">27</a>,<a href="#ref-a2ZcMh2p" role="doc-biblioref">28</a>]</span>. For example, using Metaboverse, we noticed a strong pattern in the electron transfer from ubiquinol to cytochrome C of complex III of the electron transport chain (ETC) (Figure <a href="#fig:mct1_vignette">3</a> A). At the proteomics level, cytochrome C component proteins, CYC1 and CYC7 are both significantly reduced in concentration compared to wild-type cells (log<sub>2</sub>(fold change): -1.57 &amp; -0.88; p-value: &lt; 0.01 &amp; &lt; 0.01; respectively). This reduction in cytochrome C concentration is paired with a marked reduction in concentration of the protein components of cytochrome C reductase, which is a catalyst of this electron transfer reaction (average log<sub>2</sub>(fold change) of all measured protein components = -2.03, where 9/11 component proteins were measured (7/11 passed statistical significance thresholds of BH-corrected p-value &lt;= 0.05). Range of significant log<sub>2</sub>(fold change) values: -0.34 to -3.21).</p>
<div id="fig:mct1_vignette" class="fignos">
<figure>
<img src="./content/figures/fig_mct1.png" alt="" /><figcaption><span>Figure 3:</span> <strong>Metaboverse identifies several reaction motifs of interest in <i>mct1</i>Δ cells.</strong>
(A) Steady state proteomics overlaid on the reaction, “Electron transfer from ubiquinol to cytochrome c of complex III”. (B) Steady state proteomics and metabolomics at 15 minutes overlaid TCA-related reactions. Appropriate time stamps are displayed in the upper-right hand corner of each subplot. Metabolomics and proteomics values are shown as node shading.</figcaption>
</figure>
</div>
<p>A second pattern of interest that we expect in this model is the characteristic reduction of TCA-related enzymes. Motif analysis within the TCA cycle displays regulatory hotspots between metabolites and metabolite-protein interactions throughout the steps of the TCA cycle (Figure <a href="#fig:mct1_vignette">3</a> B). However, visualizing these motifs and data across the timecourse reveals interesting patterns. For the following metabolite values, we will provide those for the 15 minute timepoint as the statistical strength for the discussed metabolites is strongest at this time. For example, we notice while the catalytic enzymes in the TCA cycle are all reduced, several related metabolites are up-regulated across multiple time points in the dataset. First, citrate levels worsen across the metabolomics timecourse (at 15 min; log<sub>2</sub>FC: -0.-1.75, adjusted-p: 0.01), which is paired by reduced steady state levels of Ctp1 (log<sub>2</sub>FC: -0.64, adjusted-p: 0.03), a protein that catalyzes the transfer of citrate from the mitochondrial matrix to the cytosol <span class="citation" data-cites="Aq6MX1JZ">[<a href="#ref-Aq6MX1JZ" role="doc-biblioref">30</a>]</span>. Citrate is a key metabolite and the first step in the TCA cycle. We can hypothesize that due to central carbon metabolite reductions, Ctp1 may be down-regulated as a form of regulation to maintain citrate in the mitochondrial where it is most physiologically important from a metabolism point of view. Another point of interest is the up-regulation of Dic1 (log<sub>2</sub>FC: 2.15, adjusted-p: &lt; 0.01), which catalyzes the transfer of malate (at 15min; log<sub>2</sub>FC: 2.61, adjusted-p: &lt; 0.01) between the mitochondrial matrix and cytosol <span class="citation" data-cites="fpIWldmV">[<a href="#ref-fpIWldmV" role="doc-biblioref">31</a>]</span>. Interestingly, Dic1 is essential for growth in non-fermentable carbon source media. When yeast, especially those with deficits in TCA metabolism due to ablation of Mct1, are switched to a non-fermentable carbon, as was done in this experiment, they must adapt by up-regulating Dic1, as we see in this situation. Once malate is in the cytosol, it can be converted to pyruvate which can then feed the TCA cycle. This is further reasonable as these cells show reductions in pyruvate at time 0hr (log<sub>2</sub>FC: -1.09, adjusted-p: &lt; 0.01), but gradually begin to enrich pyruvate levels closer to WT levels (at 30min; log<sub>2</sub>FC: -0.66, adjusted-p: 0.01). It is also possible that the increased fumarate levels (at 15min; log<sub>2</sub>FC: 1.00, adjusted-p: &lt; 0.01) are related to the reduction in active fumarate hydratase (FH tetramer; log<sub>2</sub>FC: -1.39, adjusted-p: 0.03) as has been demonstrated previously and shown to associate with hereditary leiomyomatosis and renal cell cancer in humans <span class="citation" data-cites="Q7Fg6qpA">[<a href="#ref-Q7Fg6qpA" role="doc-biblioref">32</a>]</span>. This would therefore be an interesting point of further study to understand the adaptations these cells make to disruptions to the TCA cycle and their consequences.</p>
<p>By analyzing this multi-omics dataset using reaction motif analysis and other interactive visualization, interesting questions arise. We see several reaction motifs that are expected based on prior knowledge of this biological model, as well as other interesting behaviors worthy of further follow-up. This demonstrates the potential Metaboverse has to act as a valuable hypothesis-generation tool, as well as a convenient platform for visualization and analysis of a user’s dataset in the context of the metabolic or other reaction networks.</p>
<h4 id="metabolic-signatures-in-human-lung-adenocarcinomas-compared-to-normal-lung-tissue.">2. Metabolic signatures in human lung adenocarcinomas compared to normal lung tissue.</h4>
<p>We next turned to published human lung adenocarcinoma steady state metabolomics data <span class="citation" data-cites="Z7HkOV8x">[<a href="#ref-Z7HkOV8x" role="doc-biblioref">33</a>]</span> to assess the utility of Metaboverse when analyzing this data. Lung cancer remains a leading cause of death worldwide and a more complete understanding of the metabolism of these tumors is essential in understanding how to better treat the condition.</p>
<p>Consistent with the original study <span class="citation" data-cites="Z7HkOV8x">[<a href="#ref-Z7HkOV8x" role="doc-biblioref">33</a>]</span>, and in our recent re-study of the data <span class="citation" data-cites="jGMmHjyp">[<a href="#ref-jGMmHjyp" role="doc-biblioref">15</a>]</span>, nucleotide metabolism was broadly up-regulated in adenocarcinoma samples in the motif analysis and perturbation connectivity analysis (Figure <a href="#fig:lung_vignette">4</a> A). We also notice similar perturbations in xanthine (Figure <a href="#fig:lung_vignette">4</a> B), glutamine, and others, which are highlighted to the user quickly in the motif and perturbation connectivity analyses. However, as we previous emphasized <span class="citation" data-cites="jGMmHjyp">[<a href="#ref-jGMmHjyp" role="doc-biblioref">15</a>]</span>, by approaching these perturbations in a reaction-centric approach, we can identify regulatory behavior that further contextualizes the data. For example, we highlighted the up-regulation of glyceric acid coupled with the proximal down-regulation of 3-Phosphoglyceric acid indicates activity of glycerate kinase, which is missed in the original study, and which has connections to serine metabolism which may be fostering an ideal environment for tumorigenesis (Figure <a href="#fig:lung_vignette">4</a> C). Interestingly, we see that across the measured and significant metabolites involved in the TCA cycle, we see up-regulation of malate (log<sub>2</sub> Fold Change: 0.39, adjusted-p: 0.02) and down-regulation of citrate (log<sub>2</sub> Fold Change: -0.64, adjusted-p: 0.01). This is consistent with the hypothesis that the TCA cycle is being starved of carbon via pyruvate, which is probably being shunted to lactate production, thus the lower citrate levels, while part of the TCA cycle can be fed through glutamate (log<sub>2</sub> Fold Change: 0.47, adjusted-p: &lt; 0.01), thus the increased malate levels (Figure <a href="#fig:lung_vignette">4</a> D).</p>
<div id="fig:lung_vignette" class="fignos">
<figure>
<img src="./content/figures/fig_lung.png" alt="" /><figcaption><span>Figure 4:</span> <strong>Metaboverse identifies nucleotide metabolism signatures in lung adenomcarcinoma metabolomics data.</strong>
(A) Upregulation of several nucleotide metabolites. (B) Identification of xanthine regulation by both motif and perturbation connectivity analysis. (C) Regulatory activity between glyceric acid and 3-Phosphoglyceric acid identified by motif analysis. (D) Disruptions of TCA metabolism support canonical disruptions during adenocarcinoma development.</figcaption>
</figure>
</div>
<p>Metaboverse simplifies the analysis process and allows users more flexibility via its interactive platform to identify canonical and interesting, regulatory patterns within their data with ease. While we previously identified the regulatory pattern identified in Figure <a href="#fig:lung_vignette">4</a> C, Metaboverse offers an automated platform for discovery of such events, which were missed in the original study. We hope that by using Metaboverse, users will be able to extract new and exciting hypotheses that can drive their field forward.</p>
<h2 id="discussion">Discussion</h2>
<p>In this manuscript, we introduce a new software tool for analysis and exploration of user data layered on the metabolic and global reaction networks. To improve on previous tools with similar capabilities, we introduced several new analytical tools and methods to aid users in the automated identification and discovery of regulatory patterns within their data in a reaction network context. These include the automated ability to identify reaction regulatory events across the global reaction network, such as a reaction where an input is low abundance and an output is high. Metaboverse also provides dynamic and interactive visualization capabilities to search for patterns and features within the user data manually within classical pathway representations. If a user is interested in how a reaction motif is propagating across the global reaction network and not just a single pathway, a user can explore a reaction component’s nearest reaction neighborhood. The user can also explore the connectedness of perturbations across the global network and begin to explore hypotheses around the role of redundancy within a biological network.</p>
<p>In order to handle the challenge of sparsity, particularly in regard to metabolomics data and the metabolic reaction network, we introduce a reaction collapsing feature which summarizes a series of connected reactions where values may be missing between the reactions, but where the terminal ends of the reaction path have measured values. Importantly, this augments the capabilities available within Metaboverse, especially in the identification of additional reaction motifs that may be of interest to the user.</p>
<p>We demonstrated the utility of Metaboverse in exploring single- and multi-omic datasets. We analyzed previously published studies, as well as generated a novel dataset that highlights the time-course, multi-omic capabilities of this framework.</p>
<p>While Metaboverse aims to enhance the computational toolkit for data analysis and hypothesis generation in metabolic and other experiments, a number of challenges still remain, which we intend to address in subsequent versions of this software. For example, while the reaction collapsing features of Metaboverse aid in identifying patterns across several reactions where data may be missing, there are a variety of biological and technical edge cases that need to be considered in future implementations of this feature. This is particularly challenging in datasets where few metabolites were measured. Hopefully, as technical limitations in metabolomics are also overcome, more complete snapshots of metabolism will be visible. Additionally, while we take a more straightforward and somewhat rudimentary approach to statistical significance integration in the reaction motif searches, more holistic platforms for cross-omics integration are needed and remain a consequential challenge across multi-omics research.</p>
<p>In summary, we hope that Metaboverse will bring a new perspective to users’ data. We envision Metaboverse to be a staple tool in the metabolic research toolkit that will help researchers critically and holistically consider their data in the context of biological network interactions and help draw the connections needed to aid them in extracting new and exciting hypotheses that might be challenging to do without this tool.</p>
<h2 id="methods">Methods</h2>
<p>A tutorial for how to use Metaboverse can be found at metaboverse.readthedocs.io/getting-started.</p>
<h3 id="network-curation">1. Network Curation</h3>
<p>Biological networks are curated using the current version of the Reactome database. In particular, the pathway records for each species, complex component and interaction data, Ensembl, and UniProt Reactome mapping tables are integrated into the network database for Metaboverse. Additionally, the ChEBI database names table (ftp://ftp.ebi.ac.uk/pub/databases/chebi/Flat_file_tab_delimited/names.tsv.gz) is integrated. These data are used to generate a series of mapping dictionaries for entities to reactions and reactions to pathways for curation of the global network.</p>
<p>After the relevant information is parsed from each table or record, the global network is propagated using the NetworkX networking framework [cite:networkx] to generate nodes for each reaction and reaction component, and edges connecting components to the appropriate reactions. In some cases, a separate ID is used to generate two nodes for the same metabolite within two separate compartments to aid in visualization downstream; however, user data for the given entity would be properly mapped to both nodes.</p>
<p>After the network is curated for the user-specified organism, each node’s degree (or magnitude of edges or connections) is determined to aid in the user’s downstream ability to avoid visualizing high-degree components, such as a proton or water, on the metabolic network, which can lead to graphical entanglement and cluttering and a decrease in computational performance [cite:Waller;GigaScience;2020].</p>
<h3 id="data-overlay-and-broadcasting-for-missing-entities">2. Data overlay and broadcasting for missing entities</h3>
<p>In order to overlay user data on the global network, first, user-provided gene expression, protein abundance, and/or metabolite abundances’ names are mapped to Metaboverse compatible identifiers. For components that Metaboverse is unable to map, a list will be returned to the user so they can provide alternative names to aid in mapping. Second, provided data values are mapped to the appropriate nodes in the network. In cases where gene expression data is available, but protein abundance data is missing, Metaboverse will take the average (or user-defined??) of the available gene expression values to broadcast to the protein node. For complexes, all available component values (metabolites, proteins, etc.) are averaged (or user-defined??). Nodes for which values were inferred will be marked by a dashed border during visualization to clearly show which values are known and which were inferred.</p>
<h3 id="collapsing-reactions-with-missing-expression-or-abundance-user-data">3. Collapsing reactions with missing expression or abundance user data</h3>
<p>After data mapping is complete, Metaboverse will generate a collapsed network representation for optional viewing during later visualization. We did, however, choose to enforce a limit of up to three reactions that can be collapsed as data down a pathway should only be inferred so far. We also enforced certain parameters for reaction collapse as follows:</p>
<ol type="1">
<li><p>If a reaction has at least one known or inferred value for inputs (reactants) and one known or inferred value for outputs (products), the reaction will be left as is. During the entire reaction collapse step, known catalysts are included when assessing whether a reaction has measured output values (more of a catalyst should lead to more output in most cases) and inhibitors are included when assessing whether the reaction has measured input values (more inhibitor should lead to accumulation of input in most cases). Catalysts and inhibitors are not included when determining reaction neighbors as described below.</p></li>
<li><p>If a reaction has at least one known input, the input is left as is, and each reaction that shares the same input with the assessed reaction inputs are determined whether they have a measured output. If the neighbor reaction does not contain an known output value, the reaction is left as is. If the neighbor reaction does contain a measured output, the original reaction’s inputs and the neighbor reactions outputs are collapsed to form a single, pseudo-reaction between the two. If the reaction has at least one known output, the inverse is performed where neighbors with identical components as the reactions inputs are assessed for whether a collapsed reaction can be created.</p></li>
<li><p>If a reaction has no measured values, it is determined if the neighboring reactions on both sides (one sharing the reaction’s inputs and other sharing the reaction’s outputs) have measured values. If both neighbors contain a measured value, a collapsed pseudo-reaction is created summarizing all three reactions.</p></li>
</ol>
<p>For pseudo-reactions, appropriate notes are included to describe the collapse. During visualization, these pseudo-reactions are marked by black dashed edges and dashed node borders. A graphical representation of how this reaction collapse is performed can be found in Figure <a href="#fig:collapse_schematic">5</a>.</p>
<div id="fig:collapse_schematic" class="fignos">
<figure>
<img src="./content/figures/collapse_schematic.png" alt="" /><figcaption><span>Figure 5:</span> <strong>Reaction node collapse schematic.</strong>
(a) For reactions where at least one input and at least one output component contain a measured value from the user data, the reaction will be maintained as is. (b) Where an input of a reaction is known but no output has a known value, Metaboverse will search for all neighboring reactions that contain identical inputs. If the neighboring reaction has a known output value, the two reactions will be merged into one pseudo-reaction. (c) Where an output of a reaction is known but no input has a known value, Metaboverse will search for all neighboring reactions that contain identical outputs. If the neighboring reaction has a known input value, the two reactions will be merged into one pseudo-reaction. (d) For reactions with no known values, neighbor pairs that match the inputs and outputs of the considered reaction will be evaluated for whether their respective outputs and inputs both have known values. If values are known for both neighbors, the three reactions will be merged into one pseudo-reaction. (e) As in (d), but if one neighbor does not contain a value, the one does contain a value, no reaction merging will be performed. (f) As in (d), but if neither neighbors contain known values, no reaction merging will be performed. An asterisk (*) indicates the target reaction being considered for a given reaction collapse. A red node indicates a reaction input or output with a measured value. A white node indicates a reaction input or output with no measured value. A grey node indicates a reaction. A grey node with a dashed border indicates a pseudo-reaction. A solid edge indicates a known relationship. A dashed edge indicates a relationship inferred via reaction merging.</figcaption>
</figure>
</div>
<h3 id="regulatory-pattern-motif-searches">4. Regulatory pattern (motif) searches</h3>
<h3 id="nearest-neighborhood-searches">5. Nearest neighborhood searches</h3>
<p>In order to visualize all global connections, a user can select an entity (a gene, protein, or metabolite) and visualize all reactions that the component is involved in. By doing so, the user can visualize other downstream effects a change of one entity might have across the global network, which consequently aids in bridging and identifying any motifs that may occur between canonically annotated pathways. These neighborhoods can be expanded to view multiple downstream reaction steps and their accompanying genes, proteins, and metabolites by modulating the appropriate user option in the app.</p>
<p>Users can also limit which entities are shown by enforcing a degree threshold. By setting this value at 50, for example, the graph would not show nodes that have 50 or more connections. One caveat, however, is that this will occasionally break synchronous pathways into multiple pieces if one of these high-degree nodes was the bridge between two sides of a pathway.</p>
<h3 id="perturbation-connectivity">6. Perturbation connectivity</h3>
<p>Perturbation connectivity networks are generated by searching each reaction in the global network for any reaction where at least one component is significantly perturbed. Users can modify the necessary criteria to base the search on the expression or abundance value or the statistical value, and can choose the thresholding value to be used. For the expression thresholding, the provided value is assumed to be the absolute value, so a thresholding value of 3 would include any reactions where at least one component, showed a greater than 3 measured change or less than -3 measured change, the value of which is dependent on the data provided by the user, thus could represent log<sub>2</sub> fold changes, z-scores, or any other unit appropriate the biological context.</p>
<p>Once a list of perturbed reactions is collected, the network is constructed included each of these reactions and their components. Perturbed neighboring reactions that share components are thus connected within the graph and perturbed reactions that are not next to other perturbed reactions are shown as disconnected sub-graphs.</p>
<h3 id="network-visualization-and-exploration">7. Network visualization and exploration</h3>
<h4 id="dynamic-network-plotting">7.1 Dynamic network plotting</h4>
<p>Users interact with Metaboverse through an interactive app interface. The app uses Electron, a cross-platform app framework that uses JavaScript, HTML, and CSS to design the interface. Metaboverse thus comes packaged as a single executable app with all necessary dependencies included for running on Linux, MacOS, and Windows.</p>
<p>Interactive graphing is handled using the D3 and JQuery JavaScript libraries. Force-directed graphs are constructed by taking the user selection for a pathway or entity and determining the reactions that are components of that pathway. All inputs, outputs, modifiers, and other components of these reactions, along with edges where both source and target are found in the sub-graph as nodes, are included and plotted. Relevant metadata, such as user-provided data and reaction descriptions, can be accessed by the user in real time. Metadata for categorical displays, such as edge or node type, are extracted from the metadata during graphing of the sub-network.</p>
<p>Some performance optimization features are included by default to prevent computational overload. For example, nearest neighbor sub-graphs with more than 1500 nodes, or nodes with more than 500 edges will not be plotted as plotting of this information in real-time is computationally prohibitive.</p>
<h4 id="visualizing-pathways-and-super-pathways">7.2 Visualizing pathways and super-pathways</h4>
<p>In order to visualize a pathway, a user selects their pathway of choice and all component reactions and their reactants, products, modifiers, and metadata are parsed from the global network. Super-pathways help categorize these pathways and are defined as any pathway containing more than 200 nodes.</p>
<h4 id="visualizing-compartments">7.3 Visualizing compartments</h4>
<p>Compartments are derived from Reactome annotations. Compartment visualizations are generated using D3’s hull plotting feature. Compartment boundaries are definde at the reaction levels and made to encompass each reaction’s reactants, products, and modifiers for that given compartment.</p>
<h4 id="annotations">7.4 Annotations</h4>
<p>Annotations for each reaction are derived from the Reactome database. Pseudo-reactions annotations do not include this information; instead they include notes on which reactions were collapsed to create the selected pseudo-reaction. All inferred pseudo-reactions and protein or complex values are displayed with dashed edges to differentiation from measured values.</p>
<h4 id="additional-features">7.6 Additional features</h4>
<p>While Metaboverse will continue to undergo development and new features will be added, we will briefly highlight some additional features available at time of publication. We encourage users to check the documentation for more current updates and information regarding use of Metaboverse <span class="citation" data-cites="qPg4pqeH">[<a href="#ref-qPg4pqeH" role="doc-biblioref">14</a>]</span>.</p>
<h5 id="a-toggle-genes">7.6a Toggle genes</h5>
<p>As gene components can crowd the graph space, users can toggle gene display on and off using the appropriate button. The graph is then refreshed to either include or ignore gene components based on their node meta-tag.</p>
<h5 id="b-toggling-values">7.6b Toggling values</h5>
<p>Users can switch between coloring nodes based ono the value or statistic provided by toggling the appropriate button. Colorbar information for the dataset is saved in the graph metadata during curation and used to generate a colorbar. The colorbar for statistics is represented using a -log<sub>10</sub> scale for a statistic value originally ranging between 0 and 1.</p>
<h5 id="c-toggling-featureslabels">7.6c Toggling features/labels</h5>
<p>By default, reaction and feature labels are displayed by hovering the mouse over the node. Reaction or feature nodes can have the labels statically displayed by selecting the appropriate button. An event watch function is used to watch for this user selection and update the display of the node labels.</p>
<h5 id="d-toggling-collapsed-reactions">7.6d Toggling collapsed reactions</h5>
<p>By selecting the appropriate button, users can toggle between displaying a full or collapsed pathway representation of the sub-network. By selecting this button, the graph is refreshed using the appropriate reaction dictionary, where for graphing of the collapsed representation, a reaction with available pseudo-reactions substituted for the original reactions are included for graph propagation.</p>
<h5 id="e-view-curated-pathway-image">7.6e View curated pathway image</h5>
<p>While Metaboverse graphs networks dynamically, users may be more familiar or comfortable with classical, curated pathway layouts when exploring their data. For a given pathway graph, the user can select the appropriate button and Metaboverse will open a new window with the Reactome curated pathway layout.</p>
<h5 id="f-saving-graphs">7.6f Saving graphs</h5>
<p>Users can generate a PNG output file for any network created in Metaboverse by selecting the appropriate button.</p>
<h5 id="g-nearest-neighbor-and-hub-thresholding">7.6g Nearest neighbor and hub thresholding</h5>
<p>The number of nearest neighbors to graph, or the limit to number of edges a graphed node can have, can be modulated by the user using the appropriate input spaces. When graphing a nearest neighbors network, Metaboverse will recursively fetch related reactions and their neighbors until a node display threshold is reached. This allows the user to visualize downstream effects of a change that may propagate across several reactions. The hub threshold option prevents plotting of nodes with more than the specified number of edges. This is handling during graphing by excluding any entity nodes that meet this criteria as the neighborhood is propagated. This is particularly useful in removing hub nodes, such as water or protons, which may be less relevant to the user experience and can quickly clutter the graph. This feature can also help plot more extensive neighborhoods, as often neighborhoods quickly link to high-degree nodes, such as water, and limit graphing ability.</p>
<h5 id="h-metadata-display">7.6h Metadata display</h5>
<p>To help inform the user of selection information and relevant metadata, a space in the legend bar during visualization is reserved for spaces where this information can be displayed, which is updated based on the user’s input as it is provided.</p>
<h3 id="packaging">8. Packaging</h3>
<p>The Metaboverse app is packaged using Electron. Back-end network curation and data processing is performed using Python and the NetworkX library. Front-end visualization is performed using Javascript and relies on the D3 and JQuery packages. Saving network representations to a PNG file is performed using the d3-save-svg and string-pixel-width packages (Table <a href="#tbl:dependencies">1</a>). Documentation for Metaboverse is found at metaboverse.readthedocs.io. Continuous integration services are performed by Travis CI to routinely run test cases for each change made to the Metaboverse architecture. The Metaboverse source code can be accessed at https://github.com/Metaboverse/metaboverse. The code used to draft and revise this manuscript, as well as all associated scripts used to generate and visualize the data presented in this manuscript can be accessed at https://github.come/Metaboverse/manuscript.</p>
<div id="tbl:dependencies" class="tablenos">
<table>
<caption><span>Table 1:</span> Dependencies table. </caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 66%" />
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>HTML</td>
<td>N/A</td>
</tr>
<tr class="even">
<td>CSS</td>
<td>N/A</td>
</tr>
<tr class="odd">
<td>Javascript</td>
<td>N/A</td>
</tr>
<tr class="even">
<td>Electron</td>
<td><span class="citation" data-cites="Vm4WQy8V">[<a href="#ref-Vm4WQy8V" role="doc-biblioref">34</a>]</span></td>
</tr>
<tr class="odd">
<td>JQuery</td>
<td><span class="citation" data-cites="H1mR13bo">[<a href="#ref-H1mR13bo" role="doc-biblioref">35</a>]</span></td>
</tr>
<tr class="even">
<td>D3</td>
<td><span class="citation" data-cites="dVWOf7kz">[<a href="#ref-dVWOf7kz" role="doc-biblioref">36</a>]</span></td>
</tr>
<tr class="odd">
<td>string-pixel-width</td>
<td><span class="citation" data-cites="GZmT9x2e">[<a href="#ref-GZmT9x2e" role="doc-biblioref">37</a>]</span></td>
</tr>
<tr class="even">
<td>d3-save-svg</td>
<td><span class="citation" data-cites="NW4mv3Ac">[<a href="#ref-NW4mv3Ac" role="doc-biblioref">38</a>]</span></td>
</tr>
<tr class="odd">
<td>Python</td>
<td><span class="citation" data-cites="avT1fiCL">[<a href="#ref-avT1fiCL" role="doc-biblioref">39</a>]</span></td>
</tr>
<tr class="even">
<td>pandas</td>
<td><span class="citation" data-cites="2z2qDwzz U5AcoDOX">[<a href="#ref-2z2qDwzz" role="doc-biblioref">40</a>,<a href="#ref-U5AcoDOX" role="doc-biblioref">41</a>]</span></td>
</tr>
<tr class="odd">
<td>numpy</td>
<td><span class="citation" data-cites="DvNC6thO">[<a href="#ref-DvNC6thO" role="doc-biblioref">42</a>]</span></td>
</tr>
<tr class="even">
<td>scipy</td>
<td><span class="citation" data-cites="8Miti2Gz">[<a href="#ref-8Miti2Gz" role="doc-biblioref">43</a>]</span></td>
</tr>
<tr class="odd">
<td>matplotlib</td>
<td><span class="citation" data-cites="1026Gxdsi">[<a href="#ref-1026Gxdsi" role="doc-biblioref">44</a>]</span></td>
</tr>
<tr class="even">
<td>NetworkX</td>
<td><span class="citation" data-cites="ZrddLbmB">[<a href="#ref-ZrddLbmB" role="doc-biblioref">45</a>]</span></td>
</tr>
</tbody>
</table>
</div>
<h3 id="validation-using-biological-data">9. Validation using biological data</h3>
<h4 id="mct1-perturbation-in-saccharomyces-cerevisiae">9.1 <i>mct1</i> perturbation in <i>Saccharomyces cerevisiae</i></h4>
<h5 id="yeast-strains">Yeast Strains</h5>
<p><i>Saccharomyces cerevisiae</i> BY4743 (MATa/Α, his3/his3, leu2/leu2, ura3/ura3, met15/MET15, lys2/LYS2) was used to generate the mct1Δ strain as described in <span class="citation" data-cites="w09c7vaT">[<a href="#ref-w09c7vaT" role="doc-biblioref">46</a>]</span>.</p>
<h5 id="rna-sequencing-sample-preparation">RNA-sequencing sample preparation</h5>
<p>RNA sequencing data were generated by growing <i>Saccharomyces cerevisiae</i> biological replicates for strains <i>mct1Δ</i> (n=4) and wild-type (n=4). Briefly, cells were grown in glucose and switched to raffinose-supplemented growth medium for 0, 3, and 12 hours such that at time of harvest, cultures were at OD<sub>600</sub>=1. Cultures were flash frozen and later total RNA was isolated using the Direct-zol kit (Zymo Research) with on-column DNase digestion and water elution. Sequencing libraries were prepared by purifying intact poly(A) RNA from total RNA samples (100-500 ng) with oligo(dT) magnetic beads and stranded mRNA sequencing libraries were prepared as described using the Illumina TruSeq Stranded mRNA Library Preparation Kit (RS-122-2101, RS-122-2102). Purified libraries were qualified on an Agilent Technologies 2200 TapeStation using a D1000 ScreenTape assay (cat# 5067-5582 and 5067-5583). The molarity of adapter-modified molecules was defined by quantitative PCR using the Kapa Biosystems Kapa Library Quant Kit (cat#KK4824). Individual libraries were normalized to 5 nM and equal volumes were pooled in preparation for Illumina sequence analysis. Sequencing libraries (25 pM) were chemically denatured and applied to an Illumina HiSeq v4 single read flow cell using an Illumina cBot. Hybridized molecules were clonally amplified and annealed to sequencing primers with reagents from an Illumina HiSeq SR Cluster Kit v4-cBot (GD-401-4001). Following transfer of the flowcell to an Illumina HiSeq 2500 instrument (HCSv2.2.38 and RTA v1.18.61), a 50 cycle single-read sequence run was performed using HiSeq SBS Kit v4 sequencing reagents (FC-401-4002).</p>
<h5 id="sequence-analysis">Sequence analysis</h5>
<p>Sequence FASTQ files were processed using XPRESSpipe <span class="citation" data-cites="e007dQqS">[<a href="#ref-e007dQqS" role="doc-biblioref">47</a>]</span>. Batch and log files are available at <span class="citation" data-cites="EcK8eBqS">[<a href="#ref-EcK8eBqS" role="doc-biblioref">48</a>]</span>. Notably, reads were trimmed of adapters (Read1: AGATCGGAAGAGCACACGTCTGAACTCCAGTCA, Read2: AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT). Based on library complexity quality control, de-duplicated alignments were used for read quantification due to the high number of duplicated sequences in each library. Differential expression analysis was performed using DESeq2 <span class="citation" data-cites="w9AOzBMw">[<a href="#ref-w9AOzBMw" role="doc-biblioref">49</a>]</span> by comparing <i>mct1Δ</i> samples with wild-type samples at the 12-hour time-point to match the steady state proteomics data. log<sub>2</sub>(fold change) and false disovery rate (“p-adj”) values were extracted from the DESeq2 output.</p>
<h5 id="proteomics-analysis">Proteomics analysis</h5>
<p>Steady state quantitative proteomics data were generated as described in <span class="citation" data-cites="w09c7vaT">[<a href="#ref-w09c7vaT" role="doc-biblioref">46</a>]</span>. Briefly, cells were grown in glucose and switched to raffinose-supplemented growth medium overnight, and harvested at mid-log phase. For this analysis, we compared the <i>mct1Δ</i> (n=3) with the wild-type (n=3) cell populations. log<sub>2</sub>(fold change) values and Benjamini-Hochberg corrected p-values were generated by comparing <i>mct1Δ</i> with the wild-type cells. P-values were generated using a 2-tailed, homoscedastic Student’s T-test.</p>
<h5 id="metabolomics-sample-preparation">Metabolomics sample preparation</h5>
<p>Metabolomics data were generated by growing the appropriate yeast strains in synthetic minimal media (S-min) supplemented with 2% glucose until they reached OD<sub>600</sub> between 0.6-0.8. Cells were then transferred to S-min media containing 2% raffinose and harvested after 0, 15, 30, 60, and 180 minutes (n=6/time-point/strain).</p>
<h5 id="metabolite-extraction">Metabolite extraction</h5>
<p>A 75% boiling ethanol (EtOH) solution containing the internal standard d4-succinic acid (Sigma 293075) was then added to each sample. Boiling samples were vortexed and incubated at 90°C for 5 min. Samples were then incubated at -20 ˚C for 1 hr. After incubation, samples were centrifuged at 5,000 x g for 10 minutes at 4˚C. The supernatant was then transferred from each sample tube into a labeled, fresh 13x100mm glass culture tube. A second standard was then added (d27-myristic acid CDN Isotopes: D-1711). Pooled quality control samples were made by removing a fraction of collected supernatant from each sample and process blanks were made using only extraction solvent and no cell culture. The samples were then dried en vacuo. This process was completed in three separate batches.</p>
<h5 id="mass-spectrometry-analysis-of-samples">Mass Spectrometry Analysis of Samples</h5>
<p>All GC-MS analysis was performed with an Agilent 5977b GC-MS MSD-HES and an Agilent 7693A automatic liquid sampler. Dried samples were suspended in 40 µL of a 40 mg/mL O-methoxylamine hydrochloride (MOX) (MP Bio #155405) in dry pyridine (EMD Millipore #PX2012-7) and incubated for one hour at 37 °C in a sand bath. 25 µL of this solution was added to auto sampler vials. 60 µL of N-methyl-N-trimethylsilyltrifluoracetamide (MSTFA with 1%TMCS, Thermo #TS48913) was added automatically via the auto sampler and incubated for 30 minutes at 37 °C. After incubation, samples were vortexed and 1 µL of the prepared sample was injected into the gas chromatograph inlet in the split mode with the inlet temperature held at 250°C. A 10:1 split ratio was used for analysis of the majority of metabolites. For those metabolites that saturated the instrument at the 10:1 split concentration, a split of 50:1 was used for analysis. The gas chromatograph had an initial temperature of 60°C for one minute followed by a 10°C/min ramp to 325°C and a hold time of 5 minutes. A 30-meter Phenomenex Zebron AB-5HT with 5m inert Guardian capillary column was employed for chromatographic separation. Helium was used as the carrier gas at a rate of 1 mL/min. Figure <a href="#fig:mass_spec_deriv">6</a> demonstrates an example of the two-step derivatization process used to convert non-volatile metabolites to a volatile form amenable to GC-MS.</p>
<div id="fig:mass_spec_deriv" class="fignos">
<figure>
<img src="./content/figures/mass_spec_deriv.png" alt="" /><figcaption><span>Figure 6:</span> <strong>Mass Spectrometry derivatization process.</strong>
This figure demonstrates an example of the two-step derivatization process used to convert non-volatile metabolites to a volatile form amenable to GC-MS. Pyruvic acid is used here as an example.</figcaption>
</figure>
</div>
<h5 id="analysis-of-mass-spectrometry-data">Analysis of Mass Spectrometry Data</h5>
<p>Data was collected using MassHunter software (Agilent). Metabolites were identified and their peak area was recorded using MassHunter Quant. This data was transferred to an Excel spread sheet (Microsoft, Redmond WA). Metabolite identity was established using a combination of an in-house metabolite library developed using pure purchased standards, the NIST library and the Fiehn library. There are a few reasons a specific metabolite may not be observable through GC-MS. The metabolite may not be amenable to GC-MS due to its size, or a quaternary amine such as carnitine, or simply because it does not ionize well. Metabolites that do not ionize well include oxaloacetate, histidine and arginine. Cysteine can be observed depending on cellular conditions. It often forms disulfide bonds with proteins and is generally at a low concentration. Metabolites may not be quantifiable if they are only present in very low concentrations.</p>
<p>Resulting data from all samples were normalized to the internal standard d4-succinate. Samples highlighted in yellow were swapped with normalized data from the unsaturated run. The identity of each peak was ensured by visualization in Mass Hunter Qual and Quant. The data has also been roughly reordered by metabolic process. False positives were removed. All but the best representative of duplicate metabolites, which were created through variability in the derivatization process, were also removed.</p>
<h4 id="human-lung-adenomcarcinoma-metabolomics.">9.2 Human lung adenomcarcinoma metabolomics.</h4>
<p>Data were accessed from Metabolomics Workbench <span class="citation" data-cites="yAeERgSN">[<a href="#ref-yAeERgSN" role="doc-biblioref">50</a>]</span> and processed as in our previous re-study of this data <span class="citation" data-cites="jGMmHjyp">[<a href="#ref-jGMmHjyp" role="doc-biblioref">15</a>]</span>.</p>
<h3 id="data-availability.">10. Data availability.</h3>
<p>Raw data produced for this study are in the process of being uploaded to the appropriate repositories. In the meantime, the raw data can be accessed at <span class="citation" data-cites="EcK8eBqS">[<a href="#ref-EcK8eBqS" role="doc-biblioref">48</a>]</span>.</p>
<p>The curated networks for these data are available at <span class="citation" data-cites="EcK8eBqS">[<a href="#ref-EcK8eBqS" role="doc-biblioref">48</a>]</span>. Networks were generated by taking the 12-hour transcriptomics and proteomics datasets with their appropriate log<sub>2</sub>(fold change) and statistical values, along with the 0, 15, 30, 60, and 180 minute metabolomics datasets with their respective log<sub>2</sub>(fold change) and statistical values and layering these data on the <i>Saccharomyces cereviseae</i> global reaction network as curated by Metaboverse from the Reactome database. Reaction motifs and global connectivity analyses were performed within the Metaboverse platform.</p>
<p>The Metaboverse source code is available at <span class="citation" data-cites="vMGMbT9f">[<a href="#ref-vMGMbT9f" role="doc-biblioref">51</a>]</span> and archived versions can be accessed at Zenodo [].</p>
<p>The source code and data for this manuscript and subsequent analyses is available at <span class="citation" data-cites="kOjxC0II">[<a href="#ref-kOjxC0II" role="doc-biblioref">52</a>]</span> and archived versions can be accessed at Zenodo [].</p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>We thank Alex J. Bott (U. of Utah), Ahmad A. Cluntun (U. of Utah), Kevin G. Hicks (U. of Utah), Jeffrey T. Morgan (U. of Utah), and other members of the Rutter lab for their thoughtful insights and suggestions. We thank Brian Dalley and the University of Utah High-Throughput Genomics Core for help with RNA-sequencing library preparation. The support and resources from the Center for High-Performance Computing at the University of Utah are gratefully acknowledged.</p>
<h2 id="funding">Funding</h2>
<p>J.A.B. received support from the National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK) Inter-disciplinary Training Grant T32 Program in Computational Approaches to Diabetes and Metabolism Research, 1T32DK11096601 to Wendy W. Chapman and Simon J. Fisher (https://www.niddk.nih.gov/). S.M.N. received support from The United Mitochondrial Disease Foundation (https://www.umdf.org/) and American Cancer Society (https://www.cancer.org/) postdoctoral fellowships, along with T32HL007576. J.E.C. is funded by S10OD016232, S10OD021505, and U54DK110858. This work was supported by NIDDK fellowship 1T32DK11096601 (to J.A.B.) (https://www.niddk.nih.gov/) and NIH grant R35GM13185 (to J.R.) (https://www.nih.gov/). The computational resources used were partially funded by the NIH Shared Instrumentation Grant 1S10OD021644-01A1 (https://www.nih.gov/). Mass spectrometry equipment was obtained through NCRR Shared Instrumentation Grant 1S10OD016232-01, 1S10OD018210-01A1, and 1S10OD021505-01. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
<h2 id="contributions">Contributions</h2>
<ul>
<li>Conceptualization: J.A.B., T.C.W., B.W., J.R.</li>
<li>Supervision: J.A.B., B.W., J.R.</li>
<li>Project Administration: J.A.B.</li>
<li>Investigation: J.A.B., T.C.W., Y.O., S.M.N., T.V.</li>
<li>Formal Analysis: J.A.B.</li>
<li>Software: J.A.B., Y.Z.</li>
<li>Methodology: J.A.B., Y.Z.</li>
<li>Validation: J.A.B., Y.O., I.G.</li>
<li>Data Curation: J.A.B., T.C.W.</li>
<li>Resources: J.A.B., J.C., B.W., J.R.</li>
<li>Funding Acquisition: J.A.B., J.C., B.W., J.R.</li>
<li>Writing - Original Draft Preparation: J.A.B.</li>
<li>Writing - Review &amp; Editing: J.A.B., Y.Z., T.C.W., Y.O., S.N.M., T.V., I.G., J.C., B.W., J.R.</li>
<li>Visualization: J.A.B.</li>
</ul>
<h2 class="page_break_before" id="supplementary-material" class="page_break_before">Supplementary Material</h2>
<h2 class="page_break_before" id="references" class="page_break_before">References</h2>
<!-- Explicitly insert bibliography here -->
<div id="refs" class="references hanging-indent" role="doc-bibliography">
<div id="ref-1AxIC7Cvy">
<p>1. <strong>Systems Biology and Multi-Omics Integration: Viewpoints from the Metabolomics Research Community</strong><br />
Farhana R. Pinu, David J. Beale, Amy M. Paten, Konstantinos Kouremenos, Sanjay Swarup, Horst J. Schirra, David Wishart<br />
<em>Metabolites</em> (2019-04-18) <a href="https://doi.org/ggt2fd">https://doi.org/ggt2fd</a><br />
DOI: <a href="https://doi.org/10.3390/metabo9040076">10.3390/metabo9040076</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31003499">31003499</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6523452">PMC6523452</a></p>
</div>
<div id="ref-C62ou67p">
<p>2. <strong>MetaboAnalyst: a web server for metabolomic data analysis and interpretation</strong><br />
J. Xia, N. Psychogios, N. Young, D. S. Wishart<br />
<em>Nucleic Acids Research</em> (2009-05-08) <a href="https://doi.org/c4hzc2">https://doi.org/c4hzc2</a><br />
DOI: <a href="https://doi.org/10.1093/nar/gkp356">10.1093/nar/gkp356</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/19429898">19429898</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2703878">PMC2703878</a></p>
</div>
<div id="ref-PcBvPAjh">
<p>3. <strong>MetaboAnalyst 4.0: towards more transparent and integrative metabolomics analysis</strong><br />
Jasmine Chong, Othman Soufan, Carin Li, Iurie Caraus, Shuzhao Li, Guillaume Bourque, David S Wishart, Jianguo Xia<br />
<em>Nucleic Acids Research</em> (2018-05-14) <a href="https://doi.org/gdwvwd">https://doi.org/gdwvwd</a><br />
DOI: <a href="https://doi.org/10.1093/nar/gky310">10.1093/nar/gky310</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/29762782">29762782</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6030889">PMC6030889</a></p>
</div>
<div id="ref-1BJixYIRV">
<p>4. <strong>Cytoscape: A Software Environment for Integrated Models of Biomolecular Interaction Networks</strong><br />
P. Shannon<br />
<em>Genome Research</em> (2003-11-01) <a href="https://doi.org/b7kgpg">https://doi.org/b7kgpg</a><br />
DOI: <a href="https://doi.org/10.1101/gr.1239303">10.1101/gr.1239303</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/14597658">14597658</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC403769">PMC403769</a></p>
</div>
<div id="ref-Fe0QzlwH">
<p>5. <strong>MetExplore: collaborative edition and exploration of metabolic networks</strong><br />
Ludovic Cottret, Clément Frainay, Maxime Chazalviel, Floréal Cabanettes, Yoann Gloaguen, Etienne Camenen, Benjamin Merlet, Stéphanie Heux, Jean-Charles Portais, Nathalie Poupin, … Fabien Jourdan<br />
<em>Nucleic Acids Research</em> (2018-04-30) <a href="https://doi.org/gdwx39">https://doi.org/gdwx39</a><br />
DOI: <a href="https://doi.org/10.1093/nar/gky301">10.1093/nar/gky301</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/29718355">29718355</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6030842">PMC6030842</a></p>
</div>
<div id="ref-DdChGH39">
<p>6. <strong>MetExplore: a web server to link metabolomic experiments and genome-scale metabolic networks</strong><br />
L. Cottret, D. Wildridge, F. Vinson, M. P. Barrett, H. Charles, M.-F. Sagot, F. Jourdan<br />
<em>Nucleic Acids Research</em> (2010-05-05) <a href="https://doi.org/dkx7z7">https://doi.org/dkx7z7</a><br />
DOI: <a href="https://doi.org/10.1093/nar/gkq312">10.1093/nar/gkq312</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/20444866">20444866</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2896158">PMC2896158</a></p>
</div>
<div id="ref-l3pIjmaQ">
<p>7. <strong>Reactome: a knowledgebase of biological pathways</strong><br />
G. Joshi-Tope<br />
<em>Nucleic Acids Research</em> (2004-12-17) <a href="https://doi.org/cjhf62">https://doi.org/cjhf62</a><br />
DOI: <a href="https://doi.org/10.1093/nar/gki072">10.1093/nar/gki072</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/15608231">15608231</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC540026">PMC540026</a></p>
</div>
<div id="ref-GZkNnAkC">
<p>8. <strong>The reactome pathway knowledgebase.</strong><br />
Bijay Jassal, Lisa Matthews, Guilherme Viteri, Chuqiao Gong, Pascual Lorente, Antonio Fabregat, Konstantinos Sidiropoulos, Justin Cook, Marc Gillespie, Robin Haw, … Peter D’Eustachio<br />
<em>Nucleic acids research</em> (2020-01-08) <a href="https://www.ncbi.nlm.nih.gov/pubmed/31691815">https://www.ncbi.nlm.nih.gov/pubmed/31691815</a><br />
DOI: <a href="https://doi.org/10.1093/nar/gkz1031">10.1093/nar/gkz1031</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31691815">31691815</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7145712">PMC7145712</a></p>
</div>
<div id="ref-MFnInm09">
<p>9. <strong>The Reactome Pathway Knowledgebase.</strong><br />
Antonio Fabregat, Steven Jupe, Lisa Matthews, Konstantinos Sidiropoulos, Marc Gillespie, Phani Garapati, Robin Haw, Bijay Jassal, Florian Korninger, Bruce May, … Peter D’Eustachio<br />
<em>Nucleic acids research</em> (2018-01-04) <a href="https://www.ncbi.nlm.nih.gov/pubmed/29145629">https://www.ncbi.nlm.nih.gov/pubmed/29145629</a><br />
DOI: <a href="https://doi.org/10.1093/nar/gkx1132">10.1093/nar/gkx1132</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/29145629">29145629</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5753187">PMC5753187</a></p>
</div>
<div id="ref-K14GGVYv">
<p>10. <strong>Superfamilies of Evolved and Designed Networks</strong><br />
R. Milo<br />
<em>Science</em> (2004-03-05) <a href="https://doi.org/dm5h6p">https://doi.org/dm5h6p</a><br />
DOI: <a href="https://doi.org/10.1126/science.1089167">10.1126/science.1089167</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/15001784">15001784</a></p>
</div>
<div id="ref-1CFRUQ2Md">
<p>11. <strong>Network motifs in the transcriptional regulation network of Escherichia coli</strong><br />
Shai S. Shen-Orr, Ron Milo, Shmoolik Mangan, Uri Alon<br />
<em>Nature Genetics</em> (2002-04-22) <a href="https://doi.org/dr6vnt">https://doi.org/dr6vnt</a><br />
DOI: <a href="https://doi.org/10.1038/ng881">10.1038/ng881</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/11967538">11967538</a></p>
</div>
<div id="ref-18AaRFS75">
<p>12. <strong>Activity motifs reveal principles of timing in transcriptional control of the yeast metabolic network</strong><br />
Gal Chechik, Eugene Oh, Oliver Rando, Jonathan Weissman, Aviv Regev, Daphne Koller<br />
<em>Nature Biotechnology</em> (2008-10-26) <a href="https://doi.org/ftng9m">https://doi.org/ftng9m</a><br />
DOI: <a href="https://doi.org/10.1038/nbt.1499">10.1038/nbt.1499</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/18953355">18953355</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2651818">PMC2651818</a></p>
</div>
<div id="ref-MFhHC3Pf">
<p>13. <strong>Dietary methionine influences therapy in mouse cancer models and alters human metabolism</strong><br />
Xia Gao, Sydney M. Sanderson, Ziwei Dai, Michael A. Reid, Daniel E. Cooper, Min Lu, John P. Richie Jr, Amy Ciccarella, Ana Calcagnotto, Peter G. Mikhael, … Jason W. Locasale<br />
<em>Nature</em> (2019-07-31) <a href="https://doi.org/ggrj3d">https://doi.org/ggrj3d</a><br />
DOI: <a href="https://doi.org/10.1038/s41586-019-1437-3">10.1038/s41586-019-1437-3</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31367041">31367041</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6951023">PMC6951023</a></p>
</div>
<div id="ref-qPg4pqeH">
<p>14. <strong>Metaboverse — Metaboverse 0.0.0-alpha documentation</strong><a href="https://metaboverse.readthedocs.io/en/latest/">https://metaboverse.readthedocs.io/en/latest/</a></p>
</div>
<div id="ref-jGMmHjyp">
<p>15. <strong>Compartment and hub definitions tune metabolic networks for metabolomic interpretations</strong><br />
T Cameron Waller, Jordan A Berg, Alexander Lex, Brian E Chapman, Jared Rutter<br />
<em>GigaScience</em> (2020-01-01) <a href="https://doi.org/ggt7sk">https://doi.org/ggt7sk</a><br />
DOI: <a href="https://doi.org/10.1093/gigascience/giz137">10.1093/gigascience/giz137</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31972021">31972021</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6977586">PMC6977586</a></p>
</div>
<div id="ref-12Wj4vZRt">
<p>16. <strong>On Nearest-Neighbor Graphs</strong><br />
D. Eppstein, M. S. Paterson, F. F. Yao<br />
<em>Discrete &amp; Computational Geometry</em> (1997-04) <a href="https://doi.org/brwn8g">https://doi.org/brwn8g</a><br />
DOI: <a href="https://doi.org/10.1007/pl00009293">10.1007/pl00009293</a></p>
</div>
<div id="ref-1EzYBe3sB">
<p>17. <strong>Network biology concepts in complex disease comorbidities</strong><br />
Jessica Xin Hu, Cecilia Engel Thomas, Søren Brunak<br />
<em>Nature Reviews Genetics</em> (2016-08-08) <a href="https://doi.org/f84t9c">https://doi.org/f84t9c</a><br />
DOI: <a href="https://doi.org/10.1038/nrg.2016.87">10.1038/nrg.2016.87</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27498692">27498692</a></p>
</div>
<div id="ref-RC8uLTIv">
<p>18. <strong>Using graph theory to analyze biological networks</strong><br />
Georgios A Pavlopoulos, Maria Secrier, Charalampos N Moschopoulos, Theodoros G Soldatos, Sophia Kossida, Jan Aerts, Reinhard Schneider, Pantelis G Bagos<br />
<em>BioData Mining</em> (2011-04-28) <a href="https://doi.org/bggzw9">https://doi.org/bggzw9</a><br />
DOI: <a href="https://doi.org/10.1186/1756-0381-4-10">10.1186/1756-0381-4-10</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/21527005">21527005</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3101653">PMC3101653</a></p>
</div>
<div id="ref-8tmqg1gt">
<p>19. <strong>Functional and transcriptional connectivity of communities in breast cancer co-expression networks</strong><br />
Guillermo de Anda-Jáuregui, Sergio Antonio Alcalá-Corona, Jesús Espinal-Enríquez, Enrique Hernández-Lemus<br />
<em>Applied Network Science</em> (2019-05-20) <a href="https://doi.org/ggt7sj">https://doi.org/ggt7sj</a><br />
DOI: <a href="https://doi.org/10.1007/s41109-019-0129-0">10.1007/s41109-019-0129-0</a></p>
</div>
<div id="ref-vD5y37ks">
<p>20. <strong>Loss of Connectivity in Cancer Co-Expression Networks</strong><br />
Roberto Anglani, Teresa M. Creanza, Vania C. Liuzzi, Ada Piepoli, Anna Panza, Angelo Andriulli, Nicola Ancona<br />
<em>PLoS ONE</em> (2014-01-28) <a href="https://doi.org/f5vhd4">https://doi.org/f5vhd4</a><br />
DOI: <a href="https://doi.org/10.1371/journal.pone.0087075">10.1371/journal.pone.0087075</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24489837">24489837</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3904972">PMC3904972</a></p>
</div>
<div id="ref-nGh5rU3O">
<p>21. <strong>A Mitochondrial Pyruvate Carrier Required for Pyruvate Uptake in Yeast, Drosophila, and Humans</strong><br />
Daniel K. Bricker, Eric B. Taylor, John C. Schell, Thomas Orsak, Audrey Boutron, Yu-Chan Chen, James E. Cox, Caleb M. Cardon, Jonathan G. Van Vranken, Noah Dephoure, … Jared Rutter<br />
<em>Science</em> (2012-05-24) <a href="https://doi.org/f33x88">https://doi.org/f33x88</a><br />
DOI: <a href="https://doi.org/10.1126/science.1218099">10.1126/science.1218099</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/22628558">22628558</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3690818">PMC3690818</a></p>
</div>
<div id="ref-4n6UHdJZ">
<p>22. <strong>Control of intestinal stem cell function and proliferation by mitochondrial pyruvate metabolism</strong><br />
John C. Schell, Dona R. Wisidagama, Claire Bensard, Helong Zhao, Peng Wei, Jason Tanner, Aimee Flores, Jeffrey Mohlman, Lise K. Sorensen, Christian S. Earl, … Jared Rutter<br />
<em>Nature Cell Biology</em> (2017-08-14) <a href="https://doi.org/gbrf73">https://doi.org/gbrf73</a><br />
DOI: <a href="https://doi.org/10.1038/ncb3593">10.1038/ncb3593</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/28812582">28812582</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6137334">PMC6137334</a></p>
</div>
<div id="ref-Lllg0qt7">
<p>23. <strong>Regulation of Tumor Initiation by the Mitochondrial Pyruvate Carrier</strong><br />
Claire L. Bensard, Dona R. Wisidagama, Kristofor A. Olson, Jordan A. Berg, Nathan M. Krah, John C. Schell, Sara M. Nowinski, Sarah Fogarty, Alex J. Bott, Peng Wei, … Jared Rutter<br />
<em>Cell Metabolism</em> (2020-02) <a href="https://doi.org/ggt7w8">https://doi.org/ggt7w8</a><br />
DOI: <a href="https://doi.org/10.1016/j.cmet.2019.11.002">10.1016/j.cmet.2019.11.002</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31813825">31813825</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7004878">PMC7004878</a></p>
</div>
<div id="ref-qjmYmIPe">
<p>24. <strong>Redundancy: A Critical Obstacle to Improving Cancer Therapy</strong><br />
O. Lavi<br />
<em>Cancer Research</em> (2015-01-09) <a href="https://doi.org/ggt7xd">https://doi.org/ggt7xd</a><br />
DOI: <a href="https://doi.org/10.1158/0008-5472.can-14-3256">10.1158/0008-5472.can-14-3256</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/25576083">25576083</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6250436">PMC6250436</a></p>
</div>
<div id="ref-Ot5bUkmI">
<p>25. <strong>The Connectivity Map: Using Gene-Expression Signatures to Connect Small Molecules, Genes, and Disease</strong><br />
J. Lamb<br />
<em>Science</em> (2006-09-29) <a href="https://doi.org/c92ptt">https://doi.org/c92ptt</a><br />
DOI: <a href="https://doi.org/10.1126/science.1132939">10.1126/science.1132939</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/17008526">17008526</a></p>
</div>
<div id="ref-9IFMjnOQ">
<p>26. <strong>Pathway crosstalk perturbation network modeling for identification of connectivity changes induced by diabetic neuropathy and pioglitazone</strong><br />
Guillermo de Anda-Jáuregui, Kai Guo, Brett A. McGregor, Eva L. Feldman, Junguk Hur<br />
<em>BMC Systems Biology</em> (2019-01-07) <a href="https://doi.org/ggt7zx">https://doi.org/ggt7zx</a><br />
DOI: <a href="https://doi.org/10.1186/s12918-018-0674-7">10.1186/s12918-018-0674-7</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/30616626">30616626</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6322225">PMC6322225</a></p>
</div>
<div id="ref-E3d6CBaQ">
<p>27. <strong>Impact of Mitochondrial Fatty Acid Synthesis on Mitochondrial Biogenesis</strong><br />
Sara M. Nowinski, Jonathan G. Van Vranken, Katja K. Dove, Jared Rutter<br />
<em>Current Biology</em> (2018-10) <a href="https://doi.org/gffn55">https://doi.org/gffn55</a><br />
DOI: <a href="https://doi.org/10.1016/j.cub.2018.08.022">10.1016/j.cub.2018.08.022</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/30352195">30352195</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6258005">PMC6258005</a></p>
</div>
<div id="ref-a2ZcMh2p">
<p>28. <strong>The mitochondrial acyl carrier protein (ACP) coordinates mitochondrial fatty acid synthesis with iron sulfur cluster biogenesis</strong><br />
Jonathan G Van Vranken, Mi-Young Jeong, Peng Wei, Yu-Chan Chen, Steven P Gygi, Dennis R Winge, Jared Rutter<br />
<em>eLife</em> (2016-08-19) <a href="https://doi.org/ggvrxg">https://doi.org/ggvrxg</a><br />
DOI: <a href="https://doi.org/10.7554/elife.17828">10.7554/elife.17828</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27540631">27540631</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4991935">PMC4991935</a></p>
</div>
<div id="ref-jMtpAwjn">
<p>29. <strong>MECR Mutations Cause Childhood-Onset Dystonia and Optic Atrophy, a Mitochondrial Fatty Acid Synthesis Disorder</strong><br />
Gali Heimer, Juha M. Kerätär, Lisa G. Riley, Shanti Balasubramaniam, Eran Eyal, Laura P. Pietikäinen, J. Kalervo Hiltunen, Dina Marek-Yagel, Jeffrey Hamada, Allison Gregory, … Qian Yi<br />
<em>The American Journal of Human Genetics</em> (2016-12) <a href="https://doi.org/f9gbs7">https://doi.org/f9gbs7</a><br />
DOI: <a href="https://doi.org/10.1016/j.ajhg.2016.09.021">10.1016/j.ajhg.2016.09.021</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27817865">27817865</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5142118">PMC5142118</a></p>
</div>
<div id="ref-Aq6MX1JZ">
<p>30. <strong>High Level Expression and Characterization of the Mitochondrial Citrate Transport Protein from the YeastSaccharomyces cerevisiae</strong><br />
Ronald S. Kaplan, June A. Mayor, David A. Gremse, David O. Wood<br />
<em>Journal of Biological Chemistry</em> (1995-02-24) <a href="https://doi.org/c9h8k3">https://doi.org/c9h8k3</a><br />
DOI: <a href="https://doi.org/10.1074/jbc.270.8.4108">10.1074/jbc.270.8.4108</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/7876161">7876161</a></p>
</div>
<div id="ref-fpIWldmV">
<p>31. <strong>The mitochondrial dicarboxylate carrier is essential for the growth of Saccharomyces cerevisiae on ethanol or acetate as the sole carbon source</strong><br />
Luigi Palmieri, Angelo Vozza, Angelika Honlinger, Klaus Dietmeier, Annamaria Palmisano, Vincenzo Zara, Ferdinando Palmieri<br />
<em>Molecular Microbiology</em> (1999-01) <a href="https://doi.org/d6fj3j">https://doi.org/d6fj3j</a><br />
DOI: <a href="https://doi.org/10.1046/j.1365-2958.1999.01197.x">10.1046/j.1365-2958.1999.01197.x</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/10027973">10027973</a></p>
</div>
<div id="ref-Q7Fg6qpA">
<p>32. <strong>Fumarate is an epigenetic modifier that elicits epithelial-to-mesenchymal transition</strong><br />
Marco Sciacovelli, Emanuel Gonçalves, Timothy Isaac Johnson, Vincent Roberto Zecchini, Ana Sofia Henriques da Costa, Edoardo Gaude, Alizee Vercauteren Drubbel, Sebastian Julian Theobald, Sandra Riekje Abbo, Maxine Gia Binh Tran, … Christian Frezza<br />
<em>Nature</em> (2016-08-31) <a href="https://doi.org/f84vs5">https://doi.org/f84vs5</a><br />
DOI: <a href="https://doi.org/10.1038/nature19353">10.1038/nature19353</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27580029">27580029</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5136292">PMC5136292</a></p>
</div>
<div id="ref-Z7HkOV8x">
<p>33. <strong>Metabolomic Markers of Altered Nucleotide Metabolism in Early Stage Adenocarcinoma</strong><br />
W. R. Wikoff, D. Grapov, J. F. Fahrmann, B. DeFelice, W. N. Rom, H. I. Pass, K. Kim, U. Nguyen, S. L. Taylor, D. R. Gandara, … S. Miyamoto<br />
<em>Cancer Prevention Research</em> (2015-02-05) <a href="https://doi.org/f69tn7">https://doi.org/f69tn7</a><br />
DOI: <a href="https://doi.org/10.1158/1940-6207.capr-14-0329">10.1158/1940-6207.capr-14-0329</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/25657018">25657018</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4618700">PMC4618700</a></p>
</div>
<div id="ref-Vm4WQy8V">
<p>34. <strong>Electron | Build cross-platform desktop apps with JavaScript, HTML, and CSS.</strong><a href="https://www.electronjs.org/">https://www.electronjs.org/</a></p>
</div>
<div id="ref-H1mR13bo">
<p>35. <strong>jQuery</strong><br />
JS Foundation- js.foundation<br />
<a href="https://jquery.com/">https://jquery.com/</a></p>
</div>
<div id="ref-dVWOf7kz">
<p>36. <strong>D3.js - Data-Driven Documents</strong><br />
Mike Bostock<br />
<a href="https://d3js.org/">https://d3js.org/</a></p>
</div>
<div id="ref-GZmT9x2e">
<p>37. <strong>adambisek/string-pixel-width</strong><br />
GitHub<br />
<a href="https://github.com/adambisek/string-pixel-width">https://github.com/adambisek/string-pixel-width</a></p>
</div>
<div id="ref-NW4mv3Ac">
<p>38. <strong>edeno/d3-save-svg</strong><br />
GitHub<br />
<a href="https://github.com/edeno/d3-save-svg">https://github.com/edeno/d3-save-svg</a></p>
</div>
<div id="ref-avT1fiCL">
<p>39. <strong>Welcome to Python.org</strong><br />
Python.org<br />
<a href="https://www.python.org/">https://www.python.org/</a></p>
</div>
<div id="ref-2z2qDwzz">
<p>40. <strong>pandas-dev/pandas: Pandas 1.0.3</strong><br />
Jeff Reback, Wes McKinney, Jbrockmendel, Joris Van Den Bossche, Tom Augspurger, Phillip Cloud, Gfyoung, Sinhrks, Adam Klein, Matthew Roeschke, … Mortada Mehyar<br />
<em>Zenodo</em> (2020-03-18) <a href="https://doi.org/ggt8bh">https://doi.org/ggt8bh</a><br />
DOI: <a href="https://doi.org/10.5281/zenodo.3509134">10.5281/zenodo.3509134</a></p>
</div>
<div id="ref-U5AcoDOX">
<p>41. <strong>Data Structures for Statistical Computing in Python</strong><br />
Wes McKinney<br />
<em>Proceedings of the 9th Python in Science Conference</em> (2010) <a href="https://doi.org/ggr6q3">https://doi.org/ggr6q3</a><br />
DOI: <a href="https://doi.org/10.25080/majora-92bf1922-00a">10.25080/majora-92bf1922-00a</a></p>
</div>
<div id="ref-DvNC6thO">
<p>42. (2007-01-16) <a href="https://web.mit.edu/dvp/Public/numpybook.pdf">https://web.mit.edu/dvp/Public/numpybook.pdf</a></p>
</div>
<div id="ref-8Miti2Gz">
<p>43. <strong>SciPy 1.0: fundamental algorithms for scientific computing in Python</strong><br />
Pauli VirtanenRalf Gommers, Travis E. Oliphant, Matt Haberland, Tyler Reddy, David Cournapeau, Evgeni Burovski, Pearu Peterson, Warren Weckesser, … Paul van Mulbregt<br />
<em>Nature Methods</em> (2020-02-03) <a href="https://doi.org/ggj45f">https://doi.org/ggj45f</a><br />
DOI: <a href="https://doi.org/10.1038/s41592-019-0686-2">10.1038/s41592-019-0686-2</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32015543">32015543</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7056644">PMC7056644</a></p>
</div>
<div id="ref-1026Gxdsi">
<p>44. <strong>Matplotlib: A 2D Graphics Environment</strong><br />
John D. Hunter<br />
<em>Computing in Science &amp; Engineering</em> (2007) <a href="https://doi.org/drbjhg">https://doi.org/drbjhg</a><br />
DOI: <a href="https://doi.org/10.1109/mcse.2007.55">10.1109/mcse.2007.55</a></p>
</div>
<div id="ref-ZrddLbmB">
<p>45. (2014-01-28) <a href="http://conference.scipy.org/proceedings/SciPy2008/paper_2/full_text.pdf">http://conference.scipy.org/proceedings/SciPy2008/paper_2/full_text.pdf</a></p>
</div>
<div id="ref-w09c7vaT">
<p>46. <strong>ACP Acylation Is an Acetyl-CoA-Dependent Modification Required for Electron Transport Chain Assembly</strong><br />
Jonathan G. Van Vranken, Sara M. Nowinski, Katie J. Clowers, Mi-Young Jeong, Yeyun Ouyang, Jordan A. Berg, Jeremy P. Gygi, Steven P. Gygi, Dennis R. Winge, Jared Rutter<br />
<em>Molecular Cell</em> (2018-08) <a href="https://doi.org/gd5dhm">https://doi.org/gd5dhm</a><br />
DOI: <a href="https://doi.org/10.1016/j.molcel.2018.06.039">10.1016/j.molcel.2018.06.039</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/30118679">30118679</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6104058">PMC6104058</a></p>
</div>
<div id="ref-e007dQqS">
<p>47. <strong>XPRESSyourself: Enhancing, standardizing, and automating ribosome profiling computational analyses yields improved insight into data</strong><br />
Jordan A. Berg, Jonathan R. Belyeu, Jeffrey T. Morgan, Yeyun Ouyang, Alex J. Bott, Aaron R. Quinlan, Jason Gertz, Jared Rutter<br />
<em>PLOS Computational Biology</em> (2020-01-31) <a href="https://doi.org/ggvg4j">https://doi.org/ggvg4j</a><br />
DOI: <a href="https://doi.org/10.1371/journal.pcbi.1007625">10.1371/journal.pcbi.1007625</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32004313">32004313</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7015430">PMC7015430</a></p>
</div>
<div id="ref-EcK8eBqS">
<p>48. <strong>Metaboverse/manuscript</strong><br />
GitHub<br />
<a href="https://github.com/Metaboverse/manuscript">https://github.com/Metaboverse/manuscript</a></p>
</div>
<div id="ref-w9AOzBMw">
<p>49. <strong>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</strong><br />
Michael I Love, Wolfgang Huber, Simon Anders<br />
<em>Genome Biology</em> (2014-12) <a href="https://doi.org/gd3zvn">https://doi.org/gd3zvn</a><br />
DOI: <a href="https://doi.org/10.1186/s13059-014-0550-8">10.1186/s13059-014-0550-8</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/25516281">25516281</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4302049">PMC4302049</a></p>
</div>
<div id="ref-yAeERgSN">
<p>50. <strong>PR000305</strong><br />
Metabolomics Workbench<br />
<em>Metabolomics Workbench</em> (2016) <a href="https://doi.org/ggxfdh">https://doi.org/ggxfdh</a><br />
DOI: <a href="https://doi.org/10.21228/m8pg66">10.21228/m8pg66</a></p>
</div>
<div id="ref-vMGMbT9f">
<p>51. <strong>Metaboverse/Metaboverse</strong><br />
GitHub<br />
<a href="https://github.com/Metaboverse/Metaboverse">https://github.com/Metaboverse/Metaboverse</a></p>
</div>
<div id="ref-kOjxC0II">
<p>52. <strong>Metaboverse/manuscript</strong><br />
GitHub<br />
<a href="https://github.com/Metaboverse/manuscript">https://github.com/Metaboverse/manuscript</a></p>
</div>
</div>
<!-- default theme -->

<style>
    /* import google fonts */
    @import url("https://fonts.googleapis.com/css?family=Open+Sans:400,600,700");
    @import url("https://fonts.googleapis.com/css?family=Source+Code+Pro");

    /* -------------------------------------------------- */
    /* global */
    /* -------------------------------------------------- */

    /* all elements */
    * {
        /* force sans-serif font unless specified otherwise */
        font-family: "Open Sans", "Helvetica", sans-serif;

        /* prevent text inflation on some mobile browsers */
        -webkit-text-size-adjust: none !important;
        -moz-text-size-adjust: none !important;
        -o-text-size-adjust: none !important;
        text-size-adjust: none !important;
    }

    @media only screen {
        /* "page" element */
        body {
            position: relative;
            box-sizing: border-box;
            font-size: 12pt;
            line-height: 1.5;
            max-width: 8.5in;
            margin: 20px auto;
            padding: 40px;
            border-radius: 5px;
            border: solid 1px #bdbdbd;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
            background: #ffffff;
        }
    }

    /* when on screen < 8.5in wide */
    @media only screen and (max-width: 8.5in) {
        /* "page" element */
        body {
            padding: 20px;
            margin: 0;
            border-radius: 0;
            border: none;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05) inset;
            background: none;
        }
    }

    /* -------------------------------------------------- */
    /* headings */
    /* -------------------------------------------------- */

    /* all headings */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 20px 0;
        padding: 0;
        font-weight: bold;
    }

    /* biggest heading */
    h1 {
        margin: 40px 0;
        text-align: center;
    }

    /* second biggest heading */
    h2 {
        margin-top: 30px;
        padding-bottom: 5px;
        border-bottom: solid 1px #bdbdbd;
    }

    /* -------------------------------------------------- */
    /* manuscript header */
    /* -------------------------------------------------- */

    /* manuscript title */
    header > h1 {
        margin: 0;
    }

    /* manuscript title caption text (ie "automatically generated on") */
    header + p {
        text-align: center;
        margin-top: 10px;
    }

    /* -------------------------------------------------- */
    /* text elements */
    /* -------------------------------------------------- */

    /* links */
    a {
        color: #2196f3;
        overflow-wrap: break-word;
    }

    /* normal links (not empty, not button link, not syntax highlighting link) */
    a:not(:empty):not(.button):not(.sourceLine) {
        padding-left: 1px;
        padding-right: 1px;
    }

    /* superscripts and subscripts */
    sub,
    sup {
        /* prevent from affecting line height */
        line-height: 0;
    }

    /* unordered and ordered lists*/
    ul,
    ol {
        padding-left: 20px;
    }

    /* class for styling text semibold */
    .semibold {
        font-weight: 600;
    }

    /* class for styling elements horizontally left aligned */
    .left {
        display: block;
        text-align: left;
        margin-left: auto;
        margin-right: 0;
        justify-content: left;
    }

    /* class for styling elements horizontally centered */
    .center {
        display: block;
        text-align: center;
        margin-left: auto;
        margin-right: auto;
        justify-content: center;
    }

    /* class for styling elements horizontally right aligned */
    .right {
        display: block;
        text-align: right;
        margin-left: 0;
        margin-right: auto;
        justify-content: right;
    }

    /* -------------------------------------------------- */
    /* section elements */
    /* -------------------------------------------------- */

    /* horizontal divider line */
    hr {
        border: none;
        height: 1px;
        background: #bdbdbd;
    }

    /* paragraphs, horizontal dividers, figures, tables, code */
    p,
    hr,
    figure,
    table,
    pre {
        /* treat all as "paragraphs", with consistent vertical margins */
        margin-top: 20px;
        margin-bottom: 20px;
    }

    /* -------------------------------------------------- */
    /* figures */
    /* -------------------------------------------------- */

    /* figure */
    figure {
        max-width: 100%;
        margin-left: auto;
        margin-right: auto;
    }

    /* figure caption */
    figcaption {
        padding: 0;
        padding-top: 10px;
    }

    /* figure image element */
    figure img {
        max-width: 100%;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }

    /* figure auto-number */
    img + figcaption > span:first-of-type {
        font-weight: bold;
        margin-right: 5px;
    }

    /* -------------------------------------------------- */
    /* tables */
    /* -------------------------------------------------- */

    /* table */
    table {
        border-collapse: collapse;
        border-spacing: 0;
        width: 100%;
        margin-left: auto;
        margin-right: auto;
    }

    /* table cells */
    th,
    td {
        border: solid 1px #bdbdbd;
        padding: 10px;
        /* squash table if too wide for page by forcing line breaks */
        overflow-wrap: break-word;
        word-break: break-word;
    }

    /* header row and even rows */
    th,
    tr:nth-child(2n) {
        background-color: #fafafa;
    }

    /* odd rows */
    tr:nth-child(2n + 1) {
        background-color: #ffffff;
    }

    /* table caption */
    caption {
        text-align: left;
        padding: 0;
        padding-bottom: 10px;
    }

    /* table auto-number */
    table > caption > span:first-of-type,
    div.table_wrapper > table > caption > span:first-of-type {
        font-weight: bold;
        margin-right: 5px;
    }

    /* -------------------------------------------------- */
    /* code */
    /* -------------------------------------------------- */

    /* multi-line code block */
    pre {
        padding: 10px;
        background-color: #eeeeee;
        color: #000000;
        border-radius: 5px;
        break-inside: avoid;
        text-align: left;
    }

    /* inline code, ie code within normal text */
    :not(pre) > code {
        padding: 0 4px;
        background-color: #eeeeee;
        color: #000000;
        border-radius: 5px;
    }

    /* code text */
    /* apply all children, to reach syntax highlighting sub-elements */
    code,
    code * {
        /* force monospace font */
        font-family: "Source Code Pro", "Courier New", monospace;
    }

    /* -------------------------------------------------- */
    /* quotes */
    /* -------------------------------------------------- */

    /* quoted text */
    blockquote {
        margin: 0;
        padding: 0;
        border-left: 4px solid #bdbdbd;
        padding-left: 16px;
        break-inside: avoid;
    }

    /* -------------------------------------------------- */
    /* banners */
    /* -------------------------------------------------- */

    /* info banners */
    .banner {
        box-sizing: border-box;
        display: block;
        position: relative;
        width: 100%;
        margin-top: 20px;
        margin-bottom: 20px;
        padding: 20px;
        text-align: center;
    }

    /* paragraph in banner */
    .banner > p {
        margin: 0;
    }

    /* -------------------------------------------------- */
    /* highlight colors */
    /* -------------------------------------------------- */

    .white {
        background: #ffffff;
    }
    .lightgrey {
        background: #eeeeee;
    }
    .grey {
        background: #757575;
    }
    .darkgrey {
        background: #424242;
    }
    .black {
        background: #000000;
    }
    .lightred {
        background: #ffcdd2;
    }
    .lightyellow {
        background: #ffecb3;
    }
    .lightgreen {
        background: #dcedc8;
    }
    .lightblue {
        background: #e3f2fd;
    }
    .lightpurple {
        background: #f3e5f5;
    }
    .red {
        background: #f44336;
    }
    .orange {
        background: #ff9800;
    }
    .yellow {
        background: #ffeb3b;
    }
    .green {
        background: #4caf50;
    }
    .blue {
        background: #2196f3;
    }
    .purple {
        background: #9c27b0;
    }
    .white,
    .lightgrey,
    .lightred,
    .lightyellow,
    .lightgreen,
    .lightblue,
    .lightpurple,
    .orange,
    .yellow,
    .white a,
    .lightgrey a,
    .lightred a,
    .lightyellow a,
    .lightgreen a,
    .lightblue a,
    .lightpurple a,
    .orange a,
    .yellow a {
        color: #000000;
    }
    .grey,
    .darkgrey,
    .black,
    .red,
    .green,
    .blue,
    .purple,
    .grey a,
    .darkgrey a,
    .black a,
    .red a,
    .green a,
    .blue a,
    .purple a {
        color: #ffffff;
    }

    /* -------------------------------------------------- */
    /* buttons */
    /* -------------------------------------------------- */

    /* class for styling links like buttons */
    .button {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        margin: 5px;
        padding: 10px 20px;
        font-size: 0.75em;
        font-weight: 600;
        text-transform: uppercase;
        text-decoration: none;
        letter-spacing: 1px;
        background: none;
        color: #2196f3;
        border: solid 1px #bdbdbd;
        border-radius: 5px;
    }

    /* buttons when hovered */
    .button:hover:not([disabled]),
    .icon_button:hover:not([disabled]) {
        cursor: pointer;
        background: #f5f5f5;
    }

    /* buttons when disabled */
    .button[disabled],
    .icon_button[disabled] {
        opacity: 0.35;
        pointer-events: none;
    }

    /* class for styling buttons containg only single icon */
    .icon_button {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        text-decoration: none;
        margin: 0;
        padding: 0;
        background: none;
        border-radius: 5px;
        border: none;
        width: 20px;
        height: 20px;
        min-width: 20px;
        min-height: 20px;
    }

    /* icon button inner svg image */
    .icon_button > svg {
        height: 16px;
    }

    /* -------------------------------------------------- */
    /* icons */
    /* -------------------------------------------------- */

    /* class for styling icons inline with text */
    .inline_icon {
        height: 1em;
        position: relative;
        top: 0.125em;
    }

    /* -------------------------------------------------- */
    /* print control */
    /* -------------------------------------------------- */

    @media print {
        @page {
            /* suggested printing margin */
            margin: 0.5in;
        }

        /* document and "page" elements */
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }

        /* "page" element */
        body {
            font-size: 11pt !important;
            line-height: 1.35;
        }

        /* all headings */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            margin: 15px 0;
        }

        /* heading 1 */
        h1 {
            font-size: 1.75em;
        }

        /* heading 2 */
        h2 {
            font-size: 1.25em;
            margin-top: 0;
        }

        /* heading 3 */
        h3 {
            font-size: 1.10em;
        }

        /* figures and tables */
        figure, table {
            font-size: 0.85em;
        }

        /* table cells */
        th,
        td {
            padding: 5px;
        }

        /* shrink font awesome icons */
        i.fas,
        i.fab,
        i.far,
        i.fal {
            transform: scale(0.85);
        }

        /* decrease banner margins */
        .banner {
            margin-top: 15px;
            margin-bottom: 15px;
            padding: 15px;
        }

        /* class for centering an element vertically on its own page */
        .page_center {
            margin: auto;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            vertical-align: middle;
            break-before: page;
            break-after: page;
        }

        /* always insert a page break before the element */
        .page_break_before {
            break-before: page;
        }

        /* always insert a page break after the element */
        .page_break_after {
            break-after: page;
        }

        /* avoid page break before the element */
        .page_break_before_avoid {
            break-before: avoid;
        }

        /* avoid page break after the element */
        .page_break_after_avoid {
            break-after: avoid;
        }

        /* avoid page break inside the element */
        .page_break_inside_avoid {
            break-inside: avoid;
        }
    }

    /* -------------------------------------------------- */
    /* override pandoc css quirks */
    /* -------------------------------------------------- */

    .sourceCode {
        /* prevent unsightly overflow in wide code blocks */
        overflow: auto !important;
    }

    div.sourceCode {
        /* prevent background fill on top-most code block  container */
        background: none !important;
    }

    .sourceCode * {
        /* force consistent line spacing */
        line-height: 1.5 !important;
    }

    div.sourceCode {
        /* style code block margins same as <pre> element */
        margin-top: 20px;
        margin-bottom: 20px;
    }

    /* -------------------------------------------------- */
    /* tablenos */
    /* -------------------------------------------------- */

    /* tablenos wrapper */
    .tablenos {
        /* show scrollbar on tables if necessary to prevent overflow */
        width: 100%;
        margin: 20px 0;
    }

    .tablenos > table {
        /* move margins from table to table_wrapper to allow margin collapsing */
        margin: 0;
    }

    @media only screen {
        /* tablenos wrapper */
        .tablenos {
            /* show scrollbar on tables if necessary to prevent overflow */
            overflow-x: auto !important;
        }

        .tablenos th,
        .tablenos td {
            overflow-wrap: unset !important;
            word-break: unset !important;
        }

        /* table in wrapper */
        .tablenos table,
        .tablenos table * {
            /* don't break table words */
            overflow-wrap: normal !important;
        }
    }

    /* -------------------------------------------------- */
    /* mathjax */
    /* -------------------------------------------------- */

    /* mathjax containers */
    .math.display > span:not(.MathJax_Preview) {
        /* turn inline element (no dimensions) into block (allows fixed width and thus scrolling) */
        display: flex !important;
        overflow-x: auto !important;
        overflow-y: hidden !important;
        justify-content: center;
        align-items: center;
        margin: 0 !important;
    }

    /* right click menu */
    .MathJax_Menu {
        border-radius: 5px !important;
        border: solid 1px #bdbdbd !important;
        box-shadow: none !important;
    }

    /* equation auto-number */
    span[id^="eq:"] > span.math.display + span {
        font-weight: 600;
    }

    /* equation */
    span[id^="eq:"] > span.math.display > span {
        /* nudge to make room for equation auto-number and anchor */
        margin-right: 60px !important;
    }

    /* -------------------------------------------------- */
    /* anchors plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* anchor button */
        .anchor {
            opacity: 0;
            margin-left: 5px;
        }

        /* anchor buttons within <h2>'s */
        h2 .anchor {
            margin-left: 10px;
        }

        /* anchor buttons when hovered/focused and anything containing an anchor button when hovered */
        *:hover > .anchor,
        .anchor:hover,
        .anchor:focus {
            opacity: 1;
        }

        /* anchor button when hovered */
        .anchor:hover {
            cursor: pointer;
        }
    }

    /* always show anchor button on devices with no mouse/hover ability */
    @media (hover: none) {
        .anchor {
            opacity: 1;
        }
    }

    /* always hide anchor button on print */
    @media only print {
        .anchor {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* accordion plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* accordion arrow button */
        .accordion_arrow {
            margin-right: 10px;
        }

        /* arrow icon when <h2> data-collapsed attribute true */
        h2[data-collapsed="true"] > .accordion_arrow > svg {
            transform: rotate(-90deg);
        }

        /* all elements (except <h2>'s) when data-collapsed attribute true */
        *:not(h2)[data-collapsed="true"] {
            display: none;
        }

        /* accordion arrow button when hovered and <h2>'s when hovered */
        .accordion_arrow:hover,
        h2[data-collapsed="true"]:hover,
        h2[data-collapsed="false"]:hover {
            cursor: pointer;
        }
    }

    /* always hide accordion arrow button on print */
    @media only print {
        .accordion_arrow {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* tooltips plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* tooltip container */
        #tooltip {
            position: absolute;
            width: 50%;
            min-width: 240px;
            max-width: 75%;
            z-index: 1;
        }

        /* tooltip content */
        #tooltip_content {
            margin-bottom: 5px;
            padding: 20px;
            border-radius: 5px;
            border: solid 1px #bdbdbd;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
            background: #ffffff;
            overflow-wrap: break-word;
        }

        /* tooltip copy of paragraphs and figures */
        #tooltip_content > p,
        #tooltip_content > figure {
            margin: 0;
            max-height: 320px;
            overflow-y: auto;
        }

        /* tooltip copy of <img> */
        #tooltip_content > figure > img {
            max-height: 260px;
        }

        /* navigation bar */
        #tooltip_nav_bar {
            margin-top: 10px;
            text-align: center;
        }

        /* navigation bar previous/next buton */
        #tooltip_nav_bar > .icon_button {
            position: relative;
            top: 3px;
        }

        /* navigation bar previous button */
        #tooltip_nav_bar > .icon_button:first-of-type {
            margin-right: 5px;
        }

        /* navigation bar next button */
        #tooltip_nav_bar > .icon_button:last-of-type {
            margin-left: 5px;
        }
    }

    /* always hide tooltip on print */
    @media only print {
        #tooltip {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* jump to first plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* jump button */
        .jump_arrow {
            position: relative;
            top: 0.125em;
            margin-right: 5px;
        }
    }

    /* always hide jump button on print */
    @media only print {
        .jump_arrow {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* link highlight plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* anything with data-highlighted attribute true */
        [data-highlighted="true"] {
            background: #ffeb3b;
        }

        /* anything with data-selected attribute true */
        [data-selected="true"] {
            background: #ff8a65 !important;
        }

        /* animation definition for glow */
        @keyframes highlight_glow {
            0% {
                background: none;
            }
            10% {
                background: #bbdefb;
            }
            100% {
                background: none;
            }
        }

        /* anything with data-glow attribute true */
        [data-glow="true"] {
            animation: highlight_glow 2s;
        }
    }

    /* -------------------------------------------------- */
    /* table of contents plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* toc panel */
        #toc_panel {
            box-sizing: border-box;
            position: fixed;
            top: 0;
            left: 0;
            background: #ffffff;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
            z-index: 2;
        }

        /* toc panel when closed */
        #toc_panel[data-open="false"] {
            min-width: 60px;
            width: 60px;
            height: 60px;
            border-right: solid 1px #bdbdbd;
            border-bottom: solid 1px #bdbdbd;
        }

        /* toc panel when open */
        #toc_panel[data-open="true"] {
            min-width: 260px;
            max-width: 480px;
            /* keep panel edge consistent distance away from "page" edge */
            width: calc(((100vw - 8.5in) / 2) - 30px - 40px);
            bottom: 0;
            border-right: solid 1px #bdbdbd;
        }

        /* toc panel header */
        #toc_header {
            box-sizing: border-box;
            display: flex;
            flex-direction: row;
            align-items: center;
            height: 60px;
            margin: 0;
            padding: 20px;
        }

        /* toc panel header when hovered */
        #toc_header:hover {
            cursor: pointer;
        }

        /* toc panel header when panel open */
        #toc_panel[data-open="true"] > #toc_header {
            border-bottom: solid 1px #bdbdbd;
        }

        /* toc open/close header button */
        #toc_button {
            margin-right: 20px;
        }

        /* hide toc list and header text when closed */
        #toc_panel[data-open="false"] > #toc_header > *:not(#toc_button),
        #toc_panel[data-open="false"] > #toc_list {
            display: none;
        }

        /* toc list of entries */
        #toc_list {
            box-sizing: border-box;
            width: 100%;
            padding: 20px;
            position: absolute;
            top: calc(60px + 1px);
            bottom: 0;
            overflow: auto;
        }

        /* toc entry, link to section in document */
        .toc_link {
            display: block;
            padding: 5px;
            position: relative;
            font-weight: 600;
            text-decoration: none;
        }

        /* toc entry when hovered or when "viewed" */
        .toc_link:hover,
        .toc_link[data-viewing="true"] {
            background: #f5f5f5;
        }

        /* toc entry, level 1 indentation */
        .toc_link[data-level="1"] {
            margin-left: 0;
        }

        /* toc entry, level 2 indentation */
        .toc_link[data-level="2"] {
            margin-left: 20px;
        }

        /* toc entry, level 3 indentation */
        .toc_link[data-level="3"] {
            margin-left: 40px;
        }

        /* toc entry, level 4 indentation */
        .toc_link[data-level="4"] {
            margin-left: 60px;
        }

        /* toc entry bullets */
        #toc_panel[data-bullets="true"] .toc_link[data-level]:before {
            position: absolute;
            left: -15px;
            top: -1px;
            font-size: 1.5em;
        }

        /* toc entry, level 2 bullet */
        #toc_panel[data-bullets="true"] .toc_link[data-level="2"]:before {
            content: "\2022";
        }

        /* toc entry, level 3 bullet */
        #toc_panel[data-bullets="true"] .toc_link[data-level="3"]:before {
            content: "\25AB";
        }

        /* toc entry, level 4 bullet */
        #toc_panel[data-bullets="true"] .toc_link[data-level="4"]:before {
            content: "-";
        }
    }

    /* when on screen < 8.5in wide */
    @media only screen and (max-width: 8.5in) {
        /* push <body> ("page") element down to make room for toc icon */
        .toc_body_nudge {
            padding-top: 60px;
        }

        /* toc icon when panel closed and not hovered */
        #toc_panel[data-open="false"]:not(:hover) {
            background: rgba(255, 255, 255, 0.75);
        }
    }

    /* always hide toc panel on print */
    @media only print {
        #toc_panel {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* lightbox plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* regular <img> in document when hovered */
        .lightbox_document_img:hover {
            cursor: pointer;
        }

        .body_no_scroll {
            overflow: hidden !important;
        }

        /* screen overlay */
        #lightbox_overlay {
            display: flex;
            flex-direction: column;
            position: fixed;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.75);
            z-index: 3;
        }

        /* middle area containing lightbox image */
        #lightbox_image_container {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
            padding: 20px;
        }

        /* bottom area containing caption */
        #lightbox_bottom_container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
            min-height: 100px;
            max-height: 100px;
            background: rgba(0, 0, 0, 0.5);
        }

        /* image number info text box */
        #lightbox_number_info {
            position: absolute;
            color: #ffffff;
            font-weight: 600;
            left: 2px;
            top: 0;
            z-index: 4;
        }

        /* zoom info text box */
        #lightbox_zoom_info {
            position: absolute;
            color: #ffffff;
            font-weight: 600;
            right: 2px;
            top: 0;
            z-index: 4;
        }

        /* copy of image caption */
        #lightbox_caption {
            box-sizing: border-box;
            display: inline-block;
            width: 100%;
            max-height: 100%;
            padding: 10px 0;
            text-align: center;
            overflow-y: auto;
            color: #ffffff;
        }

        /* navigation previous/next button */
        .lightbox_button {
            width: 100px;
            height: 100%;
            min-width: 100px;
            min-height: 100%;
            color: #ffffff;
        }

        /* navigation previous/next button when hovered */
        .lightbox_button:hover {
            background: none !important;
        }

        /* navigation button icon */
        .lightbox_button > svg {
            height: 25px;
        }

        /* figure auto-number */
        #lightbox_caption > span:first-of-type {
            font-weight: bold;
            margin-right: 5px;
        }

        /* lightbox image when hovered */
        #lightbox_img:hover {
            cursor: grab;
        }

        /* lightbox image when grabbed */
        #lightbox_img:active {
            cursor: grabbing;
        }
    }

    /* when on screen < 480px wide */
    @media only screen and (max-width: 480px) {
        /* make navigation buttons skinnier on small screens to make more room for caption text */
        .lightbox_button {
            width: 50px;
            min-width: 50px;
        }
    }

    /* always hide lightbox on print */
    @media only print {
        #lightbox_overlay {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* hypothesis (annotations) plugin */
    /* -------------------------------------------------- */

    /* side panel */
    .annotator-frame {
        width: 280px !important;
        z-index: 0 !important;
    }

    /* match highlight color to rest of theme */
    .annotator-highlights-always-on .annotator-hl {
        background-color: #ffeb3b !important;
    }

    /* match focused color to rest of theme */
    .annotator-hl.annotator-hl-focused {
        background-color: #ff8a65 !important;
    }

    /* match bucket bar color to rest of theme */
    .annotator-bucket-bar {
        background: #f5f5f5 !important;
    }

    /* always hide toolbar and tooltip on print */
    @media only print {
        .annotator-frame {
            display: none !important;
        }

        hypothesis-adder {
            display: none !important;
        }
    }
</style>
<!-- anchors plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin adds an anchor next to each of a certain type
        // of element that provides a human-readable url to that specific
        // item/position in the document (eg "manuscript.html#abstract"). It
        // also makes it such that scrolling out of view of a target removes
        // its identifier from the url.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'anchors';

        // default plugin options
        const options = {
            // which types of elements to add anchors next to, in
            // "document.querySelector" format
            typesQuery: 'h1, h2, h3, [id^="fig:"], [id^="tbl:"], [id^="eq:"]',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // add anchor to each element of specified types
            const elements = document.querySelectorAll(options.typesQuery);
            for (const element of elements)
                addAnchor(element);

            // attach scroll listener to window
            window.addEventListener('scroll', onScroll);
        }

        // when window is scrolled
        function onScroll() {
            // if url has hash and user has scrolled out of view of hash
            // target, remove hash from url
            const tolerance = 100;
            const target = getHashTarget();
            if (target) {
                if (
                    target.getBoundingClientRect().top >
                        window.innerHeight + tolerance ||
                    target.getBoundingClientRect().bottom < 0 - tolerance
                )
                    history.pushState(null, null, ' ');
            }
        }

        // add anchor to element
        function addAnchor(element) {
            let addTo; // element to add anchor button to

            // if figure or table, modify withId and addTo to get expected
            // elements
            if (element.id.indexOf('fig:') === 0) {
                addTo = element.querySelector('figcaption');
            } else if (element.id.indexOf('tbl:') === 0) {
                addTo = element.querySelector('caption');
            } else if (element.id.indexOf('eq:') === 0) {
                addTo = element.querySelector('.eqnos-number');
            }

            addTo = addTo || element;
            const id = element.id || null;

            // do not add anchor if element doesn't have assigned id.
            // id is generated by pandoc and is assumed to be unique and
            // human-readable
            if (!id)
                return;

            // create anchor button
            const anchor = document.createElement('a');
            anchor.innerHTML = document.querySelector('.icon_link').innerHTML;
            anchor.title = 'Link to this part of the document';
            anchor.classList.add('icon_button', 'anchor');
            anchor.dataset.ignore = 'true';
            anchor.href = '#' + id;
            addTo.appendChild(anchor);
        }

        // get element that is target of link or url hash
        function getHashTarget() {
            const hash = window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            // if figure or table, modify target to get expected element
            if (id.indexOf('fig:') === 0)
                target = target.querySelector('figure');
            if (id.indexOf('tbl:') === 0)
                target = target.querySelector('table');

            return target;
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- link icon -->

<template class="icon_link">
    <!-- modified from: https://fontawesome.com/icons/link -->
    <svg width="16" height="16" viewBox="0 0 512 512">
        <path
            fill="currentColor"
            d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"
        ></path>
    </svg>
</template>
<!-- accordion plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin allows sections of content under <h2> headings
        // to be collapsible.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'accordion';

        // default plugin options
        const options = {
            // whether to always start expanded ('false'), always start
            // collapsed ('true'), or start collapsed when screen small ('auto')
            startCollapsed: 'auto',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // run through each <h2> heading
            const headings = document.querySelectorAll('h2');
            for (const heading of headings) {
                addArrow(heading);

                // start expanded/collapsed based on option
                if (
                    options.startCollapsed === 'true' ||
                    (options.startCollapsed === 'auto' && isSmallScreen())
                )
                    collapseHeading(heading);
                else
                    expandHeading(heading);
            }

            // attach hash change listener to window
            window.addEventListener('hashchange', onHashChange);
        }

        // when hash (eg manuscript.html#introduction) changes
        function onHashChange() {
            const target = getHashTarget();
            if (target)
                goToElement(target);
        }

        // add arrow to heading
        function addArrow(heading) {
            // add arrow button
            const arrow = document.createElement('button');
            arrow.innerHTML = document.querySelector(
                '.icon_angle_down'
            ).innerHTML;
            arrow.classList.add('icon_button', 'accordion_arrow');
            heading.insertBefore(arrow, heading.firstChild);

            // attach click listener to heading and button
            heading.addEventListener('click', onHeadingClick);
            arrow.addEventListener('click', onArrowClick);
        }

        // determine if on mobile-like device with small screen
        function isSmallScreen() {
            return Math.min(window.innerWidth, window.innerHeight) < 480;
        }

        // scroll to and focus element
        function goToElement(element, offset) {
            // expand accordion section if collapsed
            expandElement(element);
            const y =
                getRectInView(element).top -
                getRectInView(document.documentElement).top -
                (offset || 0);
            // trigger any function listening for "onscroll" event
            window.dispatchEvent(new Event('scroll'));
            window.scrollTo(0, y);
            document.activeElement.blur();
            element.focus();
        }

        // get element that is target of hash
        function getHashTarget(link) {
            const hash = link ? link.hash : window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            // if figure or table, modify target to get expected element
            if (id.indexOf('fig:') === 0)
                target = target.querySelector('figure');
            if (id.indexOf('tbl:') === 0)
                target = target.querySelector('table');

            return target;
        }

        // when <h2> heading is clicked
        function onHeadingClick(event) {
            // only collapse if <h2> itself is target of click (eg, user did
            // not click on anchor within <h2>)
            if (event.target === this)
                toggleCollapse(this);
        }

        // when arrow button is clicked
        function onArrowClick() {
            toggleCollapse(this.parentNode);
        }

        // collapse section if expanded, expand if collapsed
        function toggleCollapse(heading) {
            if (heading.dataset.collapsed === 'false')
                collapseHeading(heading);
            else
                expandHeading(heading);
        }

        // elements to exclude from collapse, such as table of contents panel,
        // hypothesis panel, etc
        const exclude = '#toc_panel, div.annotator-frame, #lightbox_overlay';

        // collapse section
        function collapseHeading(heading) {
            heading.setAttribute('data-collapsed', 'true');
            const children = getChildren(heading);
            for (const child of children)
                child.setAttribute('data-collapsed', 'true');
        }

        // expand section
        function expandHeading(heading) {
            heading.setAttribute('data-collapsed', 'false');
            const children = getChildren(heading);
            for (const child of children)
                child.setAttribute('data-collapsed', 'false');
        }

        // get list of elements between this <h2> and next <h2> or <h1>
        // ("children" of the <h2> section)
        function getChildren(heading) {
            return nextUntil(heading, 'h2, h1', exclude);
        }

        // get position/dimensions of element or viewport
        function getRectInView(element) {
            let rect = {};
            rect.left = 0;
            rect.top = 0;
            rect.right = document.documentElement.clientWidth;
            rect.bottom = document.documentElement.clientHeight;
            let style = {};

            if (element instanceof HTMLElement) {
                rect = element.getBoundingClientRect();
                style = window.getComputedStyle(element);
            }

            const margin = {};
            margin.left = parseFloat(style.marginLeftWidth) || 0;
            margin.top = parseFloat(style.marginTopWidth) || 0;
            margin.right = parseFloat(style.marginRightWidth) || 0;
            margin.bottom = parseFloat(style.marginBottomWidth) || 0;

            const border = {};
            border.left = parseFloat(style.borderLeftWidth) || 0;
            border.top = parseFloat(style.borderTopWidth) || 0;
            border.right = parseFloat(style.borderRightWidth) || 0;
            border.bottom = parseFloat(style.borderBottomWidth) || 0;

            const newRect = {};
            newRect.left = rect.left + margin.left + border.left;
            newRect.top = rect.top + margin.top + border.top;
            newRect.right = rect.right + margin.right + border.right;
            newRect.bottom = rect.bottom + margin.bottom + border.bottom;
            newRect.width = newRect.right - newRect.left;
            newRect.height = newRect.bottom - newRect.top;

            return newRect;
        }

        // get list of elements after a start element up to element matching
        // query
        function nextUntil(element, query, exclude) {
            const elements = [];
            while (element = element.nextElementSibling, element) {
                if (element.matches(query))
                    break;
                if (!element.matches(exclude))
                    elements.push(element);
            }
            return elements;
        }

        // get closest element before specified element that matches query
        function firstBefore(element, query) {
            while (
                element &&
                element !== document.body &&
                !element.matches(query)
            )
                element = element.previousElementSibling || element.parentNode;

            return element;
        }

        // check if element is part of collapsed heading
        function isCollapsed(element) {
            while (element && element !== document.body) {
                if (element.dataset.collapsed === 'true')
                    return true;
                element = element.parentNode;
            }
            return false;
        }

        // expand heading containing element if necesary
        function expandElement(element) {
            if (isCollapsed(element)) {
                const heading = firstBefore(element, 'h2');
                if (heading)
                    heading.click();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- angle down icon -->

<template class="icon_angle_down">
    <!-- modified from: https://fontawesome.com/icons/angle-down -->
    <svg width="16" height="16" viewBox="0 0 448 512">
        <path
            fill="currentColor"
            d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"
        ></path>
    </svg>
</template>
<!-- tooltips plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin makes it such that when the user hovers or
        // focuses a link to a citation or figure, a tooltip appears with a
        // preview of the reference content, along with arrows to navigate
        // between instances of the same reference in the document.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'tooltips';

        // default plugin options
        const options = {
            // whether user must click off to close tooltip instead of just
            // un-hovering
            clickClose: 'false',
            // delay (in ms) between opening and closing tooltip
            delay: '100',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            const links = getLinks();
            for (const link of links) {
                // attach hover and focus listeners to link
                link.addEventListener('mouseover', onLinkHover);
                link.addEventListener('mouseleave', onLinkUnhover);
                link.addEventListener('focus', onLinkFocus);
                link.addEventListener('touchend', onLinkTouch);
            }

            // attach mouse, key, and resize listeners to window
            window.addEventListener('mousedown', onClick);
            window.addEventListener('touchstart', onClick);
            window.addEventListener('keyup', onKeyUp);
            window.addEventListener('resize', onResize);
        }

        // when link is hovered
        function onLinkHover() {
            // function to open tooltip
            const delayOpenTooltip = function() {
                openTooltip(this);
            }.bind(this);

            // run open function after delay
            this.openTooltipTimer = window.setTimeout(
                delayOpenTooltip,
                options.delay
            );
        }

        // when mouse leaves link
        function onLinkUnhover() {
            // cancel opening tooltip
            window.clearTimeout(this.openTooltipTimer);

            // don't close on unhover if option specifies
            if (options.clickClose === 'true')
                return;

            // function to close tooltip
            const delayCloseTooltip = function() {
                // if tooltip open and if mouse isn't over tooltip, close
                const tooltip = document.getElementById('tooltip');
                if (tooltip && !tooltip.matches(':hover'))
                    closeTooltip();
            };

            // run close function after delay
            this.closeTooltipTimer = window.setTimeout(
                delayCloseTooltip,
                options.delay
            );
        }

        // when link is focused (tabbed to)
        function onLinkFocus(event) {
            openTooltip(this);
        }

        // when link is touched on touch screen
        function onLinkTouch(event) {
            // attempt to force hover state on first tap always, and trigger
            // regular link click (and navigation) on second tap
            if (event.target === document.activeElement)
                event.target.click();
            else {
                document.activeElement.blur();
                event.target.focus();
            }
            if (event.cancelable)
                event.preventDefault();
            event.stopPropagation();
            return false;
        }

        // when mouse is clicked anywhere in window
        function onClick(event) {
            closeTooltip();
        }

        // when key pressed
        function onKeyUp(event) {
            if (!event || !event.key)
                return;

            switch (event.key) {
                // trigger click of prev button
                case 'ArrowLeft':
                    const prevButton = document.getElementById(
                        'tooltip_prev_button'
                    );
                    if (prevButton)
                        prevButton.click();
                    break;
                // trigger click of next button
                case 'ArrowRight':
                    const nextButton = document.getElementById(
                        'tooltip_next_button'
                    );
                    if (nextButton)
                        nextButton.click();
                    break;
                // close on esc
                case 'Escape':
                    closeTooltip();
                    break;
            }
        }

        // when window is resized or zoomed
        function onResize() {
            closeTooltip();
        }

        // get all links of types we wish to handle
        function getLinks() {
            const queries = [];
            // exclude buttons, anchor links, toc links, etc
            const exclude =
                ':not(.button):not(.icon_button):not(.anchor):not(.toc_link)';
            queries.push('a[href^="#ref-"]' + exclude); // citation links
            queries.push('a[href^="#fig:"]' + exclude); // figure links
            const query = queries.join(', ');
            return document.querySelectorAll(query);
        }

        // get links with same target, get index of link in set, get total
        // same links
        function getSameLinks(link) {
            const sameLinks = [];
            const links = getLinks();
            for (const otherLink of links) {
                if (
                    otherLink.getAttribute('href') === link.getAttribute('href')
                )
                    sameLinks.push(otherLink);
            }

            return {
                elements: sameLinks,
                index: sameLinks.indexOf(link),
                total: sameLinks.length
            };
        }

        // open tooltip
        function openTooltip(link) {
            // delete tooltip if it exists, start fresh
            closeTooltip();

            // make tooltip element
            const tooltip = makeTooltip(link);

            // if source couldn't be found and tooltip not made, exit
            if (!tooltip)
                return;

            // make navbar elements
            const navBar = makeNavBar(link);
            if (navBar)
                tooltip.firstElementChild.appendChild(navBar);

            // attach tooltip to page
            document.body.appendChild(tooltip);

            // position tooltip
            const position = function() {
                positionTooltip(link);
            };
            position();

            // if tooltip contains images, position again after they've loaded
            const imgs = tooltip.querySelectorAll('img');
            for (const img of imgs)
                img.addEventListener('load', position);
        }

        // close (delete) tooltip
        function closeTooltip() {
            const tooltip = document.getElementById('tooltip');
            if (tooltip)
                tooltip.remove();
        }

        // make tooltip
        function makeTooltip(link) {
            // get target element that link points to
            const source = getSource(link);

            // if source can't be found, exit
            if (!source)
                return;

            // create new tooltip
            const tooltip = document.createElement('div');
            tooltip.id = 'tooltip';
            const tooltipContent = document.createElement('div');
            tooltipContent.id = 'tooltip_content';
            tooltip.appendChild(tooltipContent);

            // make copy of source node and put in tooltip
            const sourceCopy = makeCopy(source);
            tooltipContent.appendChild(sourceCopy);

            // attach mouse event listeners
            tooltip.addEventListener('click', onTooltipClick);
            tooltip.addEventListener('mousedown', onTooltipClick);
            tooltip.addEventListener('touchstart', onTooltipClick);
            tooltip.addEventListener('mouseleave', onTooltipUnhover);

            // (for interaction with lightbox plugin)
            // transfer click on tooltip copied img to original img
            const sourceImg = source.querySelector('img');
            const sourceCopyImg = sourceCopy.querySelector('img');
            if (sourceImg && sourceCopyImg) {
                const clickImg = function() {
                    sourceImg.click();
                    closeTooltip();
                };
                sourceCopyImg.addEventListener('click', clickImg);
            }

            return tooltip;
        }

        // make carbon copy of html dom element
        function makeCopy(source) {
            const sourceCopy = source.cloneNode(true);

            // delete elements marked with ignore (eg anchor and jump buttons)
            const deleteFromCopy = sourceCopy.querySelectorAll(
                '[data-ignore="true"]'
            );
            for (const element of deleteFromCopy)
                element.remove();

            // delete certain element attributes
            const attributes = [
                'id',
                'data-collapsed',
                'data-selected',
                'data-highlighted',
                'data-glow'
            ];
            for (const attribute of attributes) {
                sourceCopy.removeAttribute(attribute);
                const elements = sourceCopy.querySelectorAll(
                    '[' + attribute + ']'
                );
                for (const element of elements)
                    element.removeAttribute(attribute);
            }

            return sourceCopy;
        }

        // when tooltip is clicked
        function onTooltipClick(event) {
            // when user clicks on tooltip, stop click from transferring
            // outside of tooltip (eg, click off to close tooltip, or eg click
            // off to unhighlight same refs)
            event.stopPropagation();
        }

        // when tooltip is unhovered
        function onTooltipUnhover(event) {
            if (options.clickClose === 'true')
                return;

            // make sure new mouse/touch/focus no longer over tooltip or any
            // element within it
            const tooltip = document.getElementById('tooltip');
            if (!tooltip)
                return;
            if (this.contains(event.relatedTarget))
                return;

            closeTooltip();
        }

        // make nav bar to go betwen prev/next instances of same reference
        function makeNavBar(link) {
            // find other links to the same source
            const sameLinks = getSameLinks(link);

            // don't show nav bar when singular reference
            if (sameLinks.total <= 1)
                return;

            // find prev/next links with same target
            const prevLink = getPrevLink(link, sameLinks);
            const nextLink = getNextLink(link, sameLinks);

            // create nav bar
            const navBar = document.createElement('div');
            navBar.id = 'tooltip_nav_bar';
            const text = sameLinks.index + 1 + ' of ' + sameLinks.total;

            // create nav bar prev/next buttons
            const prevButton = document.createElement('button');
            const nextButton = document.createElement('button');
            prevButton.id = 'tooltip_prev_button';
            nextButton.id = 'tooltip_next_button';
            prevButton.title =
                'Jump to the previous occurence of this item in the document [←]';
            nextButton.title =
                'Jump to the next occurence of this item in the document [→]';
            prevButton.classList.add('icon_button');
            nextButton.classList.add('icon_button');
            prevButton.innerHTML = document.querySelector(
                '.icon_caret_left'
            ).innerHTML;
            nextButton.innerHTML = document.querySelector(
                '.icon_caret_right'
            ).innerHTML;
            navBar.appendChild(prevButton);
            navBar.appendChild(document.createTextNode(text));
            navBar.appendChild(nextButton);

            // attach click listeners to buttons
            prevButton.addEventListener('click', function() {
                onPrevNextClick(link, prevLink);
            });
            nextButton.addEventListener('click', function() {
                onPrevNextClick(link, nextLink);
            });

            return navBar;
        }

        // get previous link with same target
        function getPrevLink(link, sameLinks) {
            if (!sameLinks)
                sameLinks = getSameLinks(link);
            // wrap index to other side if < 1
            let index;
            if (sameLinks.index - 1 >= 0)
                index = sameLinks.index - 1;
            else
                index = sameLinks.total - 1;
            return sameLinks.elements[index];
        }

        // get next link with same target
        function getNextLink(link, sameLinks) {
            if (!sameLinks)
                sameLinks = getSameLinks(link);
            // wrap index to other side if > total
            let index;
            if (sameLinks.index + 1 <= sameLinks.total - 1)
                index = sameLinks.index + 1;
            else
                index = 0;
            return sameLinks.elements[index];
        }

        // get element that is target of link or url hash
        function getSource(link) {
            const hash = link ? link.hash : window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            // if ref or figure, modify target to get expected element
            if (id.indexOf('ref-') === 0)
                target = target.querySelector('p');
            else if (id.indexOf('fig:') === 0)
                target = target.querySelector('figure');

            return target;
        }

        // when prev/next arrow button is clicked
        function onPrevNextClick(link, prevNextLink) {
            if (link && prevNextLink)
                goToElement(prevNextLink, window.innerHeight * 0.5);
        }

        // scroll to and focus element
        function goToElement(element, offset) {
            // expand accordion section if collapsed
            expandElement(element);
            const y =
                getRectInView(element).top -
                getRectInView(document.documentElement).top -
                (offset || 0);
            // trigger any function listening for "onscroll" event
            window.dispatchEvent(new Event('scroll'));
            window.scrollTo(0, y);
            document.activeElement.blur();
            element.focus();
        }

        // determine position to place tooltip based on link position in
        // viewport and tooltip size
        function positionTooltip(link, left, top) {
            const tooltipElement = document.getElementById('tooltip');
            if (!tooltipElement)
                return;

            // get convenient vars for position/dimensions of
            // link/tooltip/page/view
            link = getRectInPage(link);
            const tooltip = getRectInPage(tooltipElement);
            const view = getRectInPage();

            // horizontal positioning
            if (left)
                // use explicit value
                left = left;
            else if (link.left + tooltip.width < view.right)
                // fit tooltip to right of link
                left = link.left;
            else if (link.right - tooltip.width > view.left)
                // fit tooltip to left of link
                left = link.right - tooltip.width;
            // center tooltip in view
            else
                left = (view.right - view.left) / 2 - tooltip.width / 2;

            // vertical positioning
            if (top)
                // use explicit value
                top = top;
            else if (link.top - tooltip.height > view.top)
                // fit tooltip above link
                top = link.top - tooltip.height;
            else if (link.bottom + tooltip.height < view.bottom)
                // fit tooltip below link
                top = link.bottom;
            else {
                // center tooltip in view
                top = view.top + view.height / 2 - tooltip.height / 2;
                // nudge off of link to left/right if possible
                if (link.right + tooltip.width < view.right)
                    left = link.right;
                else if (link.left - tooltip.width > view.left)
                    left = link.left - tooltip.width;
            }

            tooltipElement.style.left = left + 'px';
            tooltipElement.style.top = top + 'px';
        }

        // get position/dimensions of element or viewport
        function getRectInView(element) {
            let rect = {};
            rect.left = 0;
            rect.top = 0;
            rect.right = document.documentElement.clientWidth;
            rect.bottom = document.documentElement.clientHeight;
            let style = {};

            if (element instanceof HTMLElement) {
                rect = element.getBoundingClientRect();
                style = window.getComputedStyle(element);
            }

            const margin = {};
            margin.left = parseFloat(style.marginLeftWidth) || 0;
            margin.top = parseFloat(style.marginTopWidth) || 0;
            margin.right = parseFloat(style.marginRightWidth) || 0;
            margin.bottom = parseFloat(style.marginBottomWidth) || 0;

            const border = {};
            border.left = parseFloat(style.borderLeftWidth) || 0;
            border.top = parseFloat(style.borderTopWidth) || 0;
            border.right = parseFloat(style.borderRightWidth) || 0;
            border.bottom = parseFloat(style.borderBottomWidth) || 0;

            const newRect = {};
            newRect.left = rect.left + margin.left + border.left;
            newRect.top = rect.top + margin.top + border.top;
            newRect.right = rect.right + margin.right + border.right;
            newRect.bottom = rect.bottom + margin.bottom + border.bottom;
            newRect.width = newRect.right - newRect.left;
            newRect.height = newRect.bottom - newRect.top;

            return newRect;
        }

        // get position of element relative to page
        function getRectInPage(element) {
            const rect = getRectInView(element);
            const body = getRectInView(document.body);

            const newRect = {};
            newRect.left = rect.left - body.left;
            newRect.top = rect.top - body.top;
            newRect.right = rect.right - body.left;
            newRect.bottom = rect.bottom - body.top;
            newRect.width = rect.width;
            newRect.height = rect.height;

            return newRect;
        }

        // (for interaction with accordion plugin)
        // get closest element before specified element that matches query
        function firstBefore(element, query) {
            while (
                element &&
                element !== document.body &&
                !element.matches(query)
            )
                element = element.previousElementSibling || element.parentNode;

            return element;
        }

        // (for interaction with accordion plugin)
        // check if element is part of collapsed heading
        function isCollapsed(element) {
            while (element && element !== document.body) {
                if (element.dataset.collapsed === 'true')
                    return true;
                element = element.parentNode;
            }
            return false;
        }

        // (for interaction with accordion plugin)
        // expand heading containing element if necesary
        function expandElement(element) {
            if (isCollapsed(element)) {
                const heading = firstBefore(element, 'h2');
                if (heading)
                    heading.click();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
    <!-- modified from: https://fontawesome.com/icons/caret-left -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
        ></path>
    </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
    <!-- modified from: https://fontawesome.com/icons/caret-right -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
        ></path>
    </svg>
</template>
<!-- jump to first plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin adds a button next to each reference entry,
        // figure, and table that jumps the page to the first occurrence of a
        // link to that item in the manuscript.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'jumpToFirst';

        // default plugin options
        const options = {
            // whether to add buttons next to reference entries
            references: 'true',
            // whether to add buttons next to figures
            figures: 'true',
            // whether to add buttons next to tables
            tables: 'true',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            if (options.references !== 'false')
                makeReferenceButtons();
            if (options.figures !== 'false')
                makeFigureButtons();
            if (options.tables !== 'false')
                makeTableButtons();
        }

        // when jump button clicked
        function onButtonClick() {
            const first = getFirstOccurrence(this.dataset.id);
            if (!first)
                return;

            // update url hash so navigating "back" in history will return
            // user to jump button
            window.location.hash = this.dataset.id;
            // scroll to link
            window.setTimeout(function() {
                goToElement(first, window.innerHeight * 0.5);
            }, 0);
        }

        // get first occurence of link to item in document
        function getFirstOccurrence(id) {
            let query = 'a';
            query += '[href="#' + id + '"]';
            // exclude buttons, anchor links, toc links, etc
            query +=
                ':not(.button):not(.icon_button):not(.anchor):not(.toc_link)';
            return document.querySelector(query);
        }

        // add button next to each reference entry
        function makeReferenceButtons() {
            const references = document.querySelectorAll('div[id^="ref-"]');
            for (const reference of references) {
                // get reference id and element to add button to
                const id = reference.id;
                const container = reference.firstElementChild;
                const first = getFirstOccurrence(id);

                // if can't find link to reference, ignore
                if (!first)
                    continue;

                // make jump button
                let button = document.createElement('button');
                button.classList.add('icon_button', 'jump_arrow');
                button.title =
                    'Jump to the first occurence of this reference in the document';
                button.innerHTML = document.querySelector(
                    '.icon_angle_double_up'
                ).innerHTML;
                button.dataset.id = id;
                button.dataset.ignore = 'true';
                container.innerHTML = button.outerHTML + container.innerHTML;
                button = container.firstElementChild;
                button.addEventListener('click', onButtonClick);
            }
        }

        // add button next to each figure
        function makeFigureButtons() {
            const figures = document.querySelectorAll('[id^="fig:"]');
            for (const figure of figures) {
                // get figure id and element to add button to
                const id = figure.id;
                const container = figure.querySelector('figcaption') || figure;
                const first = getFirstOccurrence(id);

                // if can't find link to figure, ignore
                if (!first)
                    continue;

                // make jump button
                const button = document.createElement('button');
                button.classList.add('icon_button', 'jump_arrow');
                button.title =
                    'Jump to the first occurence of this figure in the document';
                button.innerHTML = document.querySelector(
                    '.icon_angle_double_up'
                ).innerHTML;
                button.dataset.id = id;
                button.dataset.ignore = 'true';
                container.insertBefore(button, container.firstElementChild);
                button.addEventListener('click', onButtonClick);
            }
        }

        // add button next to each figure
        function makeTableButtons() {
            const tables = document.querySelectorAll('[id^="tbl:"]');
            for (const table of tables) {
                // get ref id and element to add button to
                const id = table.id;
                const container = table.querySelector('caption') || table;
                const first = getFirstOccurrence(id);

                // if can't find link to table, ignore
                if (!first)
                    continue;

                // make jump button
                const button = document.createElement('button');
                button.classList.add('icon_button', 'jump_arrow');
                button.title =
                    'Jump to the first occurence of this table in the document';
                button.innerHTML = document.querySelector(
                    '.icon_angle_double_up'
                ).innerHTML;
                button.dataset.id = id;
                button.dataset.ignore = 'true';
                container.insertBefore(button, container.firstElementChild);
                button.addEventListener('click', onButtonClick);
            }
        }

        // scroll to and focus element
        function goToElement(element, offset) {
            // expand accordion section if collapsed
            expandElement(element);
            const y =
                getRectInView(element).top -
                getRectInView(document.documentElement).top -
                (offset || 0);
            // trigger any function listening for "onscroll" event
            window.dispatchEvent(new Event('scroll'));
            window.scrollTo(0, y);
            document.activeElement.blur();
            element.focus();
        }

        // get position/dimensions of element or viewport
        function getRectInView(element) {
            let rect = {};
            rect.left = 0;
            rect.top = 0;
            rect.right = document.documentElement.clientWidth;
            rect.bottom = document.documentElement.clientHeight;
            let style = {};

            if (element instanceof HTMLElement) {
                rect = element.getBoundingClientRect();
                style = window.getComputedStyle(element);
            }

            const margin = {};
            margin.left = parseFloat(style.marginLeftWidth) || 0;
            margin.top = parseFloat(style.marginTopWidth) || 0;
            margin.right = parseFloat(style.marginRightWidth) || 0;
            margin.bottom = parseFloat(style.marginBottomWidth) || 0;

            const border = {};
            border.left = parseFloat(style.borderLeftWidth) || 0;
            border.top = parseFloat(style.borderTopWidth) || 0;
            border.right = parseFloat(style.borderRightWidth) || 0;
            border.bottom = parseFloat(style.borderBottomWidth) || 0;

            const newRect = {};
            newRect.left = rect.left + margin.left + border.left;
            newRect.top = rect.top + margin.top + border.top;
            newRect.right = rect.right + margin.right + border.right;
            newRect.bottom = rect.bottom + margin.bottom + border.bottom;
            newRect.width = newRect.right - newRect.left;
            newRect.height = newRect.bottom - newRect.top;

            return newRect;
        }

        // get closest element before specified element that matches query
        function firstBefore(element, query) {
            while (
                element &&
                element !== document.body &&
                !element.matches(query)
            )
                element = element.previousElementSibling || element.parentNode;

            return element;
        }

        // check if element is part of collapsed heading
        function isCollapsed(element) {
            while (element && element !== document.body) {
                if (element.dataset.collapsed === 'true')
                    return true;
                element = element.parentNode;
            }
            return false;
        }

        // (for interaction with accordion plugin)
        // expand heading containing element if necesary
        function expandElement(element) {
            if (isCollapsed(element)) {
                const heading = firstBefore(element, 'h2');
                if (heading)
                    heading.click();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- angle double up icon -->

<template class="icon_angle_double_up">
    <!-- modified from: https://fontawesome.com/icons/angle-double-up -->
    <svg width="16" height="16" viewBox="0 0 320 512">
        <path
            fill="currentColor"
            d="M177 255.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 351.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 425.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1zm-34-192L7 199.7c-9.4 9.4-9.4 24.6 0 33.9l22.6 22.6c9.4 9.4 24.6 9.4 33.9 0l96.4-96.4 96.4 96.4c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9l-136-136c-9.2-9.4-24.4-9.4-33.8 0z"
        ></path>
    </svg>
</template>
<!-- link highlight plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin makes it such that when a user hovers or
        // focuses a link, other links that have the same target will be
        // highlighted. It also makes it such that when clicking a link, the
        // target of the link (eg reference, figure, table) is briefly
        // highlighted.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'linkHighlight';

        // default plugin options
        const options = {
            // whether to also highlight links that go to external urls
            externalLinks: 'false',
            // whether user must click off to unhighlight instead of just
            // un-hovering
            clickUnhighlight: 'false',
            // whether to also highlight links that are unique
            highlightUnique: 'true',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            const links = getLinks();
            for (const link of links) {
                // attach mouse and focus listeners to link
                link.addEventListener('mouseenter', onLinkFocus);
                link.addEventListener('focus', onLinkFocus);
                link.addEventListener('mouseleave', onLinkUnhover);
            }

            // attach click and hash change listeners to window
            window.addEventListener('click', onClick);
            window.addEventListener('touchstart', onClick);
            window.addEventListener('hashchange', onHashChange);

            // run hash change on window load in case user has navigated
            // directly to hash
            onHashChange();
        }

        // when link is focused (tabbed to) or hovered
        function onLinkFocus() {
            highlight(this);
        }

        // when link is unhovered
        function onLinkUnhover() {
            if (options.clickUnhighlight !== 'true')
                unhighlightAll();
        }

        // when the mouse is clicked anywhere in window
        function onClick(event) {
            unhighlightAll();
        }

        // when hash (eg manuscript.html#introduction) changes
        function onHashChange() {
            const target = getHashTarget();
            if (target)
                glowElement(target);
        }

        // get element that is target of link or url hash
        function getHashTarget(link) {
            const hash = link ? link.hash : window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            return target;
        }

        // start glow sequence on an element
        function glowElement(element) {
            const startGlow = function() {
                onGlowEnd();
                element.dataset.glow = 'true';
                element.addEventListener('animationend', onGlowEnd);
            };
            const onGlowEnd = function() {
                element.removeAttribute('data-glow');
                element.removeEventListener('animationend', onGlowEnd);
            };
            startGlow();
        }

        // highlight link and all others with same target
        function highlight(link) {
            // force unhighlight all to start fresh
            unhighlightAll();

            // get links with same target
            if (!link)
                return;
            const sameLinks = getSameLinks(link);

            // if link unique and option is off, exit and don't highlight
            if (sameLinks.length <= 1 && options.highlightUnique !== 'true')
                return;

            // highlight all same links, and "select" (special highlight) this
            // one
            for (const sameLink of sameLinks) {
                if (sameLink === link)
                    sameLink.setAttribute('data-selected', 'true');
                else
                    sameLink.setAttribute('data-highlighted', 'true');
            }
        }

        // unhighlight all links
        function unhighlightAll() {
            const links = getLinks();
            for (const link of links) {
                link.setAttribute('data-selected', 'false');
                link.setAttribute('data-highlighted', 'false');
            }
        }

        // get links with same target
        function getSameLinks(link) {
            const results = [];
            const links = getLinks();
            for (const otherLink of links) {
                if (
                    otherLink.getAttribute('href') === link.getAttribute('href')
                )
                    results.push(otherLink);
            }
            return results;
        }

        // get all links of types we wish to handle
        function getLinks() {
            let query = 'a';
            if (options.externalLinks !== 'true')
                query += '[href^="#"]';
            // exclude buttons, anchor links, toc links, etc
            query +=
                ':not(.button):not(.icon_button):not(.anchor):not(.toc_link)';
            return document.querySelectorAll(query);
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>
<!-- table of contents plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin provides a "table of contents" (toc) panel on
        // the side of the document that allows the user to conveniently
        // navigate between sections of the document.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'tableOfContents';

        // default plugin options
        const options = {
            // which types of elements to add links for, in
            // "document.querySelector" format
            typesQuery: 'h1, h2, h3',
            // whether default behavior is to be closed ('false'), open
            // ('true'), or only open when screen wide enough to fit panel
            // ('auto'). note: still always starts closed when page loads.
            open: 'auto',
            // if list item is more than this many characters, text will be
            // truncated
            charLimit: '50',
            // whether or not to show bullets next to each toc item
            bullets: 'false',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // make toc panel and populate with entries (links to document
            // sections)
            const panel = makePanel();
            if (!panel)
                return;
            makeEntries(panel);
            document.body.insertBefore(panel, document.body.firstChild);

            closePanel();

            // attach click, scroll, and hash change listeners to window
            window.addEventListener('click', onClick);
            window.addEventListener('touchstart', onClick);
            window.addEventListener('scroll', onScroll);
            window.addEventListener('hashchange', onScroll);
            window.addEventListener('keyup', onKeyUp);
            onScroll();

            // add class to push document body down out of way of toc button
            document.body.classList.add('toc_body_nudge');
        }

        // determine if screen wide enough to fit toc panel
        function isSmallScreen() {
            // in default theme:
            // 816px = 8.5in = width of "page" (<body>) element
            // 260px = min width of toc panel (*2 for both sides of <body>)
            return window.innerWidth < 816 + 260 * 2;
        }

        // open/close panel based on option and screen size
        function openOrClosePanel() {
            if (
                options.open === 'true' ||
                (options.open === 'auto' && !isSmallScreen())
            )
                openPanel();
            else
                closePanel();
        }

        // when mouse is clicked anywhere in window
        function onClick() {
            const panel = document.getElementById('toc_panel');
            if (!panel)
                return;

            if (panel.dataset.open === 'true')
                openOrClosePanel();
        }

        // when window is scrolled or hash changed
        function onScroll() {
            highlightViewed();
        }

        // when key pressed
        function onKeyUp(event) {
            if (!event || !event.key)
                return;

            // close on esc
            if (event.key === 'Escape')
                closePanel();
        }

        // find entry of currently viewed document section in toc and highlight
        function highlightViewed() {
            const firstId = getFirstInView(options.typesQuery);

            // get toc entries (links), unhighlight all, then highlight viewed
            const list = document.getElementById('toc_list');
            if (!firstId || !list)
                return;
            const links = list.querySelectorAll('a');
            for (const link of links)
                link.dataset.viewing = 'false';
            const link = list.querySelector('a[href="#' + firstId + '"]');
            if (!link)
                return;
            link.dataset.viewing = 'true';
        }

        // get first or previous toc listed element in top half of view
        function getFirstInView(query) {
            // get all elements matching query and with id
            const elements = document.querySelectorAll(query);
            const elementsWithIds = [];
            for (const element of elements) {
                if (element.id)
                    elementsWithIds.push(element);
            }


            // get first or previous element in top half of view
            for (let i = 0; i < elementsWithIds.length; i++) {
                const element = elementsWithIds[i];
                const prevElement = elementsWithIds[Math.max(0, i - 1)];
                if (element.getBoundingClientRect().top >= 0) {
                    if (
                        element.getBoundingClientRect().top <
                        window.innerHeight / 2
                    )
                        return element.id;
                    else
                        return prevElement.id;
                }
            }
        }

        // make panel
        function makePanel() {
            // create panel
            const panel = document.createElement('div');
            panel.id = 'toc_panel';
            if (options.bullets === 'true')
                panel.dataset.bullets = 'true';

            // create header
            const header = document.createElement('div');
            header.id = 'toc_header';

            // create toc button
            const button = document.createElement('button');
            button.id = 'toc_button';
            button.innerHTML = document.querySelector(
                '.icon_th_list'
            ).innerHTML;
            button.classList.add('icon_button');

            // create header text
            const text = document.createElement('h3');
            text.innerHTML = 'Table of Contents';

            // create container for toc list
            const list = document.createElement('div');
            list.id = 'toc_list';

            // attach click listeners
            panel.addEventListener('click', onPanelClick);
            header.addEventListener('click', onHeaderClick);
            button.addEventListener('click', onButtonClick);

            // attach elements
            header.appendChild(button);
            header.appendChild(text);
            panel.appendChild(header);
            panel.appendChild(list);

            return panel;
        }

        // create toc entries (links) to each element of the specified types
        function makeEntries(panel) {
            const elements = document.querySelectorAll(options.typesQuery);
            for (const element of elements) {
                // do not add link if element doesn't have assigned id
                if (!element.id)
                    continue;

                // create link/list item
                const link = document.createElement('a');
                link.classList.add('toc_link');
                switch (element.tagName.toLowerCase()) {
                    case 'h1':
                        link.dataset.level = '1';
                        break;
                    case 'h2':
                        link.dataset.level = '2';
                        break;
                    case 'h3':
                        link.dataset.level = '3';
                        break;
                    case 'h4':
                        link.dataset.level = '4';
                        break;
                }
                link.title = element.innerText;
                let text = element.innerText;
                if (text.length > options.charLimit)
                    text = text.slice(0, options.charLimit) + '...';
                link.innerHTML = text;
                link.href = '#' + element.id;
                link.addEventListener('click', onLinkClick);

                // attach link
                panel.querySelector('#toc_list').appendChild(link);
            }
        }

        // when panel is clicked
        function onPanelClick(event) {
            // stop click from propagating to window/document and closing panel
            event.stopPropagation();
        }

        // when header itself is clicked
        function onHeaderClick(event) {
            togglePanel();
        }

        // when button is clicked
        function onButtonClick(event) {
            togglePanel();
            // stop header underneath button from also being clicked
            event.stopPropagation();
        }

        // when link is clicked
        function onLinkClick() {
            openOrClosePanel();
        }

        // open panel if closed, close if opened
        function togglePanel() {
            const panel = document.getElementById('toc_panel');
            if (!panel)
                return;

            if (panel.dataset.open === 'true')
                closePanel();
            else
                openPanel();
        }

        // open panel
        function openPanel() {
            const panel = document.getElementById('toc_panel');
            if (panel)
                panel.dataset.open = 'true';
        }

        // close panel
        function closePanel() {
            const panel = document.getElementById('toc_panel');
            if (panel)
                panel.dataset.open = 'false';
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- th list icon -->

<template class="icon_th_list">
    <!-- modified from: https://fontawesome.com/icons/th-list -->
    <svg width="16" height="16" viewBox="0 0 512 512" tabindex="-1">
        <path
            fill="currentColor"
            d="M96 96c0 26.51-21.49 48-48 48S0 122.51 0 96s21.49-48 48-48 48 21.49 48 48zM48 208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm0 160c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm96-236h352c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"
            tabindex="-1"
        ></path>
    </svg>
</template>
<!-- lightbox plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin makes it such that when a user clicks on an
        // image, the image fills the screen and the user can pan/drag/zoom
        // the image and navigate between other images in the document.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'lightbox';

        // default plugin options
        const options = {
            // list of possible zoom/scale factors
            zoomSteps:
                '0.1, 0.25, 0.333333, 0.5, 0.666666, 0.75, 1,' +
                '1.25, 1.5, 1.75, 2, 2.5, 3, 3.5, 4, 5, 6, 7, 8',
            // whether to fit image to view ('fit'), display at 100% and shrink
            // if necessary ('shrink'), or always display at 100% ('100')
            defaultZoom: 'fit',
            // whether to zoom in/out toward center of view ('true') or mouse
            // ('false')
            centerZoom: 'false',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // run through each <img> element
            const imgs = document.querySelectorAll('figure > img');
            let count = 1;
            for (const img of imgs) {
                img.classList.add('lightbox_document_img');
                img.dataset.number = count;
                img.dataset.total = imgs.length;
                img.addEventListener('click', openLightbox);
                count++;
            }

            // attach mouse and key listeners to window
            window.addEventListener('mousemove', onWindowMouseMove);
            window.addEventListener('keyup', onKeyUp);
        }

        // when mouse is moved anywhere in window
        function onWindowMouseMove(event) {
            window.mouseX = event.clientX;
            window.mouseY = event.clientY;
        }

        // when key pressed
        function onKeyUp(event) {
            if (!event || !event.key)
                return;

            switch (event.key) {
                // trigger click of prev button
                case 'ArrowLeft':
                    const prevButton = document.getElementById(
                        'lightbox_prev_button'
                    );
                    if (prevButton)
                        prevButton.click();
                    break;
                // trigger click of next button
                case 'ArrowRight':
                    const nextButton = document.getElementById(
                        'lightbox_next_button'
                    );
                    if (nextButton)
                        nextButton.click();
                    break;
                // close on esc
                case 'Escape':
                    closeLightbox();
                    break;
            }
        }

        // open lightbox
        function openLightbox() {
            const lightbox = makeLightbox(this);
            if (!lightbox)
                return;

            blurBody(lightbox);
            document.body.appendChild(lightbox);
        }

        // make lightbox
        function makeLightbox(img) {
            // delete lightbox if it exists, start fresh
            closeLightbox();

            // create screen overlay containing lightbox
            const overlay = document.createElement('div');
            overlay.id = 'lightbox_overlay';

            // create image info boxes
            const numberInfo = document.createElement('div');
            const zoomInfo = document.createElement('div');
            numberInfo.id = 'lightbox_number_info';
            zoomInfo.id = 'lightbox_zoom_info';

            // create container for image
            const imageContainer = document.createElement('div');
            imageContainer.id = 'lightbox_image_container';
            const lightboxImg = makeLightboxImg(
                img,
                imageContainer,
                numberInfo,
                zoomInfo
            );
            imageContainer.appendChild(lightboxImg);

            // create bottom container for caption and navigation buttons
            const bottomContainer = document.createElement('div');
            bottomContainer.id = 'lightbox_bottom_container';
            const caption = makeCaption(img);
            const prevButton = makePrevButton(img);
            const nextButton = makeNextButton(img);
            bottomContainer.appendChild(prevButton);
            bottomContainer.appendChild(caption);
            bottomContainer.appendChild(nextButton);

            // attach top middle and bottom to overlay
            overlay.appendChild(numberInfo);
            overlay.appendChild(zoomInfo);
            overlay.appendChild(imageContainer);
            overlay.appendChild(bottomContainer);

            return overlay;
        }

        // make <img> object that is intuitively draggable and zoomable
        function makeLightboxImg(
            sourceImg,
            container,
            numberInfoBox,
            zoomInfoBox
        ) {
            // create copy of source <img>
            const img = sourceImg.cloneNode(true);
            img.classList.remove('lightbox_document_img');
            img.removeAttribute('id');
            img.removeAttribute('width');
            img.removeAttribute('height');
            img.style.position = 'unset';
            img.style.margin = '0';
            img.style.padding = '0';
            img.style.width = '';
            img.style.height = '';
            img.style.minWidth = '';
            img.style.minHeight = '';
            img.style.maxWidth = '';
            img.style.maxHeight = '';
            img.id = 'lightbox_img';

            // build sorted list of unique zoomSteps, always including a 100%
            let zoomSteps = [];
            const optionsZooms = options.zoomSteps.split(/[^0-9.]/);
            for (const optionZoom of optionsZooms) {
                const newZoom = parseFloat(optionZoom);
                if (newZoom && !zoomSteps.includes(newZoom))
                    zoomSteps.push(newZoom);
            }
            if (!zoomSteps.includes(1))
                zoomSteps.push(1);
            zoomSteps = zoomSteps.sort(function sortNumber(a, b) {
                return a - b;
            });

            // <img> object property variables
            let zoom = 1;
            let translateX = 0;
            let translateY = 0;
            let clickMouseX = undefined;
            let clickMouseY = undefined;
            let clickTranslateX = undefined;
            let clickTranslateY = undefined;

            updateNumberInfo();

            // update image numbers displayed in info box
            function updateNumberInfo() {
                numberInfoBox.innerHTML =
                    sourceImg.dataset.number + ' of ' + sourceImg.dataset.total;
            }

            // update zoom displayed in info box
            function updateZoomInfo() {
                let zoomInfo = zoom * 100;
                if (!Number.isInteger(zoomInfo))
                    zoomInfo = zoomInfo.toFixed(2);
                zoomInfoBox.innerHTML = zoomInfo + '%';
            }

            // move to closest zoom step above current zoom
            const zoomIn = function() {
                for (const zoomStep of zoomSteps) {
                    if (zoomStep > zoom) {
                        zoom = zoomStep;
                        break;
                    }
                }
                updateTransform();
            };

            // move to closest zoom step above current zoom
            const zoomOut = function() {
                zoomSteps.reverse();
                for (const zoomStep of zoomSteps) {
                    if (zoomStep < zoom) {
                        zoom = zoomStep;
                        break;
                    }
                }
                zoomSteps.reverse();

                updateTransform();
            };

            // update display of <img> based on scale/translate properties
            const updateTransform = function() {
                // set transform
                img.style.transform =
                    'translate(' +
                    (translateX || 0) +
                    'px,' +
                    (translateY || 0) +
                    'px) scale(' +
                    (zoom || 1) +
                    ')';

                // get new width/height after scale
                const rect = img.getBoundingClientRect();
                // limit translate
                translateX = Math.max(translateX, -rect.width / 2);
                translateX = Math.min(translateX, rect.width / 2);
                translateY = Math.max(translateY, -rect.height / 2);
                translateY = Math.min(translateY, rect.height / 2);

                // set transform
                img.style.transform =
                    'translate(' +
                    (translateX || 0) +
                    'px,' +
                    (translateY || 0) +
                    'px) scale(' +
                    (zoom || 1) +
                    ')';

                updateZoomInfo();
            };

            // fit <img> to container
            const fit = function() {
                // no x/y offset, 100% zoom by default
                translateX = 0;
                translateY = 0;
                zoom = 1;

                // widths of <img> and container
                const imgWidth = img.naturalWidth;
                const imgHeight = img.naturalHeight;
                const containerWidth = parseFloat(
                    window.getComputedStyle(container).width
                );
                const containerHeight = parseFloat(
                    window.getComputedStyle(container).height
                );

                // how much zooming is needed to fit <img> to container
                const xRatio = imgWidth / containerWidth;
                const yRatio = imgHeight / containerHeight;
                const maxRatio = Math.max(xRatio, yRatio);
                const newZoom = 1 / maxRatio;

                // fit <img> to container according to option
                if (options.defaultZoom === 'shrink') {
                    if (maxRatio > 1)
                        zoom = newZoom;
                } else if (options.defaultZoom === 'fit')
                    zoom = newZoom;

                updateTransform();
            };

            // when mouse wheel is rolled anywhere in container
            const onContainerWheel = function(event) {
                if (!event)
                    return;

                // let ctrl + mouse wheel to zoom behave as normal
                if (event.ctrlKey)
                    return;

                // prevent normal scroll behavior
                event.preventDefault();
                event.stopPropagation();

                // point around which to scale img
                const viewRect = container.getBoundingClientRect();
                const viewX = (viewRect.left + viewRect.right) / 2;
                const viewY = (viewRect.top + viewRect.bottom) / 2;
                const originX = options.centerZoom === 'true' ? viewX : mouseX;
                const originY = options.centerZoom === 'true' ? viewY : mouseY;

                // get point on image under origin
                const oldRect = img.getBoundingClientRect();
                const oldPercentX = (originX - oldRect.left) / oldRect.width;
                const oldPercentY = (originY - oldRect.top) / oldRect.height;

                // increment/decrement zoom
                if (event.deltaY < 0)
                    zoomIn();
                if (event.deltaY > 0)
                    zoomOut();

                // get offset between previous image point and origin
                const newRect = img.getBoundingClientRect();
                const offsetX =
                    originX - (newRect.left + newRect.width * oldPercentX);
                const offsetY =
                    originY - (newRect.top + newRect.height * oldPercentY);

                // translate image to keep image point under origin
                translateX += offsetX;
                translateY += offsetY;

                // perform translate
                updateTransform();
            };

            // when container is clicked
            function onContainerClick(event) {
                // if container itself is target of click, and not other
                // element above it
                if (event.target === this)
                    closeLightbox();
            }

            // when mouse button is pressed on image
            const onImageMouseDown = function(event) {
                // store original mouse position relative to image
                clickMouseX = window.mouseX;
                clickMouseY = window.mouseY;
                clickTranslateX = translateX;
                clickTranslateY = translateY;
                event.stopPropagation();
                event.preventDefault();
            };

            // when mouse button is released anywhere in window
            const onWindowMouseUp = function(event) {
                // reset original mouse position
                clickMouseX = undefined;
                clickMouseY = undefined;
                clickTranslateX = undefined;
                clickTranslateY = undefined;

                // remove global listener if lightbox removed from document
                if (!document.body.contains(container))
                    window.removeEventListener('mouseup', onWindowMouseUp);
            };

            // when mouse is moved anywhere in window
            const onWindowMouseMove = function(event) {
                if (
                    clickMouseX === undefined ||
                    clickMouseY === undefined ||
                    clickTranslateX === undefined ||
                    clickTranslateY === undefined
                )
                    return;

                // offset image based on original and current mouse position
                translateX = clickTranslateX + window.mouseX - clickMouseX;
                translateY = clickTranslateY + window.mouseY - clickMouseY;
                updateTransform();
                event.preventDefault();

                // remove global listener if lightbox removed from document
                if (!document.body.contains(container))
                    window.removeEventListener('mousemove', onWindowMouseMove);
            };

            // when window is resized
            const onWindowResize = function(event) {
                fit();

                // remove global listener if lightbox removed from document
                if (!document.body.contains(container))
                    window.removeEventListener('resize', onWindowResize);
            };

            // attach the necessary event listeners
            img.addEventListener('dblclick', fit);
            img.addEventListener('mousedown', onImageMouseDown);
            container.addEventListener('wheel', onContainerWheel);
            container.addEventListener('mousedown', onContainerClick);
            container.addEventListener('touchstart', onContainerClick);
            window.addEventListener('mouseup', onWindowMouseUp);
            window.addEventListener('mousemove', onWindowMouseMove);
            window.addEventListener('resize', onWindowResize);

            // run fit() after lightbox atttached to document and <img> Loaded
            // so needed container and img dimensions available
            img.addEventListener('load', fit);

            return img;
        }

        // make caption
        function makeCaption(img) {
            const caption = document.createElement('div');
            caption.id = 'lightbox_caption';
            const captionSource = img.nextElementSibling;
            if (captionSource.tagName.toLowerCase() === 'figcaption') {
                const captionCopy = makeCopy(captionSource);
                caption.innerHTML = captionCopy.innerHTML;
            }

            caption.addEventListener('touchstart', function(event) {
                event.stopPropagation();
            });

            return caption;
        }

        // make carbon copy of html dom element
        function makeCopy(source) {
            const sourceCopy = source.cloneNode(true);

            // delete elements marked with ignore (eg anchor and jump buttons)
            const deleteFromCopy = sourceCopy.querySelectorAll(
                '[data-ignore="true"]'
            );
            for (const element of deleteFromCopy)
                element.remove();

            // delete certain element attributes
            const attributes = [
                'id',
                'data-collapsed',
                'data-selected',
                'data-highlighted',
                'data-glow'
            ];
            for (const attribute of attributes) {
                sourceCopy.removeAttribute(attribute);
                const elements = sourceCopy.querySelectorAll(
                    '[' + attribute + ']'
                );
                for (const element of elements)
                    element.removeAttribute(attribute);
            }

            return sourceCopy;
        }

        // make button to jump to previous image in document
        function makePrevButton(img) {
            const prevButton = document.createElement('button');
            prevButton.id = 'lightbox_prev_button';
            prevButton.title = 'Jump to the previous image in the document [←]';
            prevButton.classList.add('icon_button', 'lightbox_button');
            prevButton.innerHTML = document.querySelector(
                '.icon_caret_left'
            ).innerHTML;

            // attach click listeners to button
            prevButton.addEventListener('click', function() {
                getPrevImg(img).click();
            });

            return prevButton;
        }

        // make button to jump to next image in document
        function makeNextButton(img) {
            const nextButton = document.createElement('button');
            nextButton.id = 'lightbox_next_button';
            nextButton.title = 'Jump to the next image in the document [→]';
            nextButton.classList.add('icon_button', 'lightbox_button');
            nextButton.innerHTML = document.querySelector(
                '.icon_caret_right'
            ).innerHTML;

            // attach click listeners to button
            nextButton.addEventListener('click', function() {
                getNextImg(img).click();
            });

            return nextButton;
        }

        // get previous image in document
        function getPrevImg(img) {
            const imgs = document.querySelectorAll('.lightbox_document_img');

            // find index of provided img
            let index;
            for (index = 0; index < imgs.length; index++) {
                if (imgs[index] === img)
                    break;
            }


            // wrap index to other side if < 1
            if (index - 1 >= 0)
                index--;
            else
                index = imgs.length - 1;
            return imgs[index];
        }

        // get next image in document
        function getNextImg(img) {
            const imgs = document.querySelectorAll('.lightbox_document_img');

            // find index of provided img
            let index;
            for (index = 0; index < imgs.length; index++) {
                if (imgs[index] === img)
                    break;
            }


            // wrap index to other side if > total
            if (index + 1 <= imgs.length - 1)
                index++;
            else
                index = 0;
            return imgs[index];
        }

        // close lightbox
        function closeLightbox() {
            focusBody();

            const lightbox = document.getElementById('lightbox_overlay');
            if (lightbox)
                lightbox.remove();
        }

        // make all elements behind lightbox non-focusable
        function blurBody(overlay) {
            const all = document.querySelectorAll('*');
            for (const element of all)
                element.tabIndex = -1;
            document.body.classList.add('body_no_scroll');
        }

        // make all elements focusable again
        function focusBody() {
            const all = document.querySelectorAll('*');
            for (const element of all)
                element.removeAttribute('tabIndex');
            document.body.classList.remove('body_no_scroll');
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
    <!-- modified from: https://fontawesome.com/icons/caret-left -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
        ></path>
    </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
    <!-- modified from: https://fontawesome.com/icons/caret-right -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
        ></path>
    </svg>
</template>
<!-- attributes plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin allows arbitrary HTML attributes to be attached
        // to (almost) any element. Place an HTML comment inside or next to the
        // desired element in the format <!-- $attribute="value" -->

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'attributes';

        // default plugin options
        const options = {
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // get list of comments in document
            const comments = findComments();

            for(const comment of comments)
                if (comment.parentElement)
                    addAttributes(
                        comment.parentElement,
                        comment.nodeValue.trim()
                    );
        }

        // add html attributes to specified element based on string of 
        // html attributes and values
        function addAttributes(element, text) {
            // regex's for finding attribute/value pairs in the format of
            // attribute="value" or attribute='value
            const regex2 = /\$([a-zA-Z\-]+)?=\"(.+?)\"/;
            const regex1 = /\$([a-zA-Z\-]+)?=\'(.+?)\'/;

            // loop through attribute/value pairs
            let match;
            while(match = text.match(regex2) || text.match(regex1)) {
                // get attribute and value from regex capture groups
                let attribute = match[1];
                let value = match[2];

                // remove from string
                text = text.substring(match.index + match[0].length);

                if (!attribute || !value)
                    break;

                // set attribute of parent element
                try {
                    element.setAttribute(attribute, value);
                } catch(error) {
                    console.log(error);
                }

                // special case for colspan
                if (attribute === 'colspan')
                    removeTableCells(element, value);
            }
        }

        // get list of comment elements in document
        function findComments() {
            const comments = [];

            // iterate over comment nodes in document
            function acceptNode(node) {
                return NodeFilter.FILTER_ACCEPT;
            }
            const iterator = document.createNodeIterator(
                document.body,
                NodeFilter.SHOW_COMMENT,
                acceptNode
            );
            let node;
            while(node = iterator.nextNode())
                comments.push(node);

            return comments;
        }

        // remove certain number of cells after specified cell
        function removeTableCells(cell, number) {
            number = parseInt(number);
            if (!number)
                return;

            // remove elements
            for(; number > 1; number--) {
                if (cell.nextElementSibling)
                    cell.nextElementSibling.remove();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>
<!-- math plugin configuration -->

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        "CommonHTML": { linebreaks: { automatic: true } },
        "HTML-CSS": { linebreaks: { automatic: true } },
        "SVG": { linebreaks: { automatic: true } },
        "fast-preview": { disabled: true }
    });
</script>

<!-- math plugin -->

<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML'>
    // /////////////////////////
    // DESCRIPTION
    // /////////////////////////

    // This third-party plugin 'MathJax' allows the proper rendering of
    // math/equations written in LaTeX.

    // https://www.mathjax.org/
</script>
<!-- annotations plugin configuration -->

<script>
    window.hypothesisConfig = function() {
        return {
            branding: {
                accentColor: '#2196f3',
                appBackgroundColor: '#f8f8f8',
                ctaBackgroundColor: '#f8f8f8',
                ctaTextColor: '#000000',
                selectionFontFamily: 'Open Sans, Helvetica, sans serif',
                annotationFontFamily: 'Open Sans, Helvetica, sans serif'
            }
        };
    };
</script>

<!-- annotations plugin -->

<script src='https://hypothes.is/embed.js'>
    // /////////////////////////
    // DESCRIPTION
    // /////////////////////////

    // This third-party plugin 'Hypothesis' allows public annotation of the
    // manuscript.

    // https://web.hypothes.is/
</script>
<!-- analytics plugin -->

<!-- copy and paste code from Google Analytics or similar service here -->
</body>
</html>
