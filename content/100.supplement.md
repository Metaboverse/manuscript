## Supplementary Material {.page_break_before}

### A brief overview of representative metabolic network analysis tools
We will highlight four such representative and popular tools for their respective properties, though many more exist [@doi:10.1530/JME-18-0055]. First is MetaboAnalyst, which relies heavily on set enrichment methods for the analysis of data, or examining the belongingness of sets of significantly changed analytes (i.e., metabolite, protein, or gene measurements), for extracting interesting information. Network visualization is available, but it focuses primarily on interaction networks, and its ability to extract regulatory information is limited, particularly in an automated fashion [@doi:10.1093/nar/gkp356; @doi:10.1093/nar/gky310]. Second is Cytoscape, which serves as a general go-to platform for representing biological or other networks. One strength of Cytoscape is the ability to design apps or plug-ins to conduct customized analyses; however, comprehensive and metabolism-specific regulatory identification methods are unavailable [@doi:10.1101/gr.1239303]. One plug-in for Cytoscape that focuses on metabolic data is MetScape, but again, this tool is generally limited to pathway enrichment, correlation networks, and data visualization and does not integrate approaches to identify regulatory mechanisms within the data [@doi:10.1093/bioinformatics/btx012; @doi:10.1093/bioinformatics/btr661; @doi:10.1093/bioinformatics/btq048]. MetExplore focuses on the curation of networks and is particularly useful for collaborative annotation of emerging models of organisms with incomplete metabolic network curations. It additionally can layer experimental data on the network for visualization [@doi:10.1093/nar/gky301; @doi:10.1093/nar/gkq312]. A companion tool to MetExplore is MetExploreViz, which enables interactive and flexible visualization of omics data on metabolic networks [@doi:10.1093/bioinformatics/btx588]. Reactome, which our tool uses for the curation of biological networks, also offers analytical tools for user data, but again relies on set enrichment or manual methods for identifying patterns. While all have their respective utility, there is a pressing need for tools that integrate these features and automate pattern and trend detection across metabolic networks to extract regulatory and other features from data [@doi:10.1093/nar/gki072; @pmid:31691815; @pmid:29145629].

### Examples of reaction patterns in Metaboverse
The following figure provides examples of reaction patterns that Metaboverse will search for in the network based on the user's data (Supplementary Figure  @fig:supp_fig_pattern_examples).

![
  **Reaction pattern examples.**
  (1a-b) Examples where the measured values on both sides of a reaction are averaged. The difference between the two averages is then compared and, if greater than the specified threshold, identified as a reaction pattern. Where the metabolite product is unmeasured (a white node), that entity is ignored during averaging and comparing the two sides of the reaction. (2a-b) Examples where the minimum measured substrate value and the maximum measured product, or vice versa, are compared and identified as a reaction pattern if the difference passes the specified threshold. (3a-b) Examples where the minimum measured substrate and product values are compared and identified as a reaction pattern if the difference passes the given threshold. Alternatively, an option exists to compare the maximum values on both sides of the reaction. (4) An example where at least two different entities on both sides of the reaction are both upregulated or downregulated past the specified threshold. (5) An example where the same reaction entity on both sides is upregulated or downregulated past the specified threshold, with a modifier component also being upregulated or downregulated. (6) An example where the difference between at least one core reaction component and one reaction modifier is greater than the specified threshold. A star node indicates a reaction node. A purple border on a reaction node indicates a reaction pattern was identified. Circles indicate metabolites, squares indicate protein complexes, and diamonds indicate proteins. Grey arrows indicate the core relationships of a reaction. Green arrows indicate a catalyst component of a reaction, and red arrows indicate an inhibitor component of a reaction. A representative colormap is provided, where increasingly red shades indicate increased abundance, while increasingly blue shades indicate decreased abundance. Entities underlined in red are those that are relevant to the particular reaction pattern.
](./content/figures/pattern_examples.png "Square image"){#fig:supp_fig_pattern_examples}

### Example for the Pattern Analysis module
The following figure provides an example of the `Pattern Analysis` module within Metaboverse, with relevant points of interest highlighted and explained in the figure legend (Supplementary Figure @fig:supp_fig_module_pattern).

![
  **Pattern analysis module interface.**
  (a) The patterns currently available to search in Metaboverse are displayed in this panel. Users can adjust the thresholds for the given pattern using the appropriate fields. (b) For the selected pattern type, all available reaction-patterns within the organism's network will appear here. Reactions will be sorted by statistical values, as provided by the user, that were relevant to the identified pattern. Green stamps indicate both sides of the reaction contained significant values, yellow stamps indicate one side of the reaction contained significant values, and gray stamps indicate neither side of the reaction contained significant values. (c) This panel displays all of the pathways in which the reaction-pattern can be found. The graphic provides a simplified view of the reaction's primary substrates and products, with the nodes shaded by associated value. A user can select one of these pathways for viewing. (d) The selected pathway is displayed here, with all reaction-patterns in the pathway highlighted with a bold purple border. (e) If a user would like to view the selected pathway within the `Explore` module, they can click the icon to open the pathway in a new window. All reaction-patterns within the displayed pathway are listed below. (f) For time-course or multi-condition datasets, the user can choose to display reaction-patterns for the selected time-point or condition that are not present in another time-point or condition. (g) For time-course or multi-condition datasets, a slider bar will appear with the time-points or conditions for the user to select. (h) This panel provides a shape legend for the different shape types used in Metaboverse. (i) For time-course or multi-condition datasets, a line plot will appear for the selected reaction. While panels above only display the behavior of that reaction-pattern at a single time-point or condition, the line plot will display that reaction's behavior across all of the available time-points or conditions.
](./content/figures/pattern_module.png "Square image"){#fig:supp_fig_module_pattern}

### Example for the General Exploration module
The following figure provides an example of the `Explore` module within Metaboverse, with relevant points of interest highlighted and explained in the figure legend (Supplementary Figure @fig:supp_fig_module_explore).

![
  **Metabolite pathway exploration module interface.**
  (a) By hovering on the icon, users can view the shape legend. Below the shape legend is the compartment legend, where all currently displayed compartments in the selected pathway will be shown. (b) Users can toggle features on or off using the appropriate buttons. For example, users could choose to display all reaction names, not just when a reaction is selected. (c) Users can modulate graphing parameters, such as the number of reaction neighborhoods to graph when selecting a network component for nearest neighborhood analysis. (d) Notes about the selected reaction or synonyms for the selected reaction component appear here, as well as other information. (e) The drop-down menu for the selection of a super-pathway. (f) The drop-down menu for the selection of a specific pathway within the selected super-pathway. (g) For time-course and multi-condition datasets, a slider bar will appear that users can use to change value shading of nodes and highlighted reaction-patterns. (h) Viewing area for the selected pathway. (i) When users double-click on a reaction component, a nearest neighborhood graph will be displayed. In this instance, citrate was selected and all reactions citrate is involved in across all pathways are plotted.
](./content/figures/module_explore.png "Square image"){#fig:supp_fig_module_explore}

### Example for the Perturbation Networks module
The following figure provides an example of the `Perturbation Networks` module within Metaboverse, with relevant points of interest highlighted and explained in the figure legend (Supplementary Figure @fig:supp_fig_module_perturbation).

![
  **Perturbation networks module interface.**
  (a) Users can select what constitutes a perturbed reaction by modulating the appropriate thresholds. Only one type of perturbation (by magnitude or by statistical value) will be used. (b) Users select a super-pathway, for which all perturbed reactions belonging to that super-pathway are selected and displayed. Reactions that are neighbors and perturbed will be shown stitched together within the network, even if these reactions are connected across different pathways.
](./content/figures/module_perturbation.png "Square image"){#fig:supp_fig_module_perturbation}
