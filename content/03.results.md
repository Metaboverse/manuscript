## Results

### Metaboverse is a dynamic, user-friendly tool for the exploration of high-throughput biological data in organism-specific pathways

#### Overview
We designed Metaboverse as a lightweight, self-contained, cross-platform app for the dynamic exploration of high-throughput biological data. The pathway curations are derived from Reactome [@doi:10.1093/nar/gkz1031], coupled with additional metabolite synonym cross-referencing and mapping from the ChEBI [@doi:10.1093/nar/gkv1031] and Human Metabolome (HMDB) [@doi:10.1093/nar/gkx1089] databases. As of the time of writing, Metaboverse is capable of analyzing data for over 90 species. A user begins by providing the desired output location for a new data model and specifying the organism of interest. If the user has previously curated data onto a reaction network for the selected organism of interest, they can alternatively provide this intermediate file. Next, the user provides the relevant transcriptomic, proteomic, and/or metabolomic datasets to layer onto the global reaction network of their organism of interest. Input data types can be extended to any dataset that uses the relevant mapping IDs; for example, the user could provide ribosome profiling translation efficiency values mapped to the appropriate gene IDs for analysis upon the network. For each omics type, the user provides fold change and statistical values for each measurement. For example, if a user provided data for a two-condition comparison transcriptomics dataset, these values would consist of log<sub>2</sub>(fold change) values between the experimental and wild-type conditions and the appropriate statistical values. As transcriptomics count data follow a negative binomial distribution, the appropriately adjusted p-values based on multiple hypothesis testing for this distribution should be used [@doi:10.1186/s13059-014-0550-8, @doi:10.1093/bioinformatics/btp616]. For other omics types, these multiple hypothesis testing methods will vary based on the data distribution and other conventions. At the data input step, the user will also specify a few experimental parameters for consideration during downstream analysis and visualization. For example, users with gene expression data can choose to "broadcast" their measured gene values to the protein nodes where the appropriate protein values are missing. Following these user inputs, the organism's network is curated and the data are overlaid upon the network. A database file for the dataset is output for future analysis (see Figure @fig:package_overview).

![
  **Metaboverse software overview.**
  An illustration outlining the data input, processing, and exploration steps of the Metaboverse package. The user provides the name of the organism of interest from a drop-down menu along with an output location. The user then has the option to provide transcriptomics, proteomics, and/or metabolomics datasets. These datasets can be single- or multi-condition or time-course experiments. Data are formatted as follows: row names are the measured entity names or IDs, the first column is log<sub>2</sub>(fold change) or other measurement values, and the second column is statistical measurements. For time-course and multi-condition datasets, this pattern is repeated for each subsequent sample. During this step, the user can also provide sample labels and other modifiers to customize the curation of the data on the reaction network. Metaboverse will then build the model. Once the model is complete, the user will be able to visualize the patterns identified within reactions, explore pathway-specific or general perturbation networks, and perform general pathway and nearest reaction neighborhood exploration of the data.
](./content/figures/package_overview.png "Square image"){#fig:package_overview}

We chose to format network visualizations in a reaction-centric format, which means that a sub-network unit is comprised of a reaction node and linked with its reaction input (substrate) and reaction output (product) nodes, along with any modifier (catalyst or inhibitor) nodes. If modifier nodes are a protein complex, the component proteins of that complex are linked to the complex. Any genes available in the database are linked to their related proteins. Each node and link type are color-coded to help the user quickly distinguish the details of a reaction sub-network structure. Reactions with matching input or output sides are naturally linked when the network is constructed, allowing a multi-reaction pathway to emerge from this network structure. This formatting differs from other formatting styles the user may be familiar with, such as KEGG pathway maps, for various reasons. Whereas classical pathway definitions are used to group sets of reactions during visualization, analytical methods such as the pattern search in Metaboverse explore the global reaction network and display the pathways as flexible networks. This approach aids in making pattern analysis within the reaction network less subject to biases arising from constraining analysis to only familiar pathways and enables the exploration of patterns that may not neatly fit into canonical pathway representations. Since this dynamic visualization approach differs from more classical methods, each pathway within the visualization module contains a button linking to a more classically formatted representation of the pathway for reference sourced from Reactome [@doi:10.1093/nar/gkz1031].

#### Rapid identification of interesting regulatory patterns in the reaction network
Following network curation, the user can visualize the available patterns identified across all reactions in the network. In a computer science context, a motif is a recurring pattern within a network structure or the organization of network entities and their relationships. However, with omics data, we are more interested in identifying patterns involving the expression or abundance of genes, proteins, and metabolites. Previous work by Checkik, et al. introduced the concept of "activity motifs." Instead of identifying motifs based on sub-network structure, they identified motifs using the expression characteristics of nodes in transcription factor signaling networks [@doi:10.1038/nbt.1499]. We adapted this methodology to identify and interactively display interesting regulatory hotspots across all reactions in the network. For example, a reaction's inputs may exhibit increased levels and its outputs decreased levels, indicating a regulatory event occurring at the reaction.

Magnitude change and statistical values associated with each measurement for a measured entity are provided by the user. Once the data are layered upon the network, Metaboverse will consider all the reactions in the network and compare the expression or abundance patterns to those from a pre-defined library of regulatory patterns (please refer to the documentation for more details on available patterns and details on how they are each operating [@url:https://metaboverse.readthedocs.io/en/latest]). Metaboverse then returns a graphical stamp view of conserved patterns and sorts these reactions based on the significance values associated with those components that determined the regulatory feature. We use a three-tiered sorting strategy when sorting by the associated statistical values. The highest prioritized reaction-patterns are those where the relevant components that determined the presence of a regulatory pattern (inputs vs. outputs) are statistically significant. Of these reactions from the first tier, reactions are sorted by lowest to highest cumulative p-value or other relevant statistical value. In the second sorting tier, reactions with at least one side of the reaction with a statistically significant reaction component are sorted by statistical strength. Finally, all other reactions are sorted by the cumulative statistical value for the reaction components. The reaction's stamp shading indicates the sorting tier of each reaction, where green symbolizes that the components on both sides of the reaction passed significance thresholds, yellow symbolizes the components on one side of the reaction passed significance thresholds, and gray symbolizes neither side of the reaction contained significant components. Reactions can also be ordered based on the magnitude of change.

During dynamic pathway visualization, reaction-pattern nodes are visually distinct to quickly draw the user's attention to these interesting patterns. For a given regulatory pattern, the user can then explore each pathway where the reaction was found. Pattern analysis of the reactions within the network will allow the user to rapidly identify interesting features within the data, particularly patterns between canonical pathway representations or within pathways that may seem tangential to their research. In the data vignettes below, we will demonstrate this utility further. See Supplementary Figure @fig:supp_fig_module_pattern for an example of the `Pattern Analysis` graphical interface within Metaboverse for rapidly exploring all patterns present within the network.

#### Handling data sparsity within the global biological reaction network
Missing data points, particularly in metabolomics experiments, can be frequent and make the analysis of pathways and identification of regulatory patterns in the network challenging. Thousands of metabolites are known to participate in human metabolism, but the current state of the technology used for determining which mass spectra belong to which metabolite can be time consuming and often results in a limited quantification of data points. This limitation can lead to gaps in the measured metabolic network and can confound pattern recognition across reactions. Therefore, we developed a reaction-compression algorithm (described in the Methods section) that collapses up to three reactions with missing data points if they can be bridged with known data on the distal ends of the reaction series. Similar concepts have been used in metabolomic analysis before to identify amino acid-related metabolites [@doi:10.1038/s41586-019-1437-3]. However, we introduce the first computational implementation to our knowledge and adopt a slightly more conservative collapsing scheme. These bridged reactions, or collapsed reactions, are visually distinct to show the user where reactions were collapsed and understand what that collapsed reaction summarizes. We found that these collapsed reaction representations aided in identifying regulatory mechanisms across multiple reactions that would have been missed by pattern searching across traditional, uncollapsed representations of human metabolic reactions (see Supplementary Figure @fig:supp_fig_collapse and accompanying text for a brief discussion of the benefits of this feature).

#### Dynamic visualization of organism-specific reaction pathways
Following the curation of the global network as described above, the user can manually search individual pathways or individual entities and their reaction neighborhoods. For a given selection, all relevant reactions that are annotated as a part of that pathway will be visualized, along with their core input and output components. In addition to these core elements, known catalysts and inhibitors are included, as well as the component proteins, genes, and metabolites that form functional complexes involved in a particular reaction. For nodes representing protein complexes, simulated values are calculated by taking the average of all measured component entities in that complex. If gene values are available, but protein values are not, the user has the option to "broadcast" the gene values to the protein nodes. Assuming all statistical values are between 0 and 1, simulated statistics are calculated by taking the maximum statistical value of all measured component entities in that complex. In cases where a gene value is known, but its protein value is unmeasured, the protein value is optionally inferred using aggregated gene component values. Relevant pathway and analytical metadata are also displayed. All reaction-pattern types are displayed using default thresholds if found within the selected pathway. Additional aids for visualization are also available. These aids include the ability to remove nodes from the visualization that contain a high number of relationships to other network features so that these nodes, which act as hubs in the network, do not lead to cluttered representations. These hub nodes are often ubiquitous features such as water and protons, which may be of limited interest to the user during data visualization [@doi:10.1093/gigascience/giz137]. Compartment domains are also visualized to show the cellular locations of reactions and their components. See Supplementary Figure @fig:supp_fig_module_explore for an example of the `Explore` module within Metaboverse and some points of interest within the module.

#### Visualization of downstream effects of network perturbations using reaction neighborhoods
The user may be interested in a particular metabolite or protein and the downstream effects its perturbation has on other reactions across the entire network. By double-clicking a node of interest or selecting the entity name from the drop-down menu, the user can explore all upstream and downstream effects across all pathways. The user can also define how many neighborhoods to display such that two or more reaction steps downstream or upstream of the selected entity are visualized [@doi:10.1007/PL00009293; @doi:10/bz69nr]. This functionality moves the analysis past traditional, pathway-centric approaches and contextualizes the far-reaching effects that the disruption of metabolism can have across classical pathways. However, as metabolism is a network with high connectivity [@doi:10.1093/gigascience/giz137], expanding past one reaction neighborhood without defining a hub threshold can detrimentally impact performance. In these instances, Metaboverse will display a warning and suggest thresholds to use for the number of neighbors and hubs.

#### Exploring perturbation networks within the data
At times, a user may be interested in exploring all the perturbed reactions within a network. Metaboverse will display the total perturbation network for a given super-pathway selected by the user. For example, a user could select the Fatty Acid Metabolism super-pathway, and then explore all the perturbed reactions within this context for interesting features. During perturbation network display, all reactions are included and plotted if at least one component of that reaction passes the indicated magnitude or statistical threshold. Naturally, sequentially perturbed reactions will be stitched together in the resulting perturbation network. See Supplementary Figure @fig:supp_fig_module_perturbation for an example of the `Perturbation Networks` page within Metaboverse and some points of interest within the module.

### Data vignettes
To demonstrate the utility of Metaboverse, we analyzed both public and new metabolically relevant datasets. From the vignettes provided below, we show that Metaboverse identifies points of interest previously described or expected and rapidly identifies unexpected and systematic regulatory patterns in a reaction network context. For an example of the reaction collapse algorithm's utility, we refer the reader to the associated supplement (Supplementary Figure @fig:supp_fig_collapse). Data from Vignette 1 are available in distributed versions of Metaboverse (as `test_data.zip`) to act as a test dataset for users to familiarize themselves with the input data format. Input and processed data from these vignettes can be found at [@url:https://github.com/Metaboverse/manuscript].

#### Vignette 1: Adaptations of mitochondrial fatty acid synthesis-impaired yeast during non-fermentable growth
Mitochondrial fatty acid synthesis (mtFAS), an evolutionarily conserved pathway, has long been recognized to produce lipoic acid, a critical cofactor for several metabolic enzymes. Recent work has begun to uncover additional, important roles for this pathway. For example, we now know that mtFAS coordinates fatty acid synthesis with iron-sulfur (Fe-S) cluster biogenesis and assembly of oxidative phosphorylation complexes [@doi:10.1016/j.cub.2018.08.022; @doi:10.1016/j.molcel.2018.06.039; @doi:10.7554/eLife.17828]. Additionally, this pathway has received increased physiological focus with the discovery of patients with mutations in key mtFAS enzymes [@doi:10.1016/j.ajhg.2016.09.021].

The <i>Saccharomyces cerevisiae</i> Mct1 protein is an acyltransferase responsible for the transfer of a malonyl group from malonyl-CoA to the mitochondrial acyl carrier protein (ACP). By removing this gene, the activity of the mtFAS pathway is abolished. In order to probe the relationship between mtFAS-related protein concentration and the effects of its perturbation on downstream metabolic processes from a systematic perspective, we used a <i>mct1</i>&Delta; mutant <i>S. cerevisiae</i> strain. We previously performed steady-state comparative proteomics in this <i>mct1</i>&Delta; model 12 hours after shifting to a non-fermentable carbon source [@doi:10.1016/j.molcel.2018.06.039]. To complement these previous studies, we performed RNA-sequencing of transcript levels at 0, 3, and 12 hours after the shift to a non-fermentable carbon source and steady-state metabolomics at 0, 15, 30, 60, and 180 minutes after the shift in carbon source. By layering these data upon the <i>S. cerevisiae</i> metabolic network in Metaboverse, we observed interesting respiratory signatures as expected based on previous work [@doi:10.1111/mmi.12402; @doi:10.1016/j.molcel.2018.06.039]. For example, Metaboverse identified a strong pattern in the electron transfer from ubiquinol to cytochrome C via complex III of the electron transport chain (ETC) (Figure @fig:mct1_vignette A). At the protein level, the cytochrome C isoforms, Cyc1 and Cyc7, are both significantly reduced in concentration compared to wild-type cells (log<sub>2</sub>(fold change): -1.57 & -0.88; adjusted p-value: 1.21E-03 & 5.84E-03; Cohen's <i>d</i>: -7.99 & -3.94; respectively). This reduction in cytochrome C concentration is paired with a marked reduction in the concentration of the protein components of Complex III. These components catalyze the transfer of electrons from ubiquinol to cytochrome C (average log<sub>2</sub>(fold change) of all measured protein components: -2.03, where 9/11 component proteins were measured; 8/11 passed statistical significance thresholds of adjusted p-value <= 0.05. Range of significant log<sub>2</sub>(fold change) values: -0.34 to -3.21).

The second expected pattern of interest identified by Metaboverse was the marked reduction of TCA cycle-related enzymes. reaction-pattern analysis within the TCA cycle identified several putative regulatory hotspots between metabolites and metabolite-protein interactions throughout the TCA cycle (Figure @fig:mct1_vignette B). However, visualizing these identified reactions and data across the time-course revealed interesting patterns. For this discussion, we will provide metabolite measurements at the 15-minute time point because the statistical strength for the discussed metabolites was generally the strongest. For example, citrate levels decrease across the metabolomics time-course (at 15 min; log<sub>2</sub>(fold change): -1.75, adjusted p-value: 6.61E-03; Cohen's <i>d</i>: -1.86), which is coincident with reduced steady-state levels of Ctp1 (log<sub>2</sub>(fold change): -0.64, adjusted p-value: 6.06E-03; Cohen's <i>d</i>: -4.73), a protein that catalyzes the transfer of citrate from the mitochondrial matrix to the cytosol [@doi:10.1074/jbc.270.8.4108]. Citrate is a key metabolite and the first step in the TCA cycle. We hypothesize that due to central carbon metabolite reductions, Ctp1 may be down-regulated in response to the decrease in citrate to maintain citrate concentrations within the mitochondria where it is perhaps most physiologically important in a respiratory metabolism context.

Another point of interest is the up-regulation of Dic1 (log<sub>2</sub>(fold change): 2.15, adjusted p-value: 5.95E-06; Cohen's <i>d</i>: 28.97), which catalyzes the exchange of dicarboxylates like malate (at 15 min; log<sub>2</sub>(fold change): 2.61, adjusted p-value: 3.23E-06; Cohen's <i>d</i>: 5.12) between the mitochondrial matrix and cytosol. Interestingly, Dic1 is essential for growth on non-fermentable carbon source media [@doi:10.1046/j.1365-2958.1999.01197.x]. When yeast, especially those with deficits in TCA cycle flux due to loss of Mct1, are switched to a non-fermentable carbon, as was done in this study, they might adapt by up-regulating Dic1, which we observed in this data.

![
  **Metaboverse identifies several reaction-patterns of interest in <i>mct1</i>&Delta; cells.**
  (A) Steady-state proteomics (12 hours) overlaid on the reaction, "Electron transfer from ubiquinol to cytochrome c of complex III." (B) Steady-state proteomics (12 hours) and metabolomics at 15 minutes overlaid on TCA-related reactions. Time stamps for each data type are displayed in the lower right-hand corner of each subplot. Measured values are shown as node shading, where an increasingly blue shade indicates down-regulation, and an increasingly red shade indicates up-regulation. Measured log<sub>2</sub>(fold change) and statistical values for each entity are displayed below the node name. A gray node indicates a reaction. A bold gray node with a purple border indicates a potential regulatory pattern at this reaction for the given data type time points. Circles indicate metabolites, squares indicate complexes, diamonds indicate proteins, and triangles indicate gene components. Gray edges are core relationships between reaction inputs and outputs. Green edges indicate a catalyst. Dashed blue edges point from a metabolite component to the complex in which it is involved. Dashed orange edges point from a protein component to the complex in which it is involved. Dashed purple edges point from a gene component to its protein product. Protein complexes with dashed borders indicate that the values displayed on that node were inferred from the constituent protein, metabolite, and gene measurements. The background shading demonstrates Metaboverse's ability to show cellular compartmentalization, although users may opt to toggle compartment shading off at any time.
](./content/figures/fig_mct1.png "Square image"){#fig:mct1_vignette}

We also noticed that although the TCA cycle enzymes are all reduced in concentration, several related metabolites are up-regulated across multiple time points in the dataset. It is possible, for example, that the increased fumarate levels (at 15 min; log<sub>2</sub>(fold change): 1.00, adjusted p-value: < 0.01; Cohen's <i>d</i>: 3.89) are related to the reduction in fumarate hydratase (FH tetramer, FUM1; log<sub>2</sub>(fold change): -1.39, adjusted p-value: < 0.01; Cohen's <i>d</i>: -4.91), as has been demonstrated previously, and shown to associate with, hereditary leiomyomatosis and renal cell cancer in humans [@doi:10.1038/nature19353]. These patterns would be an interesting point of further study to understand the adaptations these cells make to disruptions to the TCA cycle and the downstream consequences of these disruptions and adaptations.

By analyzing this multi-omics dataset using reaction-pattern analysis and other interactive visualization available within Metaboverse, interesting questions arise. We see several reaction-patterns that are expected based on prior knowledge of this biological model and other puzzling behaviors worthy of further follow-up. These identified patterns demonstrate the potential Metaboverse has to act as a valuable hypothesis-generation tool, particularly with multi-omics and time-course datasets, and how this platform allows for better visualization and analysis of a user's dataset in the context of metabolic reaction networks.

#### Vignette 2: Metabolic signatures in malignant human lung adenocarcinomas compared to nonmalignant lung tissue
We next turned to published human lung adenocarcinoma steady-state metabolomics data [@doi:10.1158/1940-6207.CAPR-14-0329] to assess the utility of Metaboverse when analyzing data. Lung cancer remains a leading cause of death worldwide, and an improved understanding of these tumors' metabolism is essential in understanding how to treat this disease more effectively.

Consistent with the original study [@doi:10.1158/1940-6207.CAPR-14-0329] and our recent re-analysis of the data [@doi:10.1093/gigascience/giz137], nucleotide metabolism was broadly up-regulated in adenocarcinomas based on the reaction-pattern and perturbation network analyses. In particular, the highest scoring reaction-pattern identified by Metaboverse involved the transformation of decarboxylated-adenosyl methionine and spermidine to form spermine and 5'-methylthioadenosine. This reaction is a step in polyamine metabolism, with ties to nucleotide metabolism (Figure @fig:lung_vignette A). We also notice similar perturbations in xanthine (log<sub>2</sub>(fold change): 1.35; adjusted p-value: 1.52E-05; Cohen's <i>d</i>: 0.86) (Figure @fig:lung_vignette B) and other metabolites, which are highlighted to the user quickly in the reaction-pattern and perturbation network analysis modules. However, as we previously emphasized [@doi:10.1093/gigascience/giz137], by approaching these perturbations in a reaction-centric approach, we can identify regulatory behavior that further contextualizes the data. For example, using a more manual approach, we previously highlighted the up-regulation of glyceric acid (log<sub>2</sub>(fold change): 0.50; adjusted p-value: 1.91E-04; Cohen's <i>d</i>: 0.73) coupled with the proximal down-regulation of 3-Phosphoglyceric acid (log<sub>2</sub>(fold change): -1.09; adjusted p-value: 4.74E-04; Cohen's <i>d</i>: -0.68) which could indicate the activity of glycerate kinase [@doi:10.1093/gigascience/giz137]. This connection was missed in the original study but was highlighted by Metaboverse's reaction-pattern analysis module. This sub-pathway activity is consequential as it has connections to serine metabolism that contributes to generating an ideal environment for tumorigenesis (Figure @fig:lung_vignette C). Interestingly, of the measured and significant metabolites involved in the TCA cycle, we see a moderate up-regulation of malate (log<sub>2</sub>(fold change): 0.39, adjusted p-value: 3.85E-03; Cohen's <i>d</i>: 0.56) and down-regulation of citrate (log<sub>2</sub>(fold change): -0.64, adjusted p-value: 1.20E-03; Cohen's <i>d</i>: -0.63). This pattern is consistent with the hypothesis that the TCA cycle is starved of pyruvate-derived carbons and is compensating by shunting carbon into the TCA cycle via glutaminolysis. This compensatory pathway, a feature in many cancers, consists of glutamine transport into mitochondria and its conversion to alpha-ketoglutarate. Alpha-ketoglutarate then enters the second half of the TCA cycle to generate ATP, reducing equivalents, and biosynthetic intermediates [@pmid:429309; @doi:10.1146/annurev-bioeng-071516-044546]. Pyruvate is likely shunted toward the production of lactate and other biosynthetic products (no measurements for lactate were available in the dataset). This pattern might explain the lower citrate levels, and the second half of the TCA cycle could be fed through glutamate (log<sub>2</sub>(fold change): 0.47, adjusted p-value: 1.99E-06; Cohen's <i>d</i>: 0.98), providing the increased malate concentration (Figure @fig:lung_vignette D) [@doi:10.1038/nrc.2016.71].

Metaboverse simplifies the analysis process of metabolic data and allows the user more flexibility via an interactive platform that augments the identification of both canonical and novel regulatory patterns within the data. We were able to identify the regulatory pattern identified in Figure @fig:lung_vignette C previously using more manual approaches, but Metaboverse offers an automated platform for the discovery of such events not identified in the original study. We anticipate that the use of Metaboverse will enable users to extract new and exciting hypotheses that can drive their fields forward.

![
  **Metaboverse identifies nucleotide metabolism and other signatures in lung adenocarcinoma metabolomics data.**
  (A) Up-regulation of polyamine and nucleotide metabolites. (B) Identification of xanthine regulation by both the pattern recognition and perturbation analysis modules. (C) Regulatory activity between glyceric acid and 3-Phosphoglyceric acid identified by Metaboverse's pattern recognition analysis module. (D) Disruptions of TCA metabolism support canonical disruptions during adenocarcinoma development. Metabolomics values are shown as node shading, where an increasingly blue shade indicates down-regulation and an increasingly red shade indicates up-regulation. Measured log<sub>2</sub>(fold change) and statistical values for each entity are displayed below the node name. A gray node indicates a reaction. A bold gray node with a purple border indicates a motif at this reaction. Circles indicate metabolites, squares indicate complexes, and diamonds indicate proteins. Gray edges indicate core relationships between reaction inputs and outputs. Green edges indicate a catalyst, and red edges indicate inhibitors. Dashed blue edges point from a metabolite component to the protein complex in which it is involved. Dashed orange edges point from a protein component to the protein complex in which it is involved. Protein complexes with dashed borders indicate that the values displayed on that node were inferred from the constituent protein and metabolite measurements. The hub limit was set at 30 during generation of the network visualization as shown in sub-panel (D).
](./content/figures/fig_lung.png "Tall image"){#fig:lung_vignette}
