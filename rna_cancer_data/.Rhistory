# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample,
by.x = "Sample",
by.y = "case_submitter_id")
this_median <- median(merged_data_gene$FPKM)
merged_data_gene$gene_status <- ifelse(merged_data_gene$FPKM > this_median, "high", "low")
km_trt_fit <- survfit(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
# print(c(this_gene, opt_cutoff))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
median_pvals[this_gene] <- surv_pvalue(km_trt_fit)$pval
optimized_pvals[this_gene] <- surv_pvalue(opt_fit)$pval
glyctk_val <- surv_pvalue(opt_fit)$pval
ggsurvplot(
opt_fit,
risk.table = TRUE,
conf.int=TRUE,
pval=glyctk_val,
pval.method=TRUE,
palette=c("dodgerblue2", "orchid2"),
title="Kaplan-Meier Curve for Lung Cancer Survival",
risk.table.height=.25)
print(this_gene)
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
summary(res.cox)
clinical_data <- read.csv(file = "clinical.tsv", sep='\t')
# Censor alive/dead
censor_data <- function(x) if (x == "Alive") {0} else {1}
clinical_data$status <- mapply(censor_data, clinical_data$vital_status)
clinical_data$status <- as.numeric(clinical_data$status)
clinical_data$days_to_death <- as.numeric(clinical_data$days_to_death)
# Censor death date for alive patients (N/A) with no final status
#my.max <- function(x) ifelse( !all(is.na(x)), max(x, na.rm=T), NA)
#this_max <- my.max(clinical_data$days_to_death)
#clinical_data$days_to_death[is.na(clinical_data$days_to_death)] <- this_max
# days_to_last_follow_up
clinical_data$days_to_death <- ifelse(
is.na(clinical_data$days_to_death),
clinical_data$days_to_last_follow_up,
clinical_data$days_to_death)
clinical_sample <- clinical_data[ , c("case_submitter_id", "ajcc_pathologic_stage", "status", "days_to_death", "days_to_last_follow_up")]
clinical_sample <- clinical_sample[clinical_sample$days_to_death > 10 & clinical_sample$days_to_last_follow_up != "'--", ]
clinical_sample <- clinical_sample[clinical_sample$days_to_death != "'--", ]
clinical_sample$status <- as.numeric(as.character(clinical_sample$status))
clinical_sample$days_to_death <- as.numeric(as.character(clinical_sample$days_to_death))
clinical_sample$days_to_last_follow_up <- as.numeric(as.character(clinical_sample$days_to_last_follow_up))
clinical_sample <- clinical_sample[clinical_sample$ajcc_pathologic_stage == "Stage IA" | clinical_sample$ajcc_pathologic_stage == "Stage IB", ]
clinical_sample_early <- clinical_sample[clinical_sample$ajcc_pathologic_stage == "Stage IA" | clinical_sample$ajcc_pathologic_stage == "Stage IB", ]
clinical_sample_late <- clinical_sample[clinical_sample$ajcc_pathologic_stage != "Stage IA" & clinical_sample$ajcc_pathologic_stage != "Stage IB", ]
# this_gene <- "ENSG00000102172" # SMS
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_early,
by.x = "Sample",
by.y = "case_submitter_id")
this_median <- median(merged_data_gene$FPKM)
merged_data_gene$gene_status <- ifelse(merged_data_gene$FPKM > this_median, "high", "low")
km_trt_fit <- survfit(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
# print(c(this_gene, opt_cutoff))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
median_pvals[this_gene] <- surv_pvalue(km_trt_fit)$pval
optimized_pvals[this_gene] <- surv_pvalue(opt_fit)$pval
sms_val <- surv_pvalue(opt_fit)$pval
ggsurvplot(
opt_fit,
risk.table = TRUE,
conf.int=TRUE,
pval=sms_val,
pval.method=TRUE,
palette=c("dodgerblue2", "orchid2"),
title="Kaplan-Meier Curve for Lung Cancer Survival",
risk.table.height=.25)
print(this_gene)
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
summary(res.cox)
# this_gene <- "ENSG00000102172" # SMS
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_late,
by.x = "Sample",
by.y = "case_submitter_id")
this_median <- median(merged_data_gene$FPKM)
merged_data_gene$gene_status <- ifelse(merged_data_gene$FPKM > this_median, "high", "low")
km_trt_fit <- survfit(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
# print(c(this_gene, opt_cutoff))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
median_pvals[this_gene] <- surv_pvalue(km_trt_fit)$pval
optimized_pvals[this_gene] <- surv_pvalue(opt_fit)$pval
sms_val <- surv_pvalue(opt_fit)$pval
ggsurvplot(
opt_fit,
risk.table = TRUE,
conf.int=TRUE,
pval=sms_val,
pval.method=TRUE,
palette=c("dodgerblue2", "orchid2"),
title="Kaplan-Meier Curve for Lung Cancer Survival",
risk.table.height=.25)
print(this_gene)
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
summary(res.cox)
# this_gene <- "ENSG00000102172" # SMS
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_late,
by.x = "Sample",
by.y = "case_submitter_id")
this_median <- median(merged_data_gene$FPKM)
merged_data_gene$gene_status <- ifelse(merged_data_gene$FPKM > this_median, "high", "low")
km_trt_fit <- survfit(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
median_pvals[this_gene] <- surv_pvalue(km_trt_fit)$pval
optimized_pvals[this_gene] <- surv_pvalue(opt_fit)$pval
sms_val <- surv_pvalue(opt_fit)$pval
ggsurvplot(
opt_fit,
risk.table = TRUE,
conf.int=TRUE,
pval=sms_val,
pval.method=TRUE,
palette=c("dodgerblue2", "orchid2"),
title="Kaplan-Meier Curve for Lung Cancer Survival",
risk.table.height=.25)
print(this_gene)
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
summary(res.cox)
# this_gene <- "ENSG00000102172" # SMS
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_early,
by.x = "Sample",
by.y = "case_submitter_id")
this_median <- median(merged_data_gene$FPKM)
merged_data_gene$gene_status <- ifelse(merged_data_gene$FPKM > this_median, "high", "low")
km_trt_fit <- survfit(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
median_pvals[this_gene] <- surv_pvalue(km_trt_fit)$pval
optimized_pvals[this_gene] <- surv_pvalue(opt_fit)$pval
sms_val <- surv_pvalue(opt_fit)$pval
ggsurvplot(
opt_fit,
risk.table = TRUE,
conf.int=TRUE,
pval=sms_val,
pval.method=TRUE,
palette=c("dodgerblue2", "orchid2"),
title="Kaplan-Meier Curve for Lung Cancer Survival",
risk.table.height=.25)
print(this_gene)
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
summary(res.cox)
View(clinical_sample_early)
View(clinical_sample_late)
View(clinical_sample_late)
clinical_data <- read.csv(file = "clinical.tsv", sep='\t')
# Censor alive/dead
censor_data <- function(x) if (x == "Alive") {0} else {1}
clinical_data$status <- mapply(censor_data, clinical_data$vital_status)
clinical_data$status <- as.numeric(clinical_data$status)
clinical_data$days_to_death <- as.numeric(clinical_data$days_to_death)
# Censor death date for alive patients (N/A) with no final status
#my.max <- function(x) ifelse( !all(is.na(x)), max(x, na.rm=T), NA)
#this_max <- my.max(clinical_data$days_to_death)
#clinical_data$days_to_death[is.na(clinical_data$days_to_death)] <- this_max
# days_to_last_follow_up
clinical_data$days_to_death <- ifelse(
is.na(clinical_data$days_to_death),
clinical_data$days_to_last_follow_up,
clinical_data$days_to_death)
clinical_sample <- clinical_data[ , c("case_submitter_id", "ajcc_pathologic_stage", "status", "days_to_death", "days_to_last_follow_up")]
clinical_sample <- clinical_sample[clinical_sample$days_to_death > 10 & clinical_sample$days_to_last_follow_up != "'--", ]
clinical_sample <- clinical_sample[clinical_sample$days_to_death != "'--", ]
clinical_sample$status <- as.numeric(as.character(clinical_sample$status))
clinical_sample$days_to_death <- as.numeric(as.character(clinical_sample$days_to_death))
clinical_sample$days_to_last_follow_up <- as.numeric(as.character(clinical_sample$days_to_last_follow_up))
clinical_sample_early <- clinical_sample[clinical_sample$ajcc_pathologic_stage == "Stage IA" | clinical_sample$ajcc_pathologic_stage == "Stage IB", ]
clinical_sample_late <- clinical_sample[clinical_sample$ajcc_pathologic_stage != "Stage IA" & clinical_sample$ajcc_pathologic_stage != "Stage IB", ]
clinical_sample_early <- clinical_sample[clinical_sample$ajcc_pathologic_stage == "Stage I" | clinical_sample$ajcc_pathologic_stage == "Stage IA" | clinical_sample$ajcc_pathologic_stage == "Stage IB", ]
clinical_sample_late <- clinical_sample[clinical_sample$ajcc_pathologic_stage != "Stage I" & clinical_sample$ajcc_pathologic_stage != "Stage IA" & clinical_sample$ajcc_pathologic_stage != "Stage IB", ]
# this_gene <- "ENSG00000102172" # SMS
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_early,
by.x = "Sample",
by.y = "case_submitter_id")
this_median <- median(merged_data_gene$FPKM)
merged_data_gene$gene_status <- ifelse(merged_data_gene$FPKM > this_median, "high", "low")
km_trt_fit <- survfit(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
median_pvals[this_gene] <- surv_pvalue(km_trt_fit)$pval
optimized_pvals[this_gene] <- surv_pvalue(opt_fit)$pval
sms_val <- surv_pvalue(opt_fit)$pval
ggsurvplot(
opt_fit,
risk.table = TRUE,
conf.int=TRUE,
pval=sms_val,
pval.method=TRUE,
palette=c("dodgerblue2", "orchid2"),
title="Kaplan-Meier Curve for Lung Cancer Survival",
risk.table.height=.25)
print(this_gene)
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
summary(res.cox)
# this_gene <- "ENSG00000102172" # SMS
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_late,
by.x = "Sample",
by.y = "case_submitter_id")
this_median <- median(merged_data_gene$FPKM)
merged_data_gene$gene_status <- ifelse(merged_data_gene$FPKM > this_median, "high", "low")
km_trt_fit <- survfit(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
median_pvals[this_gene] <- surv_pvalue(km_trt_fit)$pval
optimized_pvals[this_gene] <- surv_pvalue(opt_fit)$pval
sms_val <- surv_pvalue(opt_fit)$pval
ggsurvplot(
opt_fit,
risk.table = TRUE,
conf.int=TRUE,
pval=sms_val,
pval.method=TRUE,
palette=c("dodgerblue2", "orchid2"),
title="Kaplan-Meier Curve for Lung Cancer Survival",
risk.table.height=.25)
print(this_gene)
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
summary(res.cox)
# this_gene <- "ENSG00000102172" # SMS
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_late,
by.x = "Sample",
by.y = "case_submitter_id")
this_median <- median(merged_data_gene$FPKM)
merged_data_gene$gene_status <- ifelse(merged_data_gene$FPKM > this_median, "high", "low")
km_trt_fit <- survfit(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
median_pvals[this_gene] <- surv_pvalue(km_trt_fit)$pval
optimized_pvals[this_gene] <- surv_pvalue(opt_fit)$pval
sms_val <- surv_pvalue(opt_fit)$pval
ggsurvplot(
opt_fit,
risk.table = TRUE,
conf.int=TRUE,
pval=sms_val,
pval.method=TRUE,
palette=c("dodgerblue2", "orchid2"),
title="Kaplan-Meier Curve for Lung Cancer Survival",
risk.table.height=.25)
# this_gene <- "ENSG00000102172" # SMS
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample,
by.x = "Sample",
by.y = "case_submitter_id")
this_median <- median(merged_data_gene$FPKM)
merged_data_gene$gene_status <- ifelse(merged_data_gene$FPKM > this_median, "high", "low")
km_trt_fit <- survfit(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
median_pvals[this_gene] <- surv_pvalue(km_trt_fit)$pval
optimized_pvals[this_gene] <- surv_pvalue(opt_fit)$pval
sms_val <- surv_pvalue(opt_fit)$pval
ggsurvplot(
opt_fit,
risk.table = TRUE,
conf.int=TRUE,
pval=sms_val,
pval.method=TRUE,
palette=c("dodgerblue2", "orchid2"),
title="Kaplan-Meier Curve for Lung Cancer Survival",
risk.table.height=.25)
print(this_gene)
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status + ajcc_pathologic_stage, data=merged_data_gene)
summary(res.cox)
clinical_sample$stage <- clinical_sample$ajcc_pathologic_stage
clinical_data$stage[
clinical_data$stage == "Stage I" |
clinical_data$stage == "Stage IA" |
clinical_data$stage == "Stage IB"] <- 1
clinical_data <- read.csv(file = "clinical.tsv", sep='\t')
# Censor alive/dead
censor_data <- function(x) if (x == "Alive") {0} else {1}
clinical_data$status <- mapply(censor_data, clinical_data$vital_status)
clinical_data$status <- as.numeric(clinical_data$status)
clinical_data$days_to_death <- as.numeric(clinical_data$days_to_death)
# Censor death date for alive patients (N/A) with no final status
#my.max <- function(x) ifelse( !all(is.na(x)), max(x, na.rm=T), NA)
#this_max <- my.max(clinical_data$days_to_death)
#clinical_data$days_to_death[is.na(clinical_data$days_to_death)] <- this_max
# days_to_last_follow_up
clinical_data$days_to_death <- ifelse(
is.na(clinical_data$days_to_death),
clinical_data$days_to_last_follow_up,
clinical_data$days_to_death)
clinical_sample <- clinical_data[ , c("case_submitter_id", "ajcc_pathologic_stage", "status", "days_to_death", "days_to_last_follow_up")]
clinical_sample <- clinical_sample[clinical_sample$days_to_death > 10 & clinical_sample$days_to_last_follow_up != "'--", ]
clinical_sample <- clinical_sample[clinical_sample$days_to_death != "'--", ]
clinical_sample$status <- as.numeric(as.character(clinical_sample$status))
clinical_sample$days_to_death <- as.numeric(as.character(clinical_sample$days_to_death))
clinical_sample$days_to_last_follow_up <- as.numeric(as.character(clinical_sample$days_to_last_follow_up))
clinical_sample$stage <- clinical_sample$ajcc_pathologic_stage
clinical_sample$stage[
clinical_sample$stage == "Stage I" |
clinical_sample$stage == "Stage IA" |
clinical_sample$stage == "Stage IB"] <- 1
clinical_sample$stage[
clinical_sample$stage == "Stage II" |
clinical_sample$stage == "Stage IIA" |
clinical_sample$stage == "Stage IIB"] <- 2
clinical_sample$stage[
clinical_sample$stage == "Stage III" |
clinical_sample$stage == "Stage IIIA" |
clinical_sample$stage == "Stage IIIB"] <- 3
clinical_sample$stage[
clinical_sample$stage == "Stage IV" |
clinical_sample$stage == "Stage IVA" |
clinical_sample$stage == "Stage IVB"] <- 4
clinical_data <- read.csv(file = "clinical.tsv", sep='\t')
# Censor alive/dead
censor_data <- function(x) if (x == "Alive") {0} else {1}
clinical_data$status <- mapply(censor_data, clinical_data$vital_status)
clinical_data$status <- as.numeric(clinical_data$status)
clinical_data$days_to_death <- as.numeric(clinical_data$days_to_death)
# Censor death date for alive patients (N/A) with no final status
#my.max <- function(x) ifelse( !all(is.na(x)), max(x, na.rm=T), NA)
#this_max <- my.max(clinical_data$days_to_death)
#clinical_data$days_to_death[is.na(clinical_data$days_to_death)] <- this_max
# days_to_last_follow_up
clinical_data$days_to_death <- ifelse(
is.na(clinical_data$days_to_death),
clinical_data$days_to_last_follow_up,
clinical_data$days_to_death)
clinical_sample <- clinical_data[ , c("case_submitter_id", "ajcc_pathologic_stage", "status", "days_to_death", "days_to_last_follow_up")]
clinical_sample <- clinical_sample[clinical_sample$days_to_death > 10 & clinical_sample$days_to_last_follow_up != "'--", ]
clinical_sample <- clinical_sample[clinical_sample$days_to_death != "'--", ]
clinical_sample$status <- as.numeric(as.character(clinical_sample$status))
clinical_sample$days_to_death <- as.numeric(as.character(clinical_sample$days_to_death))
clinical_sample$days_to_last_follow_up <- as.numeric(as.character(clinical_sample$days_to_last_follow_up))
clinical_sample$stage <- clinical_sample$ajcc_pathologic_stage
clinical_sample <- clinical_sample[clinical_sample$stage != "'--", ]
clinical_sample$stage[
clinical_sample$stage == "Stage I" |
clinical_sample$stage == "Stage IA" |
clinical_sample$stage == "Stage IB"] <- 1
clinical_sample$stage[
clinical_sample$stage == "Stage II" |
clinical_sample$stage == "Stage IIA" |
clinical_sample$stage == "Stage IIB"] <- 2
clinical_sample$stage[
clinical_sample$stage == "Stage III" |
clinical_sample$stage == "Stage IIIA" |
clinical_sample$stage == "Stage IIIB"] <- 3
clinical_sample$stage[
clinical_sample$stage == "Stage IV" |
clinical_sample$stage == "Stage IVA" |
clinical_sample$stage == "Stage IVB"] <- 4
# this_gene <- "ENSG00000102172" # SMS
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample,
by.x = "Sample",
by.y = "case_submitter_id")
this_median <- median(merged_data_gene$FPKM)
merged_data_gene$gene_status <- ifelse(merged_data_gene$FPKM > this_median, "high", "low")
km_trt_fit <- survfit(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
median_pvals[this_gene] <- surv_pvalue(km_trt_fit)$pval
optimized_pvals[this_gene] <- surv_pvalue(opt_fit)$pval
sms_val <- surv_pvalue(opt_fit)$pval
ggsurvplot(
opt_fit,
risk.table = TRUE,
conf.int=TRUE,
pval=sms_val,
pval.method=TRUE,
palette=c("dodgerblue2", "orchid2"),
title="Kaplan-Meier Curve for Lung Cancer Survival",
risk.table.height=.25)
print(this_gene)
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status + ajcc_pathologic_stage, data=merged_data_gene)
summary(res.cox)
clinical_sample_early <- clinical_sample[clinical_sample$ajcc_pathologic_stage == "Stage I" | clinical_sample$ajcc_pathologic_stage == "Stage IA" | clinical_sample$ajcc_pathologic_stage == "Stage IB", ]
clinical_sample_late <- clinical_sample[clinical_sample$ajcc_pathologic_stage != "Stage I" & clinical_sample$ajcc_pathologic_stage != "Stage IA" & clinical_sample$ajcc_pathologic_stage != "Stage IB", ]
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_early,
by.x = "Sample",
by.y = "case_submitter_id")
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
summary(res.cox)
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_early,
by.x = "Sample",
by.y = "case_submitter_id")
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
summary(res.cox)
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_early,
by.x = "Sample",
by.y = "case_submitter_id")
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
summary(res.cox)
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
merged_data_gene <- merge(
data_gene,
clinical_sample_early,
by.x = "Sample",
by.y = "case_submitter_id")
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
summary(res.cox)
res.cox <- coxph(Surv(days_to_death, status) ~ gene_status, data=merged_data_gene)
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_early,
by.x = "Sample",
by.y = "case_submitter_id")
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
res.cox <- coxph(Surv(days_to_death, status) ~ FPKM, data=opt_categories)
summary(res.cox)
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample_late,
by.x = "Sample",
by.y = "case_submitter_id")
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
res.cox <- coxph(Surv(days_to_death, status) ~ FPKM, data=opt_categories)
summary(res.cox)
this_gene <- "ENSG00000102172"
data_gene <- rpkm_data[rpkm_data$Gene == this_gene,]
# Merged mixed data tables
merged_data_gene <- merge(
data_gene,
clinical_sample,
by.x = "Sample",
by.y = "case_submitter_id")
opt_cutoff <- surv_cutpoint(merged_data_gene, time = "days_to_death", event = "status", variables = c("FPKM"))
opt_categories <- surv_categorize(opt_cutoff)
opt_fit <- survfit(Surv(days_to_death, status) ~ FPKM, data = opt_categories)
res.cox <- coxph(Surv(days_to_death, status) ~ FPKM, data=opt_categories)
summary(res.cox)
